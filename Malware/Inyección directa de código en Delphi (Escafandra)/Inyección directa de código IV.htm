<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0054)http://www.clubdelphi.com/foros/showthread.php?t=55924 -->
<html dir="ltr" lang="es"><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
	
<meta name="generator" content="vBulletin 3.6.8">

<meta name="keywords" content="Como inyectar código directamente a un proceso externo, delphi,interbase,sql,delphi4php,codegear,borland">
<meta name="description" content="Como inyectar código directamente a un proceso externo API de Windows">

<!-- CSS Stylesheet -->
<link rel="stylesheet" type="text/css" href="./Inyección directa de código IV_files/style-74acabfd-00002.css" id="vbulletin_css">

<!-- / CSS Stylesheet -->
<script type="text/javascript">
<!--
var SESSIONURL = "";
var IMGDIR_MISC = "images/misc";
var vb_disable_ajax = parseInt("0", 10);
// -->
</script>
<script type="text/javascript" src="./Inyección directa de código IV_files/vbulletin_global.js"></script>
<script type="text/javascript" src="./Inyección directa de código IV_files/vbulletin_menu.js"></script>

<link rel="alternate" type="application/rss+xml" title="Foros Club Delphi RSS Feed" href="http://www.clubdelphi.com/foros/external.php?type=RSS2">

<link rel="alternate" type="application/rss+xml" title="Foros Club Delphi - API de Windows - RSS Feed" href="http://www.clubdelphi.com/foros/external.php?type=RSS2&forumids=7">


	<title>Como inyectar código directamente a un proceso externo - Foros Club Delphi</title>
	<script type="text/javascript" src="./Inyección directa de código IV_files/vbulletin_post_loader.js"></script>
</head>
<body onload="">
<!-- Club Delphi -->
<script> if (parent.frames.length > 0)  parent.location.href = self.document.location </script>
<style>
.frame_codigo_delphi
{
   margin: 20px;
   margin-top: 5px;
   width: auto;
}
.texto_codigo_delphi
{
   margin: 0px;
   margin-top: 3px;
   padding: 6px;
   border: 1px solid navy;
         background-color: #E1E4F2;
   //width: 775px;
         width: 98%;
   overflow-x: auto;
overflow: auto;
overflow-x: auto;
overflow: -moz-scrollbars-horizontal;
}
.frame_codigo_sql
{
   margin: 20px;
   margin-top: 5px;
   width: auto;
}
.texto_codigo_sql
{
   margin: 0px;
   margin-top: 3px;
   padding: 6px;
   border: 1px solid navy;
         background-color: #E1E4F2;
   //width: 775px;
         width: 98%;
   overflow-x: auto;
overflow: auto;
overflow-x: auto;
overflow: -moz-scrollbars-horizontal;
}

</style>
<link href="./Inyección directa de código IV_files/clubdelphi.css" rel="stylesheet" type="text/css">
<link href="./Inyección directa de código IV_files/delphi.css" rel="stylesheet" type="text/css">
<link href="./Inyección directa de código IV_files/sql.css" rel="stylesheet" type="text/css">
<script>
function etiqueta_delphi( delphi_div, delphi_ancla )
{
   var div  = document.getElementById( delphi_div );
   var ancla   = document.getElementById( delphi_ancla );

   if (div.style.minimizado == null || !div.style.minimizado) 
   {
      div.style.height     = '100px';
      div.style.overflowY  = 'scroll';
      div.style.minimizado = true;
      ancla.innerHTML      = '[+]';
      ancla.title          = 'Expandir cuadro de código';
   }
   else
   {
      div.style.height     = 'auto';
      div.style.overflowY  = 'visible';
      div.style.minimizado    = false;
      ancla.innerHTML      = '[-]';
      ancla.title          = 'Contraer cuadro de código';
   }
}

<!-- Fin Etiqueta Delphi -->
<!-- Etiqueta SQL -->

function etiqueta_sql( sql_div, sql_ancla )
{
   var div  = document.getElementById( sql_div );
   var ancla   = document.getElementById( sql_ancla );

   if (div.style.minimizado == null || !div.style.minimizado) 
   {
      div.style.height     = '100px';
      div.style.overflowY  = 'scroll';
      div.style.minimizado = true;
      ancla.innerHTML      = '[+]';
      ancla.title          = 'Expandir cuadro de código';
   }
   else
   {
      div.style.height     = 'auto';
      div.style.overflowY  = 'visible';
      div.style.minimizado    = false;
      ancla.innerHTML      = '[-]';
      ancla.title          = 'Contraer cuadro de código';
   }
}
</script>
<!-- Fin Etiqueta SQL -->

<table cellspacing="0" cellpadding="0" width="100%" border="0">
  <tbody><tr valign="top">
    <td width="516" rowspan="4"><a href="http://www.clubdelphi.com/"><img src="./Inyección directa de código IV_files/clubdelphi.jpg" alt="Club Delphi" width="516" height="86" border="0" title="Club Delphi"></a></td>
    <td background="./Inyección directa de código IV_files/fondoTop.jpg">&nbsp;</td>
    <td width="648" align="right" valign="top" background="./Inyección directa de código IV_files/fondoTop.jpg">
<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0" width="485" height="75">
  <param name="flash_component" value="ImageViewer.swc">
  <param name="movie" value="http://codegear.clubdelphi.com/banner.swf">
  <param name="quality" value="high">

  <param name="FlashVars" value="flashlet={imageLinkTarget:&#39;_blank&#39;,captionFont:&#39;Verdana&#39;,titleFont:&#39;Verdana&#39;,showControls:true,frameShow:false,slideDelay:5,captionSize:10,captionColor:#333333,titleSize:10,transitionsType:&#39;Random&#39;,titleColor:#333333,slideAutoPlay:false,imageURLs:[&#39;img1.jpg&#39;,&#39;img2.jpg&#39;,&#39;img3.jpg&#39;],slideLoop:false,frameThickness:2,imageLinks:[&#39;http://macromedia.com/&#39;,&#39;http://macromedia.com/&#39;,&#39;http://macromedia.com/&#39;],frameColor:#333333,bgColor:#FFFFFF,imageCaptions:[]}">
  <embed src="http://codegear.clubdelphi.com/banner.swf" quality="high" flashvars="flashlet={imageLinkTarget:&#39;_blank&#39;,captionFont:&#39;Verdana&#39;,titleFont:&#39;Verdana&#39;,showControls:true,frameShow:false,slideDelay:5,captionSize:10,captionColor:#333333,titleSize:10,transitionsType:&#39;Random&#39;,titleColor:#333333,slideAutoPlay:false,imageURLs:[&#39;img1.jpg&#39;,&#39;img2.jpg&#39;,&#39;img3.jpg&#39;],slideLoop:false,frameThickness:2,imageLinks:[&#39;http://macromedia.com/&#39;,&#39;http://macromedia.com/&#39;,&#39;http://macromedia.com/&#39;],frameColor:#333333,bgColor:#FFFFFF,imageCaptions:[]}" pluginspage="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash" type="application/x-shockwave-flash" width="485" height="75"> 
</object>
</td>
  </tr>
</tbody></table>
<!--Termina la tabla y empieza el menu hoizontal -->

      <table width="100%" border="0" cellpadding="0" cellspacing="0">
          <tbody><tr class="pestanas" height="20">
            <td width="7"><img src="./Inyección directa de código IV_files/pes_izq.gif" width="7" height="20"></td>
            <td valign="middle" background="./Inyección directa de código IV_files/pes_cen.gif">&nbsp;</td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_dch.gif" width="7" border="0"></td>

            <td width="4">&nbsp;</td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_izq.gif" width="7" border="0"></td>
            <td width="45" valign="middle" align="center" background="./Inyección directa de código IV_files/pes_cen.gif"><a href="http://www.terawiki.com/clubdelphi/">FTP</a></td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_dch.gif" width="7" border="0"></td>

            <td width="4">&nbsp;</td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_izq.gif" width="7" border="0"></td>
            <td width="45" valign="middle" align="center" background="./Inyección directa de código IV_files/pes_cen.gif"><a href="http://componentes.clubdelphi.com/">CCD</a></td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_dch.gif" width="7" border="0"></td>

            <td width="4">&nbsp;</td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_izq.gif" width="7" border="0"></td>
            <td width="50" valign="middle" align="center" background="./Inyección directa de código IV_files/pes_cen.gif"><a href="http://wiki.clubdelphi.com/">Wiki</a></td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_dch.gif" width="7" border="0"></td>

            <td width="4">&nbsp;</td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_izq.gif" width="7" border="0"></td>
            <td width="65" align="center" background="./Inyección directa de código IV_files/pes_cen.gif"><a href="http://www.clubdelphi.com/enlaces/">Enlaces</a></td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_dch.gif" width="7" border="0"></td>

            <td width="4">&nbsp;</td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_izq.gif" width="7" border="0"></td>
            <td valign="middle" align="center" width="65" background="./Inyección directa de código IV_files/pes_cen.gif"><a href="http://www.clubdelphi.com/foros/search.php">Buscar</a></td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_dch.gif" width="7" border="0"></td>

            <td width="4">&nbsp;</td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_izq.gif" width="7" border="0"></td>
            <td valign="middle" align="center" width="65" background="./Inyección directa de código IV_files/pes_cen.gif"><a href="http://www.clubdelphi.com/trucos/">Trucos</a></td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_dch.gif" width="7" border="0"></td>

            <td width="4">&nbsp;</td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_izq.gif" width="7" border="0"></td>
            <td valign="middle" align="center" width="65" background="./Inyección directa de código IV_files/pes_cen.gif"><a href="http://www.clubdelphi.com/trabajo.php">Trabajo</a></td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_dch.gif" width="7" border="0"></td>

            <td width="4">&nbsp;</td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_izq.gif" width="7" border="0"></td>
            <td valign="middle" align="center" width="65" background="./Inyección directa de código IV_files/pes_cen.gif"><a href="http://www.clubdelphi.com/foros/">Foros</a></td>
            <td width="7"><img height="20" src="./Inyección directa de código IV_files/pes_dch.gif" width="7" border="0"></td>
          </tr>
</tbody></table>


<br>
<!-- /Club Delphi -->


<!-- content table -->
<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">


<!-- breadcrumb, login, pm info -->
<table class="tborder" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
   <td class="alt1" width="100%">
      
         <table cellpadding="0" cellspacing="0" border="0">
         <tbody><tr valign="bottom">
            <td><a href="http://www.clubdelphi.com/foros/showthread.php?t=55924#" onclick="history.back(1); return false;"><img src="./Inyección directa de código IV_files/navbits_start.gif" alt="Retroceder" border="0" title="Retroceder"></a></td>
            <td>&nbsp;</td>
            <td width="100%"><span class="navbar"><a href="http://www.clubdelphi.com/foros/index.php" accesskey="1">Foros Club Delphi</a></span> 
	<span class="navbar">&gt; <a href="http://www.clubdelphi.com/foros/forumdisplay.php?f=1">Principal</a></span>


	<span class="navbar">&gt; <a href="http://www.clubdelphi.com/foros/forumdisplay.php?f=7">API de Windows</a></span>

</td>
         </tr>
         <tr>
            <td class="navbar" style="font-size:10pt; padding-top:1px" colspan="3"><a href="./Inyección directa de código IV_files/Inyección directa de código IV.htm"><img class="inlineimg" src="./Inyección directa de código IV_files/navbits_finallink_ltr.gif" alt="Actualizar esta página" border="0" title="Actualizar esta página"></a> <strong>
	Como inyectar código directamente a un proceso externo

</strong></td>
         </tr>
         </tbody></table>       
      
   </td> 
   
   
      
      <td class="alt2" nowrap="nowrap" style="padding:0px">
         
      <!-- login form -->
      <form action="http://www.clubdelphi.com/foros/login.php?do=login" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
      <script type="text/javascript" src="./Inyección directa de código IV_files/vbulletin_md5.js"></script>
      <table cellpadding="0" cellspacing="3" border="0">
      <tbody><tr>
         <td class="smallfont"><label for="navbar_username">Nombre de Usuario</label></td>
         <td><input type="text" class="bginput" style="font-size: 11px" name="vb_login_username" id="navbar_username" size="10" accesskey="u" tabindex="101" value="Nombre de Usuario" onfocus="if (this.value == &#39;Nombre de Usuario&#39;) this.value = &#39;&#39;;"></td>
         <td class="smallfont" colspan="2" nowrap="nowrap"><label for="cb_cookieuser_navbar"><input type="checkbox" name="cookieuser" value="1" tabindex="103" id="cb_cookieuser_navbar" accesskey="c">¿Recordarme?</label></td>
      </tr>
      <tr>
         <td class="smallfont"><label for="navbar_password">Contraseña</label></td>
         <td><input type="password" class="bginput" style="font-size: 11px" name="vb_login_password" id="navbar_password" size="10" tabindex="102"></td>
         <td><input type="submit" class="button" value="Iniciar Sesión" tabindex="104" title="Escribe tu nombre de usuario y contraseña en las casillas para iniciar la sesión o pulsa el botón &#39;registrarse&#39; para crear un perfil." accesskey="s"></td>
      </tr>
      </tbody></table>
      <input type="hidden" name="s" value="">
      <input type="hidden" name="do" value="login">    
      <input type="hidden" name="vb_login_md5password">
      <input type="hidden" name="vb_login_md5password_utf">
      </form>
      <!-- / login form -->
         
      </td>
      
    
   
</tr>
</tbody></table>
<!-- / breadcrumb, login, pm info -->

<!-- nav buttons bar -->
<table class="tborder" cellpadding="6" cellspacing="0" border="0" width="100%" align="center" style="border-top-width:0px">
<tbody><tr align="center">
   
   
      <td class="vbmenu_control"><a href="http://www.clubdelphi.com/foros/register.php" rel="nofollow">Registrarse</a></td>
   
   
   <td class="vbmenu_control"><a href="http://www.clubdelphi.com/foros/faq.php" accesskey="5">FAQ</a></td>
   <td class="vbmenu_control"><a href="http://www.clubdelphi.com/foros/memberlist.php">Miembros</a></td>
   <td class="vbmenu_control"><a href="http://www.clubdelphi.com/foros/calendar.php">Calendario</a></td>
<td class="vbmenu_control"><a href="http://www.clubdelphi.com/foros/guiaestilo.php">Guía de estilo</a></td>
       
      
         
         <td class="vbmenu_control"><a href="http://www.clubdelphi.com/foros/search.php?do=getdaily" accesskey="2">Temas de Hoy</a></td>
         
         
      
      
   
   
   
</tr>
</tbody></table>
<!-- / nav buttons bar -->

<br>



<!-- NAVBAR POPUP MENUS -->
   
   
   <!-- header quick search form (Emilio)-->
   <!-- / header quick search form (Emilio)-->
   

   
<!-- / NAVBAR POPUP MENUS -->

<!-- PAGENAV POPUP -->


   <div class="vbmenu_popup" id="pagenav_menu" style="display:none">
      <table cellpadding="4" cellspacing="1" border="0">
      <tbody><tr>
         <td class="thead" nowrap="nowrap">Ir a la Página...</td>
      </tr>
      <tr>
         <td class="vbmenu_option" title="nohilite">
         <form action="http://www.clubdelphi.com/foros/index.php" method="get" onsubmit="return this.gotopage()" id="pagenav_form">
            <input type="text" class="bginput" id="pagenav_itxt" style="font-size:11px" size="4">
            <input type="button" class="button" id="pagenav_ibtn" value="Ir">
         </form>
         </td>
      </tr>
      </tbody></table>
   </div>

<!-- / PAGENAV POPUP -->







<a name="poststop" id="poststop"></a>

<!-- controls above postbits -->
<table cellpadding="0" cellspacing="0" border="0" width="100%" style="margin-bottom:3px">
<tbody><tr valign="bottom">
	
		<td class="smallfont"><a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&noquote=1&p=283694" rel="nofollow"><img src="./Inyección directa de código IV_files/reply.gif" alt="Respuesta" border="0" title="Respuesta"></a></td>
	
	
</tr>
</tbody></table>
<!-- / controls above postbits -->

<!-- toolbar -->
<table class="tborder" cellpadding="6" cellspacing="1" border="0" width="100%" align="center" style="border-bottom-width:0px">
<tbody><tr>
	<td class="tcat" width="100%">
		<div class="smallfont">
		
		&nbsp;
		</div>
	</td>
	<td class="vbmenu_control" id="threadtools" nowrap="nowrap" style="cursor: pointer; ">
		<a href="http://www.clubdelphi.com/foros/showthread.php?t=55924&nojs=1#goto_threadtools">Herramientas</a>
		<script type="text/javascript"> vbmenu_register("threadtools"); </script> <img src="./Inyección directa de código IV_files/menu_open.gif" border="0" title="" alt="">
	</td>
	
	
	
	<td class="vbmenu_control" id="displaymodes" nowrap="nowrap" style="cursor: pointer; ">
		<a href="http://www.clubdelphi.com/foros/showthread.php?t=55924&nojs=1#goto_displaymodes">Desplegado</a>
		<script type="text/javascript"> vbmenu_register("displaymodes"); </script> <img src="./Inyección directa de código IV_files/menu_open.gif" border="0" title="" alt="">
	</td>
	
	
	
	
</tr>
</tbody></table>
<!-- / toolbar -->



<!-- end content table -->

		</div>	
	</div>
</div>

<!-- / close content container -->
<!-- / end content table -->





<div id="posts"><!-- post #283694 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit283694" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post283694" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=283694&postcount=1" target="new" rel="nofollow" id="postcount283694" name="1"><strong>1</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post283694"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				01-05-2008
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_283694">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=17906">rolandoj</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="rolandoj is offline" border="0" title="rolandoj is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_283694", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: abr  2007</div>
					
					
					<div>
						<b>Posts</b>: 245
					</div>
					
					
					<div><span id="repdisplay_283694_17906"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="rolandoj is on a distinguished road" border="0" title="rolandoj is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_283694">
	<!-- message, attachments, sig -->
	
		
		
		
			<!-- icon and title -->
			<div class="smallfont">
				<img class="inlineimg" src="./Inyección directa de código IV_files/icon7.gif" alt="Smile" border="0" title="Smile">
				<strong>Como inyectar código directamente a un proceso externo</strong>
			</div>
			<hr size="1" style="color:#D1D1E1">
			<!-- / icon and title -->
		
		
		<!-- message -->
		<div id="post_message_283694">Hola,<br>
 <br>
Ante una de petición de Khronos, he creído util crear un hilo para analizar el método de inyección de código dentro de un proceso directamente desde nuestro programa, como contraposición al método de inyectarlo vía un DLL.<br>
 <br>
La idea surge por un problema que me he encontrado y describo en este hilo :<br>
 <br>
<a href="http://www.clubdelphi.com/foros/showthread.php?t=55785" target="_blank">http://www.clubdelphi.com/foros/showthread.php?t=55785</a><br>
 <br>
Voy a describir el proceso tal y como yo lo entiendo, advirtiendo que hay puntos en los que tengo dudas, o pudiera estar errado, así que espero que haya quienes puedan aclararlas. <br>
 <br>
Empiezo diciendo que este método tiene fuertes restricciones; pero es muy eficiente. Su uso solo se justifica cuando necesitamos acceder a alguna información del proceso remoto que solo está disponible vía rutinas de Windows que no aceptan especificarles un proceso sino que actuan sobre <br>
el proceso dentro del cual se ejecutan (Hay varias que trabajan así)<br>
 <br>
Programáticamente, el orden de acciones para el tema sería :<br>
 <br>
1. Definición de los datos necesarios para pasar a nuestra rutina<br>
2. Escritura de la rutina<br>
3. Obtención del manejador del proceso externo al que deseamos inyectar nuestro código<br>
4. Preparación de los datos a enviarle desde nuestro programa<br>
5. Obtención de la memoria, en el proceso externo, que usaremos en nuestro aplicativo<br>
6. Ejecución del proceso<br>
7. Obtención de resultados<br>
8. Liberación de recursos<br>
 <br>
Pero, conceptualmente, creo mejor empezar discutiendo la ejecución del proceso en sí porque el entender esto abre la puerta para los demás pasos. Veamos:<br>
 <br>
Ejecutar una rutina en un proceso externo significa básicamente que una rutina compilada dentro del espacio de direcciones de nuestra aplicación vá a ejecutarse en el espacio de direcciones de un proceso que usualmente no hemos escrito nosotros y del cual ni siquiera tenemos los fuentes.<br>
 <br>
Si consideamos que cuando llamamos rutinas dentro de nuestro programa estamos referenciando a direcciones de memoria en el espacio de direcciones de nuestra aplicación, la primera dificultad que nos salta a la vista es : Y como se localizan esas direcciones desde la rutina que vamos a inyectar si esta estará ejecutandose en un espacio de direcciones diferente ?. Y de ahí se deriva otra : Si la rutina a inyectar tiene su dirección de memoria en nuestro espacio, como puede el otro proceso referenciarla y ejecutarla en su propio espacio ?<br>
 <br>
Bueno, para responder lo anterior digamos que existe una rutina de Windows llamada CreateRemoteThread que se encarga de ejecutar la nuestra en el proceso externo. Como su nombre lo indica, lo que hace es ejecutar un hilo dentro del proceso remoto, y ese hilo consiste en ejecutar la rutina que inyectamos. Veamos la definición de CreateRemoteThread en Delphi:<br>
 <br>
<pre class="delphi"><div class="frame_codigo_delphi">Código Delphi <a id="delphi_ancla_4d750dc41bd3a" href="http://www.clubdelphi.com/foros/showthread.php?t=55924#" onclick="etiqueta_delphi(&#39;delphi_div_4d750dc41bcfe&#39;,&#39;delphi_ancla_4d750dc41bd3a&#39;); return false;" title="Contraer cuadro de código" style="text-decoration: none" hidefocus="true">[-]</a><div id="delphi_div_4d750dc41bcfe" class="texto_codigo_delphi"><pre><span class="keyword">function</span> CreateRemoteThread(hProcess: THandle; 
   lpThreadAttributes: Pointer;
   dwStackSize: DWORD; 
   lpStartAddress: TFNThreadStartRoutine; 
   lpParameter: Pointer;
   dwCreationFlags: DWORD; 
   <span class="keyword">var</span> lpThreadId: DWORD): THandle; stdcall;</pre></div></div></pre> <br>
No es mi intención duplicar la explicación que puede encontrarse en Windows, sino comentar los puntos importantes :<br>
 <br>
hProcess es el manejador del proceso al cual le queremos inyectar la rutina<br>
lpThreadAttributes es un apuntador a una estructura de atributos de seguridad para la ejecución del hilo bajo el cual correrá nuestra rutina. Si se usa Nil, el sistema usará uno por default. A efectos prácticos, a mi me ha funcionado bien con Nil; pero son bienvenidos mayores detalles<br>
 <br>
dwStackSize es el tamaño de la pila usada por el hilo y para simplicidad, usemos 0 lo que hace que el sistema adopte el mismo tamaño de la pila principal del proceso remoto   <br>
 <br>
lpStartAddress es la dirección inicial de la rutina que queremos inyectar; pero, <i><font color="red"><b>la dirección inicial que ella tendrá dentro del espacio de direcciones del proceso remoto</b></font></i>. En otras palabras, si nuestra rutina se llamara MiRutinaRemota, este parámetro <font color="red"><b><i>no es @MiRutinaRemota</i></b></font> , ya que el @ <br>
nos da la dirección; pero dentro de nuestro propio espacio. Queda claro entonces que para pasar este parámetro primero tenemos que averiguar su valor, lo que realmente se hace en el paso 5 que habiamos mencionado. Por otra parte, no puede ser cualquier rutina, tiene que seguir ciertas <br>
reglas que veremos después<br>
 <br>
lpParameter : Este parámetro representa el único parámetro que podemos pasar desde nuestro programa al proceso externo y no solo es quizás el punto más importante sino también el peor documentado en la ayuda de Windows. <br>
 <br>
En teoría, puede usarse este valor para pasar un entero a la rutina, o no pasarle nada e indicarlo usando 0; pero, para que la rutina tenga utilidad práctica, el parámetro debe ser un apuntador a una estructura de datos tipo Record que contenga los parámetros de entrada-salida que enviemos a la rutina, y eso no es todo.<br>
 <br>
La rutina recibirá este parámetro como un apuntador; pero la rutina se ejecuta en otro proceso por tanto, <font color="red"><i><b>los datos a que apunte este valor deben estar en el espacio de direcciones de ese proceso externo</b></i></font>, no en el nuestro. Dicho en otras palabra, si por ejemplo nosotros definimos lo <br>
siguiente:<br>
 <br>
<pre class="delphi"><div class="frame_codigo_delphi">Código Delphi <a id="delphi_ancla_4d750dc41c838" href="http://www.clubdelphi.com/foros/showthread.php?t=55924#" onclick="etiqueta_delphi(&#39;delphi_div_4d750dc41c7fe&#39;,&#39;delphi_ancla_4d750dc41c838&#39;); return false;" title="Contraer cuadro de código" style="text-decoration: none" hidefocus="true">[-]</a><div id="delphi_div_4d750dc41c7fe" class="texto_codigo_delphi"><pre><span class="keyword">Type</span>
    TRemoto = <span class="keyword">Record</span>
      MIVALOR:     Integer;
      MIRESULTADO: Boolean;
    <span class="keyword">End</span>;
<span class="keyword">Var</span>
    MisDatos: TRemoto,</pre></div></div></pre> <br>
Al momento de llamar a CreateRemoteThread <font color="red"><i><b>no podemos pasar @MisDatos</b></i></font> como lpParameter, por el mismo razonamiento de @MiRutinaRemota. Necesitamos primero que esos datos queden en el espacio de direcciones de nuestro proceso remoto y obtener la dirección que tengan en él; lo que al igual que con la rutina, se hace en el paso 5 mencionado.<br>
 <br>
Acabo diciendo que dentro de TRemoto lo normal será colocar ciertos valores auxiliares para la lógica de nuestro problema; es decir, no se trata simplemente de colocar ahí solo los parámetros que usualmente tendría nuestra rutina, hay que incluír cierta información adicional que explicaré <br>
cuando describa las reglas que deberá cumplir nuestra rutina<br>
 <br>
dwCreationFlags brinda facilidades para manipular el hilo. En mi caso, y creo que será lo normal, solo paso 0 porque con eso el hilo se ejecuta enseguida.<br>
 <br>
lpThreadId es una variable de salida que devuelve el identificador del hilo creado (no muy útil desde mi punto de vista).<br>
 <br>
La rutina en sí devuelve el manejador del hilo creado; lo que puede usarse desde nuestro programa para determinar cuando se termina el hilo. Igualmente, puede decirnos si hubo errores, ya que en tal caso el valor devuelto es Nil y deberíamos usar GetLastError para obtener más información del error.<br>
 <br>
Bien entendido, CreateRemoteThread está es ejecutando un hilo y, aún cuando la ejecución empiece enseguida, el control puede devolverse a nuestro programa sin que el hilo, o la rutina remota, hayan terminado; por esto, en nuestro aplicativo deberíamos controlar el fin del hilo usando el <br>
manejador devuelto por la rutina.<br>
 <br>
Así las cosas, la llamada a CreateRemoteThread sería algo como :<br>
 <br>
<pre class="delphi"><div class="frame_codigo_delphi">Código Delphi <a id="delphi_ancla_4d750dc41d27b" href="http://www.clubdelphi.com/foros/showthread.php?t=55924#" onclick="etiqueta_delphi(&#39;delphi_div_4d750dc41d241&#39;,&#39;delphi_ancla_4d750dc41d27b&#39;); return false;" title="Contraer cuadro de código" style="text-decoration: none" hidefocus="true">[-]</a><div id="delphi_div_4d750dc41d241" class="texto_codigo_delphi"><pre><span class="keyword">Var</span>
   AProcess:         THandle;
   AExtFuncAddr:     Pointer;
   AExtDataAddr:     Pointer;
   lpThreadId:       DWORD;
   hThread:          THandle;
<span class="keyword">Begin</span>
     ...
     ..
     hThread := CreateRemoteThread(AProcess,<span class="keyword">nil</span>,0,AExtFuncAddr,AExtDataAddr,0,lpThreadId);
     .....
     ...
<span class="keyword">End</span>;</pre></div></div></pre> <br>
Bueno, creo que hasta aquí está bien de la primera parte que ya de por sí ha sido muy larga. Voy a esperar a ver si hay quienes se interesan, o puedan aportar, antes de seguír con el resto.</div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=283694" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 283694 popup menu -->
<div class="vbmenu_popup" id="postmenu_283694_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">rolandoj</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=17906">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=17906" rel="nofollow">Encontrar Todos los Mensajes de rolandoj</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 283694 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #283694 --><!-- post #285123 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit285123" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post285123" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=285123&postcount=2" target="new" rel="nofollow" id="postcount285123" name="2"><strong>2</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post285123"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				08-05-2008
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_285123">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=17906">rolandoj</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="rolandoj is offline" border="0" title="rolandoj is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_285123", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: abr  2007</div>
					
					
					<div>
						<b>Posts</b>: 245
					</div>
					
					
					<div><span id="repdisplay_285123_17906"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="rolandoj is on a distinguished road" border="0" title="rolandoj is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_285123">
	<!-- message, attachments, sig -->
	
		
		
		
			<!-- icon and title -->
			<div class="smallfont">
				
				<strong>Por falta de interés, no seguirá la explicación</strong>
			</div>
			<hr size="1" style="color:#D1D1E1">
			<!-- / icon and title -->
		
		
		<!-- message -->
		<div id="post_message_285123">Hola,<br>
 <br>
A todos los que han visitado este hilo les agradezco al menos haberlo hecho y les comentó lo siguiente :<br>
 <br>
Ha pasado casi una semana y aunque ha habido un número decente de visitas, nadie ha manifestado interes por el tema, en consecuencia no continuaré con la explicación de los restantes puntos.<br>
 <br>
En lo personal, creo que el tema es técnicamente muy interesante y esta pobremente documentado; pero reconozco que el uso de esta técnica es para situaciones especiales. Como igualmente supongo que la mayoría, al igual que yo, son personas muy ocupadas, entiendo que no le den mayor peso al tema, y en esas circunstancias no se justifica dedicarle tiempo para detallarlo paso a paso</div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=285123" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 285123 popup menu -->
<div class="vbmenu_popup" id="postmenu_285123_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">rolandoj</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=17906">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=17906" rel="nofollow">Encontrar Todos los Mensajes de rolandoj</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 285123 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #285123 --><!-- post #285853 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit285853" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post285853" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=285853&postcount=3" target="new" rel="nofollow" id="postcount285853" name="3"><strong>3</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post285853"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				11-05-2008
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_285853">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=27333">xjre</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="xjre is offline" border="0" title="xjre is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_285853", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: feb  2008</div>
					
					
					<div>
						<b>Posts</b>: 11
					</div>
					
					
					<div><span id="repdisplay_285853_27333"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="xjre is on a distinguished road" border="0" title="xjre is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_285853">
	<!-- message, attachments, sig -->
	
		
		
		
		
		<!-- message -->
		<div id="post_message_285853">Hola, qué tal?<br>
 <br>
Llevo solo un par de meses programando en delphi y solo un par mas programando en si. Estaba viendo los threads que había en API Windows para ver si en una de esas , alguno servía. <br>
Este me llamó poderosamente la atención por una razón: Lo que se esta haciendo con este procedimiento y el explicado en el link que pusiste, ¿no es "hackear" otra aplicación circundante o estoy confundiendo términos? Me refiero a que según entendí lo que se esta haciendo es meter código nuevo a una aplicación que ya esta corriendo.<br>
 <br>
Saludos</div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=285853" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 285853 popup menu -->
<div class="vbmenu_popup" id="postmenu_285853_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">xjre</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=27333">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=27333" rel="nofollow">Encontrar Todos los Mensajes de xjre</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 285853 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #285853 --><!-- post #327359 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit327359" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post327359" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=327359&postcount=4" target="new" rel="nofollow" id="postcount327359" name="4"><strong>4</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post327359"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				22-11-2008
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_327359">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=17906">rolandoj</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="rolandoj is offline" border="0" title="rolandoj is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_327359", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: abr  2007</div>
					
					
					<div>
						<b>Posts</b>: 245
					</div>
					
					
					<div><span id="repdisplay_327359_17906"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="rolandoj is on a distinguished road" border="0" title="rolandoj is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_327359">
	<!-- message, attachments, sig -->
	
		
		
		
			<!-- icon and title -->
			<div class="smallfont">
				<img class="inlineimg" src="./Inyección directa de código IV_files/icon7.gif" alt="Smile" border="0" title="Smile">
				<strong>Escritura de la rutina a inyectar</strong>
			</div>
			<hr size="1" style="color:#D1D1E1">
			<!-- / icon and title -->
		
		
		<!-- message -->
		<div id="post_message_327359">Hola,<br>
 <br>
En vista de que nadie se interesó, había abandonado este hilo; pero, he recibido una petición personal para continuarlo, así quea quí hay más detalles:<br>
 <br>
Ya hemos visto la idea central y analizado un poco el punto de arranque, o sea la definición de los datos. pasemos al punto 2, la escritura de nuestra rutina:<br>
 <br>
También sabemos que la rutina a escribir tiene un solo parámetro que es un apuntador a una estructura tipo Record. Nuestro proceso luce entonces algo como:<br>
 <br>
<pre class="delphi"><div class="frame_codigo_delphi">Código Delphi <a id="delphi_ancla_4d750dc41f1b2" href="http://www.clubdelphi.com/foros/showthread.php?t=55924#" onclick="etiqueta_delphi(&#39;delphi_div_4d750dc41f178&#39;,&#39;delphi_ancla_4d750dc41f1b2&#39;); return false;" title="Contraer cuadro de código" style="text-decoration: none" hidefocus="true">[-]</a><div id="delphi_div_4d750dc41f178" class="texto_codigo_delphi"><pre><span class="keyword">Function</span> ProcesoExterno(dwEntryPoint: PRemoteStruct): longword; stdcall;</pre></div></div></pre> <br>
Ahora bien, lo crítico aquí es entender que como esta rutina se ejecuta en el espacio de direcciones de otro proceso, cualquier dato no local (o sea, difererente a variables locales de la rutina, al parámetro, u otras rutinas a llamar) tiene que estar en el espacio de direcciones del otro proceso.<br>
 <br>
Así pués, que pasa si por ejemplo quisieramos llamar a la rutina GetCommandLine de Windows ?<br>
 <br>
Si intentáramos algo como esto:<br>
 <br>
<pre class="delphi"><div class="frame_codigo_delphi">Código Delphi <a id="delphi_ancla_4d750dc41f624" href="http://www.clubdelphi.com/foros/showthread.php?t=55924#" onclick="etiqueta_delphi(&#39;delphi_div_4d750dc41f5ea&#39;,&#39;delphi_ancla_4d750dc41f624&#39;); return false;" title="Contraer cuadro de código" style="text-decoration: none" hidefocus="true">[-]</a><div id="delphi_div_4d750dc41f5ea" class="texto_codigo_delphi"><pre><span class="keyword">function</span> ProcesoExterno(dwEntryPoint: PRemoteStruct): longword; stdcall;
<span class="keyword">Var</span>
   TheLine:     <span class="keyword">String</span>; 
<span class="keyword">Begin</span>
     ....
     ..
     TheLine := StrPas(GetCommandLine);
     ...
<span class="keyword">End</span>;</pre></div></div></pre> <br>
El resultado sería un total desastre. Con lo dicho, es claro que al compilar la dirección de StrPas queda con respecto a nuestro espacio de direcciones, no el del otro proceso, y lo mismo aplica para GetCommandLine.<br>
 <br>
Y entonces como se hace ?.<br>
 <br>
La manera de proceder es pasar, como campos de la estructura RemoteStruct, las direcciones, dentro del espacio del otro proceso, de las rutinas que necesitemos llamar. Esto, de todas formas es muy restringido porque solo aplica para ciertas rutinas de Windows, como explicaremos más adelante. Por ahora, concentremonos en como quedaría la rutina;<br>
 <br>
<pre class="delphi"><div class="frame_codigo_delphi">Código Delphi <a id="delphi_ancla_4d750dc41fbc9" href="http://www.clubdelphi.com/foros/showthread.php?t=55924#" onclick="etiqueta_delphi(&#39;delphi_div_4d750dc41fb8f&#39;,&#39;delphi_ancla_4d750dc41fbc9&#39;); return false;" title="Contraer cuadro de código" style="text-decoration: none" hidefocus="true">[-]</a><div id="delphi_div_4d750dc41fb8f" class="texto_codigo_delphi"><pre><font face="Verdana"><span class="keyword">function</span> ProcesoExterno(dwEntryPoint: PRemoteStruct): longword; stdcall;
<span class="keyword">Var</span>
   TheLine:     PChar; 
<span class="keyword">Begin</span>
     ....
     ..
     TheLine := dwEntryPoint^.DGetCommandLine;
     ...
<span class="keyword">End</span>;</font></pre></div></div></pre> <br>
El cambio de String a PChar es porque, según lo expuesto, no podemos llamar a StrPas, tenemos por tanto que limitarnos al uso de Windows, o sea al PChar.<br>
 <br>
Observese que se está llamando una Variable, correspondiente a un campo de dwEntryPoint, que debe ser del tipo Function. Por tanto, la definición de RemoteStruct debe tener en cuenta eso. Quedaría algo así:<br>
 <br>
<pre class="delphi"><div class="frame_codigo_delphi">Código Delphi <a id="delphi_ancla_4d750dc420190" href="http://www.clubdelphi.com/foros/showthread.php?t=55924#" onclick="etiqueta_delphi(&#39;delphi_div_4d750dc420157&#39;,&#39;delphi_ancla_4d750dc420190&#39;); return false;" title="Contraer cuadro de código" style="text-decoration: none" hidefocus="true">[-]</a><div id="delphi_div_4d750dc420157" class="texto_codigo_delphi"><pre><span class="keyword">Type</span>
    TFncSendMessage = <span class="keyword">Function</span>(hWnd: HWND; Msg: UINT; wParam: WPARAM; lParam: LPARAM): LRESULT; stdcall;
    TFncGetCommandLine = <span class="keyword">Function</span>: PChar; stdcall;
 
    PRemoteStruct = ^TRemoteStruct;
    TRemoteStruct = <span class="keyword">Record</span>
       ....
       ..
       DSendMessage:           TFncSendMessage;  
       DGetCommandLine:        TFncGetCommandLine;
       ..
       . 
    <span class="keyword">End</span>;</pre></div></div></pre> <br>
Para ser más claro, he incluído otra función de Windows, SendMessage, resaltando que se debe definir el prototipo completo de la función, incluyendo los parámetros de la misma<br>
 <br>
Según esta lógica, es claro que se debe llenar DGetCommandLine en nuestro proceso con la dirección que dicha rutina tenga en el otro proceso. Como obtemo esa dirección ? Lo veremos en la próxima entrega.</div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=327359" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 327359 popup menu -->
<div class="vbmenu_popup" id="postmenu_327359_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">rolandoj</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=17906">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=17906" rel="nofollow">Encontrar Todos los Mensajes de rolandoj</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 327359 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #327359 --><!-- post #327668 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit327668" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post327668" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=327668&postcount=5" target="new" rel="nofollow" id="postcount327668" name="5"><strong>5</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post327668"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				24-11-2008
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_327668">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=25490">alquimista</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="alquimista is offline" border="0" title="alquimista is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_327668", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: ene  2008</div>
					
					
					<div>
						<b>Posts</b>: 123
					</div>
					
					
					<div><span id="repdisplay_327668_25490"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="alquimista is on a distinguished road" border="0" title="alquimista is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_327668">
	<!-- message, attachments, sig -->
	
		
		
		
			<!-- icon and title -->
			<div class="smallfont">
				<img class="inlineimg" src="./Inyección directa de código IV_files/icon10.gif" alt="Talking" border="0" title="Talking">
				
			</div>
			<hr size="1" style="color:#D1D1E1">
			<!-- / icon and title -->
		
		
		<!-- message -->
		<div id="post_message_327668">creo que la información que estas posteando es muy interesante y valiosa.<br>
Creo que si la gente no contesta es porque no es una cosa muy usual lo que explicas<img src="./Inyección directa de código IV_files/confused.gif" border="0" alt="" title="Confused" class="inlineimg">. Y no todo el mundo puede seguir estos temas (incluido yo mismo), aunque tengo interes en este tema.<br>
<br>
Por lo que te animo  a continuar e incluso pienso que este tema es para hacer un tutorial extenso.<br>
<br>
Gracias por ser generoso y compartir tus conocimientos.<br>
<br>
Un saludo....</div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=327668" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 327668 popup menu -->
<div class="vbmenu_popup" id="postmenu_327668_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">alquimista</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=25490">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=25490" rel="nofollow">Encontrar Todos los Mensajes de alquimista</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 327668 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #327668 --><!-- post #328840 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit328840" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post328840" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=328840&postcount=6" target="new" rel="nofollow" id="postcount328840" name="6"><strong>6</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post328840"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				30-11-2008
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_328840">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=17906">rolandoj</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="rolandoj is offline" border="0" title="rolandoj is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_328840", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: abr  2007</div>
					
					
					<div>
						<b>Posts</b>: 245
					</div>
					
					
					<div><span id="repdisplay_328840_17906"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="rolandoj is on a distinguished road" border="0" title="rolandoj is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_328840">
	<!-- message, attachments, sig -->
	
		
		
		
		
		<!-- message -->
		<div id="post_message_328840"><div style="margin:20px; margin-top:5px; ">
	<div class="smallfont" style="margin-bottom:2px">Cita:</div>
	<table cellpadding="6" cellspacing="0" border="0" width="100%">
	<tbody><tr>
		<td class="alt2" style="border:1px inset">
			
				<div>
					Empezado por <strong>alquimista</strong>
					<a href="http://www.clubdelphi.com/foros/showthread.php?p=327668#post327668" rel="nofollow"><img class="inlineimg" src="./Inyección directa de código IV_files/viewpost.gif" border="0" alt="Ver Mensaje" title="Ver Mensaje"></a>
				</div>
				<div style="font-style:italic">creo que la información que estas posteando es muy interesante y valiosa.<br>
Creo que si la gente no contesta es porque no es una cosa muy usual lo que explicas<img src="./Inyección directa de código IV_files/confused.gif" border="0" alt="" title="Confused" class="inlineimg">. Y no todo el mundo puede seguir estos temas (incluido yo mismo), aunque tengo interes en este tema.<br>
 <br>
Por lo que te animo a continuar e incluso pienso que este tema es para hacer un tutorial extenso.<br>
 <br>
Gracias por ser generoso y compartir tus conocimientos.<br>
 <br>
Un saludo....</div>
			
		</td>
	</tr>
	</tbody></table>
</div>Hola,<br>
 <br>
Gracias por el comentario. Ciertamente, comparto tús apreciaciones.<br>
 <br>
Quiero disculparme con los que estén interesados en el tema. Sí tengo la intención de terminarlo; pero, un exceso de trabajo me ha impedido elaborar el siguiente punto. Espero hacerlo a mediados de la semana de Diciembre</div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=328840" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 328840 popup menu -->
<div class="vbmenu_popup" id="postmenu_328840_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">rolandoj</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=17906">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=17906" rel="nofollow">Encontrar Todos los Mensajes de rolandoj</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 328840 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #328840 --><!-- post #328859 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit328859" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post328859" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=328859&postcount=7" target="new" rel="nofollow" id="postcount328859" name="7"><strong>7</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post328859"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				01-12-2008
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_328859">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=24088">escafandra</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="escafandra is offline" border="0" title="escafandra is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_328859", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: nov  2007</div>
					
					
					<div>
						<b>Posts</b>: 817
					</div>
					
					
					<div><span id="repdisplay_328859_24088"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="escafandra is on a distinguished road" border="0" title="escafandra is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_328859">
	<!-- message, attachments, sig -->
	
		
		
		
		
		<!-- message -->
		<div id="post_message_328859">Bueno, cuando alguien se propone publicar tutoriales o explicaciones sobre temas complejos o poco comunes, siempre espera un poco de apoyo. No puedo leer tu hilo sin demostrarte explícitamente mi interés.<img src="./Inyección directa de código IV_files/biggrin.gif" border="0" alt="" title="Big Grin" class="inlineimg"><br>
<br>
Aunque yo programo en C fundamentalmente y apenas domino el delphi, te sigo perfectamente. Veo que te centras, de momento, en la inyección con la API CreateRemoteThread. ¿Has pensado en otras técnicas?. Digo esto porque numerosos antivirus y cortafuegos tienen un Hook a esa API y bloquean la inyección. Y no es que el objetivo sea burlar un antivirus, que de hecho muchos de ellos son burlados inyectando así, sino por curiosidad técnica... Que conste que no pretendo desviar tu exposición.<br>
<br>
El tema de inyectar sin dll es más complejo que si lo hacemos con dll recibe mi apoyo por atreverte decidirte en abordar este tema.<img src="./Inyección directa de código IV_files/wink.gif" border="0" alt="" title="Wink" class="inlineimg"><br>
<br>
Saludos.</div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
		<!-- edit note -->
			<div class="smallfont">			<hr size="1" style="color:#D1D1E1">
				<em>
				Última edición por escafandra fecha: 01-12-2008 a las <span class="time">01:24:03</span>.
				
				</em>
			</div>
		<!-- / edit note -->
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=328859" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 328859 popup menu -->
<div class="vbmenu_popup" id="postmenu_328859_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">escafandra</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=24088">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=24088" rel="nofollow">Encontrar Todos los Mensajes de escafandra</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 328859 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #328859 --><!-- post #328868 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit328868" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post328868" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=328868&postcount=8" target="new" rel="nofollow" id="postcount328868" name="8"><strong>8</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post328868"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				01-12-2008
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			<td class="alt2"><a href="http://www.clubdelphi.com/foros/member.php?u=371"><img src="./Inyección directa de código IV_files/image.php" width="59" height="60" alt="Avatar de Al González" border="0" title="Avatar de Al González"></a></td>
			<td nowrap="nowrap">
			
				<div id="postmenu_328868">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=371">[Al González]</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="Al González is offline" border="0" title="Al González is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_328868", true); </script>
					
				</div>
				
				<div class="smallfont">Miembro Premium</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: may  2003</div>
					<div><b>Ubicación</b>: Morelia, México.</div>
					
					<div>
						<b>Posts</b>: 3.168
					</div>
					
					
					<div><span id="repdisplay_328868_371"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="Al González is on a distinguished road" border="0" title="Al González is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_328868">
	<!-- message, attachments, sig -->
	
		
		
		
			<!-- icon and title -->
			<div class="smallfont">
				<img class="inlineimg" src="./Inyección directa de código IV_files/icon14.gif" alt="Thumbs up" border="0" title="Thumbs up">
				
			</div>
			<hr size="1" style="color:#D1D1E1">
			<!-- / icon and title -->
		
		
		<!-- message -->
		<div id="post_message_328868">Hola amigos.<br>
<br>
<b>Rolando</b>, acabo de enterarme de la existencia de este interesante hilo.  Y pensar que vienes planteando esto desde mayo.  <img src="./Inyección directa de código IV_files/frown.gif" border="0" alt="" title="Frown" class="inlineimg"><br>
<br>
He leído por completo el planteamiento hecho aquí y en el otro hilo que refieres al principio.  Francamente desconocía que existiese algo como la función <b>CreateRemoteThread</b>, aunque ahora que lo pienso, quizá ella es una de las claves de cómo funcionan los depuradores.<br>
<br>
Ya leí la ayuda de ésta en el archivo de oro Win32.hlp que viene con todo Delphi.  Y también encontré <a href="http://www.google.com/codesearch?hl=es&q=CreateRemoteThread+lang:pascal+show:gdj1cxdSCpI:Y46v4F7CuCA:gdj1cxdSCpI&sa=N&cd=4&ct=rc&cs_p=http://asmprofiler.googlecode.com/svn&cs_f=trunk/DllInjection/Method2/dllinject_m2.dpr" target="_blank">esto</a> en Google Code Search.  Es un ejemplo muy bien explicado, del cual me llamó la atención esta parte:<br>
<br>
<div style="margin:20px; margin-top:5px; ">
	<div class="smallfont" style="margin-bottom:2px">Cita:</div>
	<table cellpadding="6" cellspacing="0" border="0" width="100%">
	<tbody><tr>
		<td class="alt2" style="border:1px inset">
			
				HMODULE pfnLoadLibrary =<br>
	GetProcAddress(LoadLibrary("kernel32.dll"), "LoadLibraryA" );<br>
<br>
hThread = ::CreateRemoteThread(hProcessForHooking,<br>
                                      NULL,<br>
                                      0,<br>
                                      pfnLoadLibrary,<br>
                                      "C:\\HookTool.dll",<br>
                                      0,<br>
                                      NULL);<br>
<br>
By using GetProcAddress() API we get the address of the LoadLibrary() API.<br>
The dodgy thing here is that <b>Kernel32.DLL is mapped always to the same<br>
address space of each process, thus the address of LoadLibrary()<br>
function has the same value in address space of any running process.<br>
This ensures that we pass a valid pointer (i.e. pfnLoadLibrary)<br>
as parameter of CreateRemoteThread()</b>.
			
		</td>
	</tr>
	</tbody></table>
</div>Sé que buscas inyectar código máquina que no forma parte de una DLL.  Pero puse esa referencia porque me llama mucho la atención lo que marqué con negritas.<br>
<br>
Por un lado pienso, "<i>ah, pues entonces sólo con DLLs nativas se puede</i>", pero la pregunta que inmediatamente me salta es: ¿Cómo le hace Windows cuando llamamos a una función de su API que recibe una rutina de retrollamada (<i>call back</i>) como parámetro, puesto que solemos usar un simple "@Rutina"?<br>
<br>
Y mientras terminaba de escribir esta tonta pregunta ya me respondía a mí mismo: Ah, pues ahí no hay problema porque cuando llamamos a esa función de la API, su DLL fue previamente cargada en el espacio de nuestro propio proceso, así que la dirección dada por el arroba es perfectamente válida.<br>
<br>
Pero entonces me queda la inquietud: <b>¿realmente puede instalarse una rutina de un proceso en ejecución dentro del espacio y contexto de otro proceso?  ¿O en la práctica esto de la inyección de código máquina sólo es posible definiendo la rutina en una DLL y haciendo que un LoadLibrary inyectado con CreateRemoteThread cargue esa DLL en el proceso ajeno?</b><br>
<br>
Que interesante tema, en verdad.  Estaré pendiente de los avances, esperemos llegar a un feliz desenlace. <img src="./Inyección directa de código IV_files/smile.gif" border="0" alt="" title="Smilie" class="inlineimg"><br>
<br>
Y bueno, me despido por unas horas, porque si no mi chica me enviará a un lugar muy muy remoto. <img src="./Inyección directa de código IV_files/biggrin.gif" border="0" alt="" title="Big Grin" class="inlineimg"><br>
<br>
Un abrazo inyectado.<br>
<br>
Al González. <img src="./Inyección directa de código IV_files/smile.gif" border="0" alt="" title="Smilie" class="inlineimg"><br>
<br>
<b>P.D.</b>  Una duda más: ¿cómo es posible que el proceso remoto pueda usar el parámetro "C:\\HookTool.dll", si al compilarse el programa esa constante quedaría en el espacio de memoria del proceso inyector? <img src="./Inyección directa de código IV_files/confused.gif" border="0" alt="" title="Confused" class="inlineimg"></div>
		<!-- / message -->
	
		
		
		
		
		
		<!-- sig -->
			<div>
				__________________<br>
				&#9632; Conoce <a href="http://rescatandoadelphi.blogspot.com/" target="_blank">mi bitácora</a>. &#9632; Escucho propuestas para trabajar fuera de México.
			</div>
		<!-- / sig -->
		
		
		
		
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=328868" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 328868 popup menu -->
<div class="vbmenu_popup" id="postmenu_328868_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">Al González</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=371">Ver Perfil</a></td></tr>
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://rescatandoadelphi.blogspot.com/">¡Visita mi Sitio!</a></td></tr>
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=371" rel="nofollow">Encontrar Todos los Mensajes de Al González</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 328868 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #328868 --><!-- post #328880 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit328880" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post328880" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=328880&postcount=9" target="new" rel="nofollow" id="postcount328880" name="9"><strong>9</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post328880"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				01-12-2008
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_328880">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=24088">escafandra</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="escafandra is offline" border="0" title="escafandra is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_328880", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: nov  2007</div>
					
					
					<div>
						<b>Posts</b>: 817
					</div>
					
					
					<div><span id="repdisplay_328880_24088"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="escafandra is on a distinguished road" border="0" title="escafandra is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_328880">
	<!-- message, attachments, sig -->
	
		
		
		
		
		<!-- message -->
		<div id="post_message_328880">Pues creo que la intención de <b>rolandoj</b> es injectar código sin dll. Si que se puede...<br>
Para poder colocar "algo" en el espacio de direcciones ajeno, tenemos varias API que lo permiten:<br>
<br>
OpenProcess  // Abre un proceso;<br>
VirtualAllocEx  // Reserva memoria en un proceso<br>
WriteProcessMemory // Escribe en la memoria de un proceso reservada por VirtualAllocEx<br>
VirtualFree // Libera la memoria reservada por VirtualAllocEx<br>
<br>
Las DLL nativas se cargan siempre en el mismo espacio relativo de cada proceso, no así las demás dlls.<br>
<br>
Saludos.</div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=328880" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 328880 popup menu -->
<div class="vbmenu_popup" id="postmenu_328880_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">escafandra</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=24088">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=24088" rel="nofollow">Encontrar Todos los Mensajes de escafandra</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 328880 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #328880 --><!-- post #328883 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit328883" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post328883" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=328883&postcount=10" target="new" rel="nofollow" id="postcount328883" name="10"><strong>10</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post328883"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				01-12-2008
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			<td class="alt2"><a href="http://www.clubdelphi.com/foros/member.php?u=371"><img src="./Inyección directa de código IV_files/image.php" width="59" height="60" alt="Avatar de Al González" border="0" title="Avatar de Al González"></a></td>
			<td nowrap="nowrap">
			
				<div id="postmenu_328883">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=371">[Al González]</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="Al González is offline" border="0" title="Al González is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_328883", true); </script>
					
				</div>
				
				<div class="smallfont">Miembro Premium</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: may  2003</div>
					<div><b>Ubicación</b>: Morelia, México.</div>
					
					<div>
						<b>Posts</b>: 3.168
					</div>
					
					
					<div><span id="repdisplay_328883_371"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="Al González is on a distinguished road" border="0" title="Al González is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_328883">
	<!-- message, attachments, sig -->
	
		
		
		
			<!-- icon and title -->
			<div class="smallfont">
				<img class="inlineimg" src="./Inyección directa de código IV_files/icon7.gif" alt="Smile" border="0" title="Smile">
				
			</div>
			<hr size="1" style="color:#D1D1E1">
			<!-- / icon and title -->
		
		
		<!-- message -->
		<div id="post_message_328883">Hola de nuevo.<br>
<br>
Indagando encontré respuestas a las dudas que me surgieron en el mensaje anterior.<br>
<br>
<b>1.</b> El código que cité arriba más bien era seudocódigo, el real conlleva complejidades adicionales pero por lo visto superables.<br>
<br>
<b>2.</b> Efectivamente, el parámetro <i>lpParameter</i> dado a la función CreateRemoteThread, debe ser una dirección de memoria válida para el proceso remoto.  El truco para esto es obtener ésta con la función <b>VirtualAllocEx</b> y escribir en ella el argumento con la función <b>WriteProcessMemory</b>.  ¡Por lo visto podemos escribir datos directamente en la memoria de otros procesos! <img src="./Inyección directa de código IV_files/eek.gif" border="0" alt="" title="EEK!" class="inlineimg"><br>
<br>
<b>3.</b> El ejemplo de <b>Rezmond</b> que <a href="http://www.google.com/codesearch?hl=es&q=CreateRemoteThread+lang:pascal+show:gdj1cxdSCpI:Y46v4F7CuCA:gdj1cxdSCpI&sa=N&cd=4&ct=rc&cs_p=http://asmprofiler.googlecode.com/svn&cs_f=trunk/DllInjection/Method2/dllinject_m2.dpr" target="_blank">enlacé</a> arriba es sólo el segundo de al menos dos maneras que él plantea para lograr la inyección.  <a href="http://www.google.com/codesearch?hl=es&q=dllinject+show:ySWvIulS-D8:DnqB43gDzno:ySWvIulS-D8&sa=N&cd=2&ct=rc&cs_p=http://asmprofiler.googlecode.com/svn&cs_f=trunk/DllInjection/Method1/dllinject.dpr" target="_blank">El método 1</a> no necesita que sea cargada ninguna DLL (aunque por otras razones sí emplea DLLs en el ejemplo que expone).<br>
<br>
<b>4.</b> Sí es posible inyectar una rutina de nuestro programa en el espacio de memoria de otro proceso.  Como puede apreciarse en el ejemplo del método 1, el truco es, también, utilizar las funciones <b>VirtualAllocEx</b> y <b>WriteProcessMemory</b> para copiar el código máquina de nuestra rutina en la memoria del proceso remoto, y luego usar CreateRemoteThread para crear un hilo dentro de tal proceso, empezando su ejecución en la dirección base del bloque de memoria donde fue copiado el código.<br>
<br>
<b>5.</b> En ambos casos, Rezmond ejecuta inicialmente otra función de su autoría, llamada <a href="http://www.google.com/codesearch?hl=es&q=GetDebugPrivs+show:VwxzLA4tpLk:am-CRq_7dyA:VwxzLA4tpLk&sa=N&cd=1&ct=rc&cs_p=http://asmprofiler.googlecode.com/svn&cs_f=trunk/DllVersion/_uToolHelpWrappperFunction.pas" target="_blank">GetDebugPrivs</a>, la cual llama a otro par de funciones de la API de Windows para darle al programa algo así como <i><u>permisos de depuración</u></i>.  Desconozco en qué punto de sus ejemplos son necesarios tales permisos, pero parece ser algo importante para que aquellos funcionen.<br>
<br>
Ahora sólo me quedaría la pregunta, <b>¿cómo saber cuántos bytes ocupa el código máquina de una función?</b>  En uno de los ejemplos vemos que se utilizó un valor de 1000 bytes (cómo diciendo <i>más vale que sobre a que falte</i>), pero ¿podría, por ejemplo, servirnos la ventana <i>CPU</i> del depurador (Ctrl+Alt+C) para calcular el tamaño de una rutina?<br>
<br>
Espero con esto haber contribuido en algo para que <b>Rolando</b> encuentre solución al problema que plantea.  No quiere decir que me despido del tema, solo que esperaré sus comentarios para ver por dónde podemos seguir ayudando.<br>
<br>
Saludos.<br>
<br>
Al González. <img src="./Inyección directa de código IV_files/smile.gif" border="0" alt="" title="Smilie" class="inlineimg"><br>
<br>
P.D.  Ahora veo que <b>Escafandra</b> hizo un adelanto sobre esto que comenté.  Interesante el uso de esas funciones. <img src="./Inyección directa de código IV_files/smile.gif" border="0" alt="" title="Smilie" class="inlineimg"></div>
		<!-- / message -->
	
		
		
		
		
		
		<!-- sig -->
			<div>
				__________________<br>
				&#9632; Conoce <a href="http://rescatandoadelphi.blogspot.com/" target="_blank">mi bitácora</a>. &#9632; Escucho propuestas para trabajar fuera de México.
			</div>
		<!-- / sig -->
		
		
		
		
		
		<!-- edit note -->
			<div class="smallfont">			<hr size="1" style="color:#D1D1E1">
				<em>
				Última edición por Al González fecha: 01-12-2008 a las <span class="time">10:18:28</span>.
				
				</em>
			</div>
		<!-- / edit note -->
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=328883" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 328883 popup menu -->
<div class="vbmenu_popup" id="postmenu_328883_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">Al González</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=371">Ver Perfil</a></td></tr>
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://rescatandoadelphi.blogspot.com/">¡Visita mi Sitio!</a></td></tr>
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=371" rel="nofollow">Encontrar Todos los Mensajes de Al González</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 328883 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #328883 --><!-- post #328893 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit328893" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post328893" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=328893&postcount=11" target="new" rel="nofollow" id="postcount328893" name="11"><strong>11</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post328893"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				01-12-2008
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_328893">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=24088">escafandra</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="escafandra is offline" border="0" title="escafandra is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_328893", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: nov  2007</div>
					
					
					<div>
						<b>Posts</b>: 817
					</div>
					
					
					<div><span id="repdisplay_328893_24088"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="escafandra is on a distinguished road" border="0" title="escafandra is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_328893">
	<!-- message, attachments, sig -->
	
		
		
		
		
		<!-- message -->
		<div id="post_message_328893"><div style="margin:20px; margin-top:5px; ">
	<div class="smallfont" style="margin-bottom:2px">Cita:</div>
	<table cellpadding="6" cellspacing="0" border="0" width="100%">
	<tbody><tr>
		<td class="alt2" style="border:1px inset">
			
				<div>
					Empezado por <strong>Al González</strong>
					<a href="http://www.clubdelphi.com/foros/showthread.php?p=328883#post328883" rel="nofollow"><img class="inlineimg" src="./Inyección directa de código IV_files/viewpost.gif" border="0" alt="Ver Mensaje" title="Ver Mensaje"></a>
				</div>
				<div style="font-style:italic">Ahora sólo me quedaría la pregunta, <b>¿cómo saber cuántos bytes ocupa el código máquina de una función?</b></div>
			
		</td>
	</tr>
	</tbody></table>
</div>Pues en C++ es fácil,  Si Func1 es la función cuyo tamaño queremos calcular y Func2 es la siguiente en el orden del IDE,  sólo tenemos que restar (BYTE*)Func2-(BYTE*) Func1 y el resultado es el tamaño de Func 1 en nº de Bytes una vez compilada.<br>
<br>
El problema aparece cuando Func1 llama a su vez a otras funciones que no sean APIs, pues ese tamaño habrá que calcularlo para reservar memoria y "subirlas" a su vez, con lo que en realidad lo que interesa es "subir" no una función sino todo el código que se valla a ejecutar en el nuevo espacio de direcciones. En el caso de hacerlo con dll es el S.O. el que se encarga de todo, pero en nuestro caso debe hacerse manualmente.<br>
<br>
Saludos.</div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=328893" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 328893 popup menu -->
<div class="vbmenu_popup" id="postmenu_328893_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">escafandra</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=24088">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=24088" rel="nofollow">Encontrar Todos los Mensajes de escafandra</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 328893 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #328893 --><!-- post #328896 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit328896" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post328896" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=328896&postcount=12" target="new" rel="nofollow" id="postcount328896" name="12"><strong>12</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post328896"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				01-12-2008
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_328896">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=17906">rolandoj</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="rolandoj is offline" border="0" title="rolandoj is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_328896", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: abr  2007</div>
					
					
					<div>
						<b>Posts</b>: 245
					</div>
					
					
					<div><span id="repdisplay_328896_17906"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="rolandoj is on a distinguished road" border="0" title="rolandoj is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_328896">
	<!-- message, attachments, sig -->
	
		
		
		
			<!-- icon and title -->
			<div class="smallfont">
				<img class="inlineimg" src="./Inyección directa de código IV_files/icon7.gif" alt="Smile" border="0" title="Smile">
				<strong>Gracias por el interés</strong>
			</div>
			<hr size="1" style="color:#D1D1E1">
			<!-- / icon and title -->
		
		
		<!-- message -->
		<div id="post_message_328896">Hola a todos,<br>
 <br>
Gracias por el interés. Veo que ahora si se está moviendo el hilo. Dos comentarios rápidos:<br>
 <br>
1. Una gran disculpa. Como dije antes, infortunadamente, debido a exceso de trabajo, no puedo dedicarme ahora a completar el proceso. Solo a mediados de semana, tendré tiempo libre.<br>
 <br>
2. Mi problema original si lo resolví. El código que estoy explicando es el que usé y funciona. Las razones para publicarlo son dos: Lo pobre de la documentación disponible, y el hecho de existir un problema en la limpieza final del mismo, el cual, aunque para mi caso no me afecta, si me intriga</div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=328896" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 328896 popup menu -->
<div class="vbmenu_popup" id="postmenu_328896_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">rolandoj</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=17906">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=17906" rel="nofollow">Encontrar Todos los Mensajes de rolandoj</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 328896 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #328896 --><!-- post #329997 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit329997" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post329997" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=329997&postcount=13" target="new" rel="nofollow" id="postcount329997" name="13"><strong>13</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post329997"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				06-12-2008
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_329997">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=17906">rolandoj</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="rolandoj is offline" border="0" title="rolandoj is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_329997", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: abr  2007</div>
					
					
					<div>
						<b>Posts</b>: 245
					</div>
					
					
					<div><span id="repdisplay_329997_17906"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="rolandoj is on a distinguished road" border="0" title="rolandoj is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_329997">
	<!-- message, attachments, sig -->
	
		
		
		
			<!-- icon and title -->
			<div class="smallfont">
				<img class="inlineimg" src="./Inyección directa de código IV_files/icon7.gif" alt="Smile" border="0" title="Smile">
				<strong>Preparando los datos a enviar</strong>
			</div>
			<hr size="1" style="color:#D1D1E1">
			<!-- / icon and title -->
		
		
		<!-- message -->
		<div id="post_message_329997">Hola,<br>
 <br>
Bueno, al fin tengo algo de tiempo para proseguir con este tema.<br>
 <br>
Empiezo contestando la pregunta de escafandra:<br>
 <br>
Si, he usado la técnica de Hook; aunque ya hace bastante tiempo. Lo que ocurre es que cada técnica tiene su ámbito de aplicación. En el caso de los Hook, ellos sirven para monitorear los mensajes de Windows; por ello, pueden enlentecer el sistema, lo que hace que solo se recomiende instalarlos cuando sea necesario. Lo importante es que dependen de que se ejecute el mensaje que se esté monitoreando.<br>
 <br>
En mi caso, la necesidad era totalmente diferente. Se trataba de que una aplicación debía solicitar a otras determinada información; es decir era un servicio bajo pedido. La lógica seguida era por tanto más adecuada a la inyección de código, donde se llama a la rutina en la aplicación remota obteniendo enseguida la respuesta.<br>
 <br>
Pasando al tema en si, Veo que ya se ha agregado parte de la información que les traigo; pero creo que de todas maneras les será util.<br>
 <br>
Habíamos quedado en como obtener las direcciones de las funciones Windows que necesitamos pasar dentro de nuestra estructura TRemoteStruct. Para hacerlo, se procede así:<br>
 <br>
Definamos una variable global que sea nuestra estructura. Por ejemplo:<br>
 <br>
<pre class="delphi"><div class="frame_codigo_delphi">Código Delphi <a id="delphi_ancla_4d750dc427ae3" href="http://www.clubdelphi.com/foros/showthread.php?t=55924#" onclick="etiqueta_delphi(&#39;delphi_div_4d750dc427aa9&#39;,&#39;delphi_ancla_4d750dc427ae3&#39;); return false;" title="Contraer cuadro de código" style="text-decoration: none" hidefocus="true">[-]</a><div id="delphi_div_4d750dc427aa9" class="texto_codigo_delphi"><pre><span class="keyword">Var</span>
   DataInterProc:       TRemoteStruct;</pre></div></div></pre> <br>
Esa variable la inicializamos (típicamente en el OnCreate de un formulario), con un código similar a:<br>
 <br>
<pre class="delphi"><div class="frame_codigo_delphi">Código Delphi <a id="delphi_ancla_4d750dc428339" href="http://www.clubdelphi.com/foros/showthread.php?t=55924#" onclick="etiqueta_delphi(&#39;delphi_div_4d750dc4282ff&#39;,&#39;delphi_ancla_4d750dc428339&#39;); return false;" title="Contraer cuadro de código" style="text-decoration: none" hidefocus="true">[-]</a><div id="delphi_div_4d750dc4282ff" class="texto_codigo_delphi"><pre><span class="keyword">procedure</span> TfrmWPPrincipal.FormCreate(Sender: TObject);
<span class="keyword">Var</span>
   MUser:               HMODULE;
   MKernel:             HMODULE;
   ::::
   :::
   :: 
<span class="keyword">begin</span>
     ::::
     :::
     THE_REMOTE_MSG := RegisterWindowMessage(MY_REMOTE_MSG);
     MUser          := GetModuleHandle(<span class="quote">'user32'</span>);
     MKernel        := GetModuleHandle(<span class="quote">'kernel32'</span>);
     DataInterProc.DRegisterWindowMessage := GetProcAddress(MUser,<span class="quote">'RegisterWindowMessageA'</span>);
     DataInterProc.DGlobalAddAtom         := GetProcAddress(MKernel,<span class="quote">'GlobalAddAtomA'</span>);
     DataInterProc.DSendMessage           := GetProcAddress(MUser,<span class="quote">'SendMessageA'</span>);
     DataInterProc.DGetCommandLine        := GetProcAddress(MKernel,<span class="quote">'GetCommandLineA'</span>);
     StrCopy(DataInterProc.IdRemoteMsg,MY_REMOTE_MSG);
     :::
     ::
<span class="keyword">end</span>;</pre></div></div></pre> <br>
Analicemos lo correspondiente a GetModuleHandle y GetProcAddress. La parte clave del asunto es la ya comentada por Al, de su busqueda en Google, que él coloca en negritas. <br>
 <br>
Debido a que las librerías user32 y kernel32 se cargan en la mismo lugar del espacio de direcciones de cualquier proceso que se ejecute, las direcciones relativas de sus rutinas son las mismas en cualquier proceso. Por lo anterior, es posible obtenerlas en nuestro proceso, para luego pasarlas e invocarlas desde el otro proceso, tal y como se ha explicado en la segunda nota que hice de este tema. <br>
 <br>
GetModuleHandle, como su nombre lo indica, devuelve el manejador del módulo que le pasamos como parámetro; así pués, lo primero que hacemos es obtener los manejadores de User32 y Kernel32. Luego es solo cuestión de obtener la dirección de cada rutina que nos interese; para lo cual empleamos GetProcAddress. El primer parámetro es obviamente el manejador del módulo; pero el segundo requiere aclaración. <br>
 <br>
Observarán, por ejemplo, que aparece SendMessageA y no SendMessage. Por qué la A al final ?. Sin detallar mayormente el tema, lo que ocurre es las librerías de Windows a menudo tienen más de una implementación para una función. El nombre que debemos usar es el de la versión adecuada a nosotros. Donde hallamos esa información ?. En nuestro clásico archivo Windows.Pas. Para el caso de la función SendMessage, la línea que aparece es:<br>
 <br>
<pre class="delphi"><div class="frame_codigo_delphi">Código Delphi <a id="delphi_ancla_4d750dc4289b3" href="http://www.clubdelphi.com/foros/showthread.php?t=55924#" onclick="etiqueta_delphi(&#39;delphi_div_4d750dc428979&#39;,&#39;delphi_ancla_4d750dc4289b3&#39;); return false;" title="Contraer cuadro de código" style="text-decoration: none" hidefocus="true">[-]</a><div id="delphi_div_4d750dc428979" class="texto_codigo_delphi"><pre><span class="keyword">function</span> SendMessage; external user32 name <span class="quote">'SendMessageA'</span>;</pre></div></div></pre> <br>
Lo que nos indica que el nombre requerido para SendMessage es <b>SendMessageA</b>.<br>
 <br>
Para finalizar esta parte, solo queda mencionar a RegisterWindowMessage. <br>
 <br>
Esta parte es un mecanismo interesante para que nuestro código inyectado nos devuelva valores, con un mecanismo diferente al de la estructura TRemoteStruct. <br>
 <br>
La idea es que la información nos sea devuelta por medio de un mensaje de Windows definido por nosotros mismos. Este mecanismo es una alternativa más comoda de manejar cuando hay que devolver varios string de longitud variable e impronosticable, ya que en nuestro esquema, hacer eso por medio del parámetro que pasamos sería complicado.<br>
 <br>
RegisterWindowMessage devuelve un identificador único a todo Windows para un string que represente un mensaje. La lógica seguída es que si el string que se registra ya existe en Windows, la función devuelve el identificador existente para el mismo. Así pués, lo que hacemos es obtener el identificador en nuestro programa y luego, en la rutina a inyectar, se vuelve a llamar RegisterWindowMessage para obtenerlo de nuevo; pero guardandolo dentro de una variable válida en ese proceso remoto (típicamente, local a nuestra rutina "ProcesoExterno"). Una vez hecho eso ya podemos comunicar ambas aplicaciones vía mensajes propios.<br>
 <br>
Por lo anterior, si requerimos esa técnica, debemos incluir RegisterWindowMessage  dentro de las funciones que deben hacerse disponibles a nuestro "ProcesoExterno".<br>
 <br>
Quedarían dos puntos por anotar en esta parte. Uno es la definición de MY_REMOTE_MSG y THE_REMOTE_MSG. <br>
 <br>
El primero es una constante string que debemos asegurar que sea única. Se definiría más o menos así :<br>
 <br>
<pre class="delphi"><div class="frame_codigo_delphi">Código Delphi <a id="delphi_ancla_4d750dc429175" href="http://www.clubdelphi.com/foros/showthread.php?t=55924#" onclick="etiqueta_delphi(&#39;delphi_div_4d750dc42913b&#39;,&#39;delphi_ancla_4d750dc429175&#39;); return false;" title="Contraer cuadro de código" style="text-decoration: none" hidefocus="true">[-]</a><div id="delphi_div_4d750dc42913b" class="texto_codigo_delphi"><pre><span class="keyword">Const</span>
     MY_REMOTE_MSG = <span class="quote">'Mi servicio es AB12456V'</span>;</pre></div></div></pre> <br>
Es decir, un texto que nos indique lo que hace y algunos números y letras que garanticen su unicidad.<br>
 <br>
El segundo es simplemente una variable del tipo UINT. <br>
 <br>
El último punto es la llamada :<br>
 <br>
<pre class="delphi"><div class="frame_codigo_delphi">Código Delphi <a id="delphi_ancla_4d750dc4293fc" href="http://www.clubdelphi.com/foros/showthread.php?t=55924#" onclick="etiqueta_delphi(&#39;delphi_div_4d750dc4293c3&#39;,&#39;delphi_ancla_4d750dc4293fc&#39;); return false;" title="Contraer cuadro de código" style="text-decoration: none" hidefocus="true">[-]</a><div id="delphi_div_4d750dc4293c3" class="texto_codigo_delphi"><pre>StrCopy(DataInterProc.IdRemoteMsg,MY_REMOTE_MSG);</pre></div></div></pre> <br>
Aquí es la misma lógica ya explicada. MY_REMOTE_MSG está en nuestro espacio de direcciones; como necesitamos usarlo en nuestar rutina remota, debemos incluirlo dentro de los datos a enviarle a ella; por eso, se usa una variable, del tipo arreglo de caracteres, incluida dentro de nuestro registro TRemoteStruct; lógicamente con suficiente espacio para contener a MY_REMOTE_MSG. El Strcopy simplemente se encarga de poner a MY_REMOTE_MSG dentro de nuestro registro.<br>
 <br>
Bueno, esto ya resultó muy largo; pero espero que les sea util.<br>
 <br>
En la próxima entrega veremos el proceso de copiado de nuestra rutina.</div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=329997" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 329997 popup menu -->
<div class="vbmenu_popup" id="postmenu_329997_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">rolandoj</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=17906">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=17906" rel="nofollow">Encontrar Todos los Mensajes de rolandoj</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 329997 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #329997 --><!-- post #330050 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit330050" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post330050" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=330050&postcount=14" target="new" rel="nofollow" id="postcount330050" name="14"><strong>14</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post330050"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				07-12-2008
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_330050">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=24088">escafandra</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="escafandra is offline" border="0" title="escafandra is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_330050", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: nov  2007</div>
					
					
					<div>
						<b>Posts</b>: 817
					</div>
					
					
					<div><span id="repdisplay_330050_24088"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="escafandra is on a distinguished road" border="0" title="escafandra is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_330050">
	<!-- message, attachments, sig -->
	
		
		
		
		
		<!-- message -->
		<div id="post_message_330050">Sigue interesante tu exposición. <br>
<br>
<b>rolandoj</b> al leer la respuesta que me diste acerca de los Hooks creo que no me entendiste o que no me expliqué bien. Te comente que algunos antivirus y cortafuegos hacen un Hook a la API CreateRemoteThread, es decir no los Hooks que pone Windows a nuestra disposición para interceptar mensajes o el teclado, sino interceptar la misma API modificando su propio código (mediante inyección)... De esta forma esos programas detectan llamadas a CreateRemoteThread y bloquean las llamadas que consideren ilícitas haciendo inútil la inyección de código por esta vía, la elegida para tu exposición. Existen otras maneras de inyectar código sin usar la API CreateRemoteThread, menos populares y no detectables por los antivirus y cortafuegos y por tanto más universales. Es por este motivo, por lo que te comentaba si no las habías considerado.<br>
<br>
Por otra parte, es interesante tu exposición sobre el uso de RegisterWindowMessage. En ocasiones he usado Memoria compartida mediante Mapeos de ficheros en memoria (CreateFileMapping, OpenFileMapping, MapViewOfFile) para compartir bloques de memoria entre diferentes procesos. Con la inyección con dll puedes diseñar funciones en esa dll que pueden ser llamadas desde otro proceso mediante una "microinyección", con lo que te permite comunicar aplicaciones e incluso "bajar" bloques de memoria de otro proceso, una especie de "inyección in¡versa" con lo que la comunicación es bidireccional.<br>
<br>
Bueno, no me extiendo mas y espero tu próxima entrega.<img src="./Inyección directa de código IV_files/wink.gif" border="0" alt="" title="Wink" class="inlineimg"><br>
<br>
Saludos.</div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
		<!-- edit note -->
			<div class="smallfont">			<hr size="1" style="color:#D1D1E1">
				<em>
				Última edición por escafandra fecha: 08-12-2008 a las <span class="time">22:27:17</span>.
				
				</em>
			</div>
		<!-- / edit note -->
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=330050" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 330050 popup menu -->
<div class="vbmenu_popup" id="postmenu_330050_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">escafandra</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=24088">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=24088" rel="nofollow">Encontrar Todos los Mensajes de escafandra</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 330050 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #330050 --><!-- post #335442 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit335442" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post335442" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=335442&postcount=15" target="new" rel="nofollow" id="postcount335442" name="15"><strong>15</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post335442"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				22-01-2009
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_335442">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=25490">alquimista</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="alquimista is offline" border="0" title="alquimista is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_335442", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: ene  2008</div>
					
					
					<div>
						<b>Posts</b>: 123
					</div>
					
					
					<div><span id="repdisplay_335442_25490"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="alquimista is on a distinguished road" border="0" title="alquimista is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_335442">
	<!-- message, attachments, sig -->
	
		
		
		
			<!-- icon and title -->
			<div class="smallfont">
				<img class="inlineimg" src="./Inyección directa de código IV_files/icon14.gif" alt="Thumbs up" border="0" title="Thumbs up">
				<strong>Hasta el infinito y mas alla...</strong>
			</div>
			<hr size="1" style="color:#D1D1E1">
			<!-- / icon and title -->
		
		
		<!-- message -->
		<div id="post_message_335442">Comentar que esto se estaba poniendo interesante.... y se ha parado...<br>
<br>
Vulevo a animar a continuar con este hilo...<img src="./Inyección directa de código IV_files/smile.gif" border="0" alt="" title="Smilie" class="inlineimg"><img src="./Inyección directa de código IV_files/smile.gif" border="0" alt="" title="Smilie" class="inlineimg"><img src="./Inyección directa de código IV_files/smile.gif" border="0" alt="" title="Smilie" class="inlineimg">. Todavia me cuesta seguir las explicaciones, pero me he apuntado a esto de la inyeccion y me parece interesantisimo. <br>
<br>
Una pregunta esta técnica ¿activa la prevención de ejecución de datos (DEP) de Windows? Probe un ejemplo inyectando en el explorer.exe y se activo.<br>
<br>
<br>
Un saludo y a ver si poco a poco me entero de algo mas..</div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=335442" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 335442 popup menu -->
<div class="vbmenu_popup" id="postmenu_335442_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">alquimista</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=25490">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=25490" rel="nofollow">Encontrar Todos los Mensajes de alquimista</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 335442 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #335442 --><!-- post #335501 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit335501" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post335501" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=335501&postcount=16" target="new" rel="nofollow" id="postcount335501" name="16"><strong>16</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post335501"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				22-01-2009
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_335501">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=24088">escafandra</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="escafandra is offline" border="0" title="escafandra is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_335501", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: nov  2007</div>
					
					
					<div>
						<b>Posts</b>: 817
					</div>
					
					
					<div><span id="repdisplay_335501_24088"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="escafandra is on a distinguished road" border="0" title="escafandra is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_335501">
	<!-- message, attachments, sig -->
	
		
		
		
		
		<!-- message -->
		<div id="post_message_335501"><div style="margin:20px; margin-top:5px; ">
	<div class="smallfont" style="margin-bottom:2px">Cita:</div>
	<table cellpadding="6" cellspacing="0" border="0" width="100%">
	<tbody><tr>
		<td class="alt2" style="border:1px inset">
			
				<div>
					Empezado por <strong>alquimista</strong>
					<a href="http://www.clubdelphi.com/foros/showthread.php?p=335442#post335442" rel="nofollow"><img class="inlineimg" src="./Inyección directa de código IV_files/viewpost.gif" border="0" alt="Ver Mensaje" title="Ver Mensaje"></a>
				</div>
				<div style="font-style:italic">Una pregunta esta técnica ¿activa la prevención de ejecución de datos (DEP) de Windows? Probe un ejemplo inyectando en el explorer.exe y se activo.</div>
			
		</td>
	</tr>
	</tbody></table>
</div>Teóricamente Microsoft diseñó el <a href="http://windowshelp.microsoft.com/Windows/es-XL/Help/186de3d0-01af-4d4c-981d-674637d2f4bf3082.mspx" target="_blank">DEP</a> para evitar la ejecución de código desde zonas de memoria no asignadas para ello en las aplicaciones. Los intentos de inyección de código, pueden disparar el DEP.<br>
<br>
He realizado pruebas de inyección en el explorer.exe y en en el TaskManager, mediante varias técnicas. Todas las inyecciones las he realizado inyectando dll y con el DEP activado para todas las aplicaciones. En ninguna prueba me ha saltado el DEP. Esto puede ser explicado porque las dll en principio son código, o al menos pueden contenerlo. Posiblemente Microsoft no quiere interferir con ellas porque crearía muchos problemas con aplicaciones lícitas y con su propio sistema de Hooks.<br>
<br>
Todas las técnicas de inyección de dll, (salvo las que se aprovechan de la API  SetWindowHook para cargar una dll) requieren una pequeña inyección directa de código que es el que se encarga de cargar dicha dll. Ese código se coloca en la memoria del proceso (WriteProcessMemory) como se comenta en este hilo, aunque sólo contenga la API LoadLibraryA. Bien es verdad que es difícil escribir una aplicación que maneje, con la precisión suficiente, la paginación de memoria con permisos de ejecución de código, como para no dejar espacio para esa necesaria microinyección de esa API LoadLibraryA o unas cuantas intrucciones asm puro. Diferente sería el caso de la inyección directa de cantidades mayores de código, que pueden hacer saltar el DEP.<br>
<br>
En cualquier caso, tener activo el DEP crea muchas falsas alarmas y molestias al usuario, y suele estar desactivado.<br>
<br>
Saludos.</div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
		<!-- edit note -->
			<div class="smallfont">			<hr size="1" style="color:#D1D1E1">
				<em>
				Última edición por escafandra fecha: 22-01-2009 a las <span class="time">17:30:07</span>.
				
				</em>
			</div>
		<!-- / edit note -->
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=335501" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 335501 popup menu -->
<div class="vbmenu_popup" id="postmenu_335501_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">escafandra</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=24088">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=24088" rel="nofollow">Encontrar Todos los Mensajes de escafandra</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 335501 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #335501 --><!-- post #336025 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit336025" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post336025" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=336025&postcount=17" target="new" rel="nofollow" id="postcount336025" name="17"><strong>17</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post336025"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				27-01-2009
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_336025">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=33880">callbacking</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="callbacking is offline" border="0" title="callbacking is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_336025", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: jul  2008</div>
					
					
					<div>
						<b>Posts</b>: 9
					</div>
					
					
					<div><span id="repdisplay_336025_33880"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="callbacking is on a distinguished road" border="0" title="callbacking is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_336025">
	<!-- message, attachments, sig -->
	
		
		
		
			<!-- icon and title -->
			<div class="smallfont">
				<img class="inlineimg" src="./Inyección directa de código IV_files/icon14.gif" alt="Thumbs up" border="0" title="Thumbs up">
				<strong>Enormemente interesado, sigue con ello.</strong>
			</div>
			<hr size="1" style="color:#D1D1E1">
			<!-- / icon and title -->
		
		
		<!-- message -->
		<div id="post_message_336025">De hecho ya habia perdido el interés por no haber conseguido casi nada de lo que quería con la inyección de código, incluso me molesté en aprender a usar Fasm y hacerlo en assembler con ayuda también de Ollydbg, hace casi un año escribí un post intentando conseguir ayuda y he acudido también a otros foros, he abandonado en Septiembre pasado, pero quizá saque ganas de nuevo. Nunca hubo oscuro propósito, intenté obtener los textos de drawtext y textout antes que windows los volcara en pantalla, conseguí hubicar mi función y las direcciones correctas de los saltos, pero no fui capaz de recuperar y modificar los datos sin que petara el sistema. Al igual que tu, me pareció mas sencillo ubicar la función que inyectar una .dll. No conseguí nada, <br>
<br>
O SEASE, A MI SI ME INTERESA SEGUIR LEYENDO, EL ALGUNA PARTE ESTA LO QUE NECESITO PARA QUE MI RUTINA FUNCIONE, ES BUENA IDEA ESTE HILO.<img src="./Inyección directa de código IV_files/smile.gif" border="0" alt="" title="Smilie" class="inlineimg"><br>
CREIA QUE NADIE TENIA INTERÉS POR ALGO TAN INTERESANTE COMO ESTO.<img src="./Inyección directa de código IV_files/biggrin.gif" border="0" alt="" title="Big Grin" class="inlineimg"></div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=336025" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 336025 popup menu -->
<div class="vbmenu_popup" id="postmenu_336025_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">callbacking</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=33880">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=33880" rel="nofollow">Encontrar Todos los Mensajes de callbacking</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 336025 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #336025 --><!-- post #336030 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit336030" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post336030" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=336030&postcount=18" target="new" rel="nofollow" id="postcount336030" name="18"><strong>18</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post336030"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				27-01-2009
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_336030">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=33880">callbacking</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="callbacking is offline" border="0" title="callbacking is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_336030", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: jul  2008</div>
					
					
					<div>
						<b>Posts</b>: 9
					</div>
					
					
					<div><span id="repdisplay_336030_33880"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="callbacking is on a distinguished road" border="0" title="callbacking is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_336030">
	<!-- message, attachments, sig -->
	
		
		
		
			<!-- icon and title -->
			<div class="smallfont">
				
				<strong>Como prueba de mi interés...</strong>
			</div>
			<hr size="1" style="color:#D1D1E1">
			<!-- / icon and title -->
		
		
		<!-- message -->
		<div id="post_message_336030">Me gustaría disponer de ese código delphi al completo, como prueba no mostraré mis desastres en delphi, mostraré un medio éxito en fasm(si se me permite) que es a propósito del tema en cuestión, debido a las múltiples pruebas que realicé puede contener comentarios de lineas de código ya extintas, asi como variables que no se usan, creo que este era el código que era capaz de inyectar una función en la api drawtextw(tengo varias pruebas), aunque no parece cambiar los textos antes de ser escritos, ... para muestra un botón...<br>
Api Hooking por inyección de código, aproximación en fasm.<br>
<br>
<div style="margin:20px; margin-top:5px">
	<div class="smallfont" style="margin-bottom:2px">Código:</div>
	<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px inset;
		width: 640px;
		height: 498px;
		text-align: left;
		overflow: auto">include 'd:\fasm\include\win32ax.inc'




.data
        HookApi      db 'DrawTextW' , 0  ; Nombre del api a hookear
        HookDll      db 'user32.dll'  , 0  ; Nombre de la dll que contiene el api a hookear
        dirapi       dd ?                    ; Dirección del api a hookear
        texto        db 'hello'
 
        process       dd ?                   ; El handle del proceso donde inyectaremos
        pid           dd 1240               ; El pid    del proceso donde inyectaremos--estesalio del taskmanager y fue notepad
     ;PONER PID ADECUADO Y COMPILAR DE NUEVO
        x             dd 5
        ; --------------------api DrawTextW
        ;
        ;-------------------------------------- total 5 bytes si esta es la teoría lo dijo ollydbg y punto.


        ; El número de bytes que tiene al principio el api a hookear (suelen ser 5 ó 7)
 
        buffercall    dd ?                   ; Puntero al buffer para llamar al api (en nuestro propio proceso)
        inibuffer  dd ?                   ; siempre guardada la direccion original del inicio del buffer
        inidirapi dd ?                      ; siempre guardado el inicio del api
        inifun dd ?                         ; siempre guardado el inicio de mi funcion

 
        tamfun        dd ?                   ; Tamaño de la función que suplantará al api


        ;----------------------------------------------------------------------------------------------
        dircode     dd ?                    ; La dirección donde esta escribe la estructura una vez INYECTADA
 
        Prote         dd ?                    ; Necesario para VirtualProtect

        saltoapi     dd ?          ; la direccion calculada a la api+5
        buffsaltoami      dd ?
        tamtotal          dd ?          ;1+tamfun+1+5+5
 
.code
start:
        ; Obtenemos el handle del proceso donde inyectaremos
        mov eax, PROCESS_VM_OPERATION
        or  eax, PROCESS_VM_WRITE
     ;   mov eax,PROCESS_ALL_ACCESS
        invoke OpenProcess, eax, FALSE, [pid]
        mov [process], eax   ;

         ; Obtenemos la dirección del api a Hookear
        invoke GetModuleHandle, HookDll
        invoke GetProcAddress, eax, HookApi
        mov [dirapi], eax       ; vale la dir de la api
        mov [inidirapi],eax     ; siempre guardado sin alterar el inicio

;Vamos a ver , reservamos espacio para pushad+(tamaño de mi funcion)+popad+(5 bytes de la api)+jmp dirapi+5 =
; 1+tamfun+1+5+5
;ahi es na
;a ver el tamaño de la función
        ; Calculamos el tamaño de la función a inyectar
        mov eax, FIN_drawtextexw
        sub eax, Mydrawtextexw
        mov [tamfun], eax



          ;pues eso
          ;  1+tamfun+1+5+5
          ;
        mov eax, 1
        add eax, [tamfun]
        add eax,1
        add eax,[x]
        add eax,5
        mov [tamtotal],eax ; tamtotal tiene el tamaño del buffer
        invoke LocalAlloc, LPTR, [tamtotal] ; espacio local reservado para escritura del buffer
        mov [buffercall], eax  ; aqui la direccion inicio del buffer
        mov [inibuffer],eax ;aqui también para no perderla, por variables va a ser

        mov eax,[buffercall]
        mov byte [eax],0x90 ; 60 pushad     90 es nop
        inc eax
        mov [buffercall],eax ;puesto el opcode  e incrementado el buffer


;ahora a copiar aqui la funcion
        mov ebx,CAMBIO ;direccion de la funcion
        mov [inifun],ebx  ;aqui tambien, no perderla
        invoke RtlMoveMemory, [buffercall],ebx,[tamfun]; la función al buffer
        mov eax,[buffercall]
        add eax,[tamfun]  ; incrementamos el buffer hasta el fin de la funcion
        mov [buffercall],eax
        ; copia la funcion y ademas incrementa buffercall
        ;ahora el opcode de popad 61   90 es nop
        mov eax,[buffercall]
        mov byte [eax],0x90 ;despues de la funcion pues popad o noP
        inc eax
        mov [buffercall],eax ;uno mas para empezar con la api
        ;ahora vienen los 5 bytes de la api

        ;los bytes del api al final del buffer, pero le resto 4, si no no rula
        mov eax, [buffercall]
        sub eax,4
        mov [buffercall],eax
        ; visto con ollydbg


        invoke WaitForInputIdle,[process],1000 ; si señor, esto ya es otra cosa, si no peta.
        ; desde dirapi 5 bytes al buffer
        invoke RtlMoveMemory, [buffercall], [dirapi], [x] ; Copiamos los x primeros bytes del api
        mov eax, [buffercall]
        add eax, [x] ;entonces incrementamos el buffer en x bytes
        mov [buffercall],eax
        ; se supone que ahora lo que falta es el salto a la api+5 (o +4?)
        ;para esto necesito la direccion donde voy a inyectar el codigo

        mov eax, MEM_RESERVE
        or  eax, MEM_COMMIT
        invoke VirtualAllocEx, [process], NULL, [tamtotal], eax, PAGE_EXECUTE_READWRITE
        mov [dircode],eax ;direccion para inyectar el codigo en proceso remoto
        ;dirapi debe estar mas arriba
        mov eax,[dirapi];no ha cambiado, la seguimos usando entonces
        add eax,5 ; ya cambio, dirapi es ahora dirapi+5
        mov ebx,[dircode]
        add ebx,[tamtotal] ; ja! el salto es desde el final del jmp o justo desde antes?
        ; que problema no saberlo, intentemos asi y si no decremento 4 o 5, 4 despues del jmp
        ; antes de los 4 bytes del salto, 5, antes del jmp y los 4 bytes del salto.


        sub eax,ebx
        ; a ver si...    (dirapi+5)-(dircode+tamaño total buffer)=direccion del salto a api+5
        mov [saltoapi],eax
        mov eax,[buffercall]
        mov byte [eax],0xE9
        inc eax
        mov [buffercall],eax  ;insertado opcode jmp  e incrementado buffer
        mov ebx,[saltoapi]
        ; coño, el salto se queda  4 bytes corto!!!!!!!
        ;
        add ebx,4 ;asi supongo que salte donde debe
        mov dword [eax],ebx; con esto se suponen 4 bytes del dword del salto
        ;ahora podemos escribir el buffer en el espacio de la aplicacion
        ;que previamente reservamos
        ;debemos indicar el tamaño total claro
        ;el buffer se supone escrito, ahora lo volcamos en el proceso remoto

        ;invoke VirtualProtect, [dircode-5],[tamtotal+5],PAGE_EXECUTE_READWRITE,NULL


        invoke WriteProcessMemory, [process],[dircode],[inibuffer],[tamtotal],NULL
        ; y ahora claro esta tendremos que insertar el salto en la api
        ; a nuestro codigo
        ; si dirapi esta por encima como coño hago un salto negativo?
        ; y además permisos a los 5 bytes de la api claro esta


        invoke LocalAlloc, LPTR, 5
        mov [buffsaltoami],eax

        mov eax,[dircode]
        mov ebx,[dirapi]
        sub eax,ebx
        sub eax,5; por algun motivo que no se, salta a la dirección
        ;no entiendo yo este problema con los...  si lo pongo salta desde api a pushad
;sino lo pongo salta  bytes mas allá. Asi que ...
        mov [saltoapi],eax  ;mmmmmmm dir del salto


        mov eax,[buffsaltoami]
        mov byte [eax],0xE9
        inc eax
       ; mov [buffsaltoami],eax
        mov ebx,[saltoapi]
        mov dword [eax],ebx



        mov eax, MEM_RESERVE ; eax = MEM_RESERVE | MEM_COMMIT
        or  eax, MEM_COMMIT
        invoke VirtualAllocEx, [process], [dirapi], 5, eax, PAGE_EXECUTE_READWRITE
        invoke WriteProcessMemory, [process], [dirapi], [buffsaltoami], 5, NULL


; y colorin colorado...

        invoke ExitProcess,0








  CAMBIO:
proc Mydrawtextexw dc, lpstring,ncount,lprect,uformat

            nop



            mov byte [lpstring],0x41
            mov byte [ncount],1



            nop  ;referencias mias en la inyección
endp
FIN_drawtextexw:
.end start</pre>
</div><br>
<br>
- Se supone que la filosofia de esto es:<br>
   -en el inicio de la función api se inserta un salto a una función propia.<br>
   -después de ejecutar la nueva función, se inserta en esta otro salto a la<br>
    api original posterior al salto a nuestra función.</div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=336030" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 336030 popup menu -->
<div class="vbmenu_popup" id="postmenu_336030_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">callbacking</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=33880">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=33880" rel="nofollow">Encontrar Todos los Mensajes de callbacking</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 336030 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #336030 --><!-- post #336031 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit336031" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->	



<table class="tborder" id="post336031" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=336031&postcount=19" target="new" rel="nofollow" id="postcount336031" name="19"><strong>19</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post336031"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				27-01-2009
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_336031">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=33880">callbacking</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="callbacking is offline" border="0" title="callbacking is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_336031", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: jul  2008</div>
					
					
					<div>
						<b>Posts</b>: 9
					</div>
					
					
					<div><span id="repdisplay_336031_33880"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="callbacking is on a distinguished road" border="0" title="callbacking is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_336031">
	<!-- message, attachments, sig -->
	
		
		
		
			<!-- icon and title -->
			<div class="smallfont">
				<img class="inlineimg" src="./Inyección directa de código IV_files/icon10.gif" alt="Talking" border="0" title="Talking">
				<strong>Una preguntita ya que estoy</strong>
			</div>
			<hr size="1" style="color:#D1D1E1">
			<!-- / icon and title -->
		
		
		<!-- message -->
		<div id="post_message_336031">Podrias probar si tu código funciona con drawtextw? Gracias.</div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=336031" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 336031 popup menu -->
<div class="vbmenu_popup" id="postmenu_336031_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">callbacking</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=33880">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=33880" rel="nofollow">Encontrar Todos los Mensajes de callbacking</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 336031 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #336031 --><!-- post #336192 -->

	<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

	<div id="edit336192" style="padding:0px 0px 6px 0px">
		



<table class="tborder" id="post336192" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tbody><tr>
	<td class="thead">
		<div class="normal" style="float:right">
			&nbsp;
			#<a href="http://www.clubdelphi.com/foros/showpost.php?p=336192&postcount=20" target="new" rel="nofollow" id="postcount336192" name="20"><strong>20</strong></a> &nbsp;
			
			
			
			
			
		</div>
		
		<div class="normal">
			<!-- status icon and date -->
			<a name="post336192"><img class="inlineimg" src="./Inyección directa de código IV_files/post_old.gif" alt="Antiguo" border="0" title="Antiguo"></a>
			
				28-01-2009
			
			
			<!-- / status icon and date -->
		</div>
	</td>
</tr>
<tr>
	<td class="alt2" style="padding:0px">
		<!-- user info -->
		<table cellpadding="0" cellspacing="6" border="0" width="100%">
		<tbody><tr>
			
			<td nowrap="nowrap">
			
				<div id="postmenu_336192">
					
					<a class="bigusername" href="http://www.clubdelphi.com/foros/member.php?u=24088">escafandra</a>
					<img class="inlineimg" src="./Inyección directa de código IV_files/user_offline.gif" alt="escafandra is offline" border="0" title="escafandra is offline">


					<script type="text/javascript"> vbmenu_register("postmenu_336192", true); </script>
					
				</div>
				
				<div class="smallfont">Registrado</div>
				
				
				
			</td>
			<td width="100%">&nbsp;</td>
			<td valign="top" nowrap="nowrap">
				
				<div class="smallfont">
					<div><b>Registrado</b>: nov  2007</div>
					
					
					<div>
						<b>Posts</b>: 817
					</div>
					
					
					<div><span id="repdisplay_336192_24088"><img class="inlineimg" src="./Inyección directa de código IV_files/reputation_pos.gif" alt="escafandra is on a distinguished road" border="0" title="escafandra is on a distinguished road"></span></div>
					
					<div>    </div>
				</div>
				
			</td>
		</tr>
		</tbody></table>
		<!-- / user info -->
	</td>
</tr>
<tr>
	<td class="alt1" id="td_post_336192">
	<!-- message, attachments, sig -->
	
		
		
		
		
		<!-- message -->
		<div id="post_message_336192">Hola <b>callbacking</b>. He hecho la prueba que comentabas en tu anterior post, pero inyectando dll. He realizado un Hook a las APIs DrawTextA y DrawTextW. La inyección la he hecho en el notepad, como en tu ejemplo y también en el explorer. No he tenido problemas en capturar el texto o cambiarlo.<br>
<br>
El problema mas común al hacer un Hook a una API suele ser la corrupción de la pila, no cuando un programa llama directamente a esa API, sino cuando la llamada se realiza desde otra API. Es fácil darse cuenta si el Hook lo hacemos en ASM y hacemos un debug. En el último ret nos vamos de bareta pues la pila se corrompió.<br>
<br>
Los experimentos los he realizado en C y básicamente el sistema ha sido asi:<br>
<br>
<div style="margin:20px; margin-top:5px">
	<div class="smallfont" style="margin-bottom:2px">Código:</div>
	<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px inset;
		width: 640px;
		height: 354px;
		text-align: left;
		overflow: auto">// Definición del tipo Puntero a la función API que vamos a Hookear.
typedef INT (__stdcall *PDrawTextW)(HDC hDC, LPCWSTR lpWStr, INT nCount, LPRECT lpRect, UINT uFormat);

// Declaración de un tpunero de ese tipo.
PDrawTextW Ini_DrawTextW = 0;

//............
// Preparación del Hook
// Sustitución de los 5 primeros Bytes de DrawText por JMP HookDrawText
// Ini_DrawText es un puntero a una función con la copia de los Bytes sustituidos de la API original seguido de JMP al 6º Byte de esa API. Para esto se reserva espacio de 10 Bytes mínimo.
//...........

// Función Hookeada:
// Fundamental que sea __stdcall para no corroper la pila....
INT __stdcall HookDrawText(HDC hDC, LPCWSTR lpWStr, INT nCount, LPRECT lpRect, UINT uFormat)
{
   ......
   ......
   // Lamada a la API original. En este punto podemos volver a tomar el control antes de retornar.
   return Ini_DrawTextW(hDC, lpWStr, nCount, lpRect, uFormat); 
}</pre>
</div>Existe otro problema, una misma API puede precisar sobreescribir un número diferente de Bytes para producir el salto, dependiendo de las diferentes versiones del S.O. De forma que puede no funcionar en máquinas diferentes. Esto obliga a un estudio particular de la máquina en cuestión o a un desensamblado por código en una función Hook escrita para tal fin.<br>
<br>
El tema es engorroso <img src="./Inyección directa de código IV_files/rolleyes.gif" border="0" alt="" title="Roll Eyes (Sarcastic)" class="inlineimg"><br>
<br>
Saludos.<img src="./Inyección directa de código IV_files/cool.gif" border="0" alt="" title="Cool" class="inlineimg"></div>
		<!-- / message -->
	
		
		
		
		
		
		
		
		
		
	
		<div style="margin-top: 10px" align="right">
			<!-- controls -->
			
			
			
				<a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&p=336192" rel="nofollow"><img src="./Inyección directa de código IV_files/quote.gif" alt="Responder Con Cita" border="0" title="Responder Con Cita"></a>
			
			
			
			
			
			
				
			
			
			<!-- / controls -->
		</div>
		
	<!-- message, attachments, sig -->
	
	</td>
</tr>
</tbody></table>


<!-- post 336192 popup menu -->
<div class="vbmenu_popup" id="postmenu_336192_menu" style="display:none;">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">escafandra</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/member.php?u=24088">Ver Perfil</a></td></tr>
	
	
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.clubdelphi.com/foros/search.php?do=finduser&u=24088" rel="nofollow">Encontrar Todos los Mensajes de escafandra</a></td></tr>
	
	
	
	</tbody></table>
</div>
<!-- / post 336192 popup menu -->


	</div>
	
		</div>	
	</div>
</div>

<!-- / close content container -->

<!-- / post #336192 --><div id="lastpost"></div></div>

<!-- start content table -->
<!-- open content container -->

<div align="center">
	<div class="page" style="width:98%; text-align:left">
		<div style="padding:0px 2px 0px 2px">

<!-- / start content table -->

<!-- controls below postbits -->
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tbody><tr valign="top">
	
		<td class="smallfont"><a href="http://www.clubdelphi.com/foros/newreply.php?do=newreply&noquote=1&p=336192" rel="nofollow"><img src="./Inyección directa de código IV_files/reply.gif" alt="Respuesta" border="0" title="Respuesta"></a></td>
		
	
</tr>
</tbody></table>
<!-- / controls below postbits -->




<br>



<div class="smallfont" align="center">
	<strong>«</strong>
		<a href="http://www.clubdelphi.com/foros/showthread.php?t=55924&goto=nextoldest" rel="nofollow">Tema Anterior</a>
		|
		<a href="http://www.clubdelphi.com/foros/showthread.php?t=55924&goto=nextnewest" rel="nofollow">Próximo Tema</a>
	<strong>»</strong>
</div>


<br>








<!-- currently active users -->

<!-- end currently active users -->


<!-- popup menu contents -->
<br>

<!-- thread tools menu -->
<div class="vbmenu_popup" id="threadtools_menu" style="display:none">
<form action="http://www.clubdelphi.com/foros/postings.php?t=55924&pollid=" method="post" name="threadadminform">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">Herramientas<a name="goto_threadtools"></a></td>
	</tr>
	<tr>
		<td class="vbmenu_option"><img class="inlineimg" src="./Inyección directa de código IV_files/printer.gif" alt="Mostrar Versión Imprimible" title="Mostrar Versión Imprimible"> <a href="http://www.clubdelphi.com/foros/printthread.php?t=55924" accesskey="3" rel="nofollow">Mostrar Versión Imprimible</a></td>
	</tr>
	<tr>
		<td class="vbmenu_option"><img class="inlineimg" src="./Inyección directa de código IV_files/sendtofriend.gif" alt="Enviar por Correo" title="Enviar por Correo"> <a href="http://www.clubdelphi.com/foros/sendmessage.php?do=sendtofriend&t=55924" rel="nofollow">Enviar por Correo</a></td>
	</tr>
	
	
	
	</tbody></table>
</form>
</div>
<!-- / thread tools menu -->

<!-- **************************************************** -->

<!-- thread display mode menu -->
<div class="vbmenu_popup" id="displaymodes_menu" style="display:none">
	<table cellpadding="4" cellspacing="1" border="0">
	<tbody><tr>
		<td class="thead">Desplegado<a name="goto_displaymodes"></a></td>
	</tr>
	<tr>
	
		<td class="vbmenu_option" title="nohilite"><img class="inlineimg" src="./Inyección directa de código IV_files/mode_linear.gif" alt="Mode Lineal" title="Mode Lineal"> <strong>Mode Lineal</strong></td>
	
	</tr>
	<tr>
	
		<td class="vbmenu_option"><img class="inlineimg" src="./Inyección directa de código IV_files/mode_hybrid.gif" alt="Modo Híbrido" title="Modo Híbrido"> <a href="http://www.clubdelphi.com/foros/showthread.php?mode=hybrid&t=55924">Cambiar a Modo Hibrido</a></td>
	
	</tr>
	<tr>
	
		<td class="vbmenu_option"><img class="inlineimg" src="./Inyección directa de código IV_files/mode_threaded.gif" alt="Modo Hilado" title="Modo Hilado"> <a href="http://www.clubdelphi.com/foros/showthread.php?p=283694&mode=threaded#post283694">Cambiar a Modo Hilado</a></td>
	
	</tr>
	</tbody></table>
</div>
<!-- / thread display mode menu -->

<!-- **************************************************** -->



<!-- **************************************************** -->



<!-- / popup menu contents -->


<!-- forum rules and admin links -->
<table cellpadding="0" cellspacing="0" border="0" width="100%" align="center">
<tbody><tr valign="bottom">
	<td class="smallfont" align="left">
		<table class="tborder" cellpadding="6" cellspacing="1" border="0" width="180">
<thead>
<tr>
	<td class="thead">
		<a style="float:right" href="http://www.clubdelphi.com/foros/showthread.php?t=55924#top" onclick="return toggle_collapse(&#39;forumrules&#39;)"><img id="collapseimg_forumrules" src="./Inyección directa de código IV_files/collapse_thead.gif" alt="" border="0"></a>
		Normas de Publicación
	</td>
</tr>
</thead>
<tbody id="collapseobj_forumrules" style="">
<tr>
	<td class="alt1" nowrap="nowrap"><div class="smallfont">
		
		<div><strong>no Puedes</strong> crear nuevos temas</div>
		<div><strong>no Puedes</strong> responder a temas</div>
		<div><strong>no Puedes</strong> adjuntar archivos</div>
		<div><strong>no Puedes</strong> editar tus mensajes</div>
		<hr>
		
		<div>El <a href="http://www.clubdelphi.com/foros/misc.php?do=bbcode" target="_blank">código vB</a> está <strong>habilitado</strong></div>
		<div>Las <a href="http://www.clubdelphi.com/foros/misc.php?do=showsmilies" target="_blank">caritas</a> están <strong>habilitado</strong></div>
		<div>Código <a href="http://www.clubdelphi.com/foros/misc.php?do=bbcode#imgcode" target="_blank">[IMG]</a> está <strong>habilitado</strong></div>
		<div>Código HTML está <strong>deshabilitado</strong></div>
	</div></td>
</tr>
</tbody>
</table>
	</td>
	<td class="smallfont" align="right">
		<table cellpadding="0" cellspacing="0" border="0">
		
		<tbody><tr>
			<td>
			<div class="smallfont" style="text-align:left; white-space:nowrap">
	<form action="http://www.clubdelphi.com/foros/forumdisplay.php" method="get">
	<input type="hidden" name="s" value="">
	<input type="hidden" name="daysprune" value="">
	<strong>Saltar a Foro</strong><br>
	<select name="f" onchange="this.form.submit();">
		<optgroup label="Zonas del Sitio">
			<option value="cp">User CP</option>
			<option value="pm">Mensajes Privados</option>
			<option value="subs">Suscripciones</option>
			<option value="wol">Quien Está en Línea</option>
			<option value="search">Buscar en los Foros</option>
			<option value="home">Foros Inicio</option>
		</optgroup>
		<optgroup label="Foros">
		<option value="1" class="fjdpth0"> Principal</option>
<option value="34" class="fjdpth1">&nbsp; &nbsp;  Noticias</option>
<option value="2" class="fjdpth1">&nbsp; &nbsp;  Conexión con bases de datos</option>
<option value="3" class="fjdpth1">&nbsp; &nbsp;  Internet</option>
<option value="4" class="fjdpth1">&nbsp; &nbsp;  Impresión</option>
<option value="5" class="fjdpth1">&nbsp; &nbsp;  OOP</option>
<option value="6" class="fjdpth1">&nbsp; &nbsp;  SQL</option>
<option value="7" class="fjsel" selected="selected">&nbsp; &nbsp;  API de Windows</option>
<option value="8" class="fjdpth1">&nbsp; &nbsp;  Gráficos</option>
<option value="9" class="fjdpth1">&nbsp; &nbsp;  Servers</option>
<option value="10" class="fjdpth1">&nbsp; &nbsp;  Providers</option>
<option value="11" class="fjdpth1">&nbsp; &nbsp;  Varios</option>
<option value="12" class="fjdpth0"> Otros entornos y lenguajes</option>
<option value="13" class="fjdpth1">&nbsp; &nbsp;  C++ Builder</option>
<option value="14" class="fjdpth1">&nbsp; &nbsp;  Kylix, Lazarus, FreePascal, etc...</option>
<option value="15" class="fjdpth1">&nbsp; &nbsp;  PHP</option>
<option value="16" class="fjdpth1">&nbsp; &nbsp;  JAVA</option>
<option value="17" class="fjdpth1">&nbsp; &nbsp;  .NET</option>
<option value="38" class="fjdpth1">&nbsp; &nbsp;  HTML, Javascript y otros</option>
<option value="44" class="fjdpth1">&nbsp; &nbsp;  ASM y Microcontroladores</option>
<option value="18" class="fjdpth0"> Bases de datos</option>
<option value="19" class="fjdpth1">&nbsp; &nbsp;  Interbase &amp; Firebird</option>
<option value="20" class="fjdpth1">&nbsp; &nbsp;  Tablas planas</option>
<option value="21" class="fjdpth1">&nbsp; &nbsp;  MySQL</option>
<option value="22" class="fjdpth1">&nbsp; &nbsp;  Oracle</option>
<option value="23" class="fjdpth1">&nbsp; &nbsp;  MS SQL Server</option>
<option value="33" class="fjdpth1">&nbsp; &nbsp;  DB2</option>
<option value="42" class="fjdpth1">&nbsp; &nbsp;  PostgreSQL</option>
<option value="24" class="fjdpth0"> Sistemas operativos</option>
<option value="25" class="fjdpth1">&nbsp; &nbsp;  Linux</option>
<option value="26" class="fjdpth1">&nbsp; &nbsp;  Windows</option>
<option value="27" class="fjdpth0"> Temas relacionados</option>
<option value="29" class="fjdpth1">&nbsp; &nbsp;  Debates</option>
<option value="36" class="fjdpth1">&nbsp; &nbsp;  Seguridad</option>
<option value="37" class="fjdpth1">&nbsp; &nbsp;  Redes</option>
<option value="30" class="fjdpth0"> Otros temas</option>
<option value="31" class="fjdpth1">&nbsp; &nbsp;  Humor</option>
<option value="40" class="fjdpth1">&nbsp; &nbsp;  La Taberna</option>
<option value="41" class="fjdpth1">&nbsp; &nbsp;  Premium</option>
<option value="43" class="fjdpth2">&nbsp; &nbsp; &nbsp; &nbsp;  Proyecto Monitor de Servidores</option>

		</optgroup>
	</select><input type="submit" class="button" value="Ir">
	</form>
</div>
			</td>
		</tr>		
		</tbody></table>
	</td>
</tr>
</tbody></table>
<!-- /forum rules and admin links -->

<br>

<table class="tborder" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<thead>
	<tr>
		<td class="tcat" width="100%" colspan="5">
			<a style="float:right" href="http://www.clubdelphi.com/foros/showthread.php?t=55924#top" onclick="return toggle_collapse(&#39;similarthreads&#39;)"><img id="collapseimg_similarthreads" src="./Inyección directa de código IV_files/collapse_tcat.gif" alt="" border="0"></a>
			Temas Similares<a name="similarthreads"></a>
		</td>
	</tr>
</thead>
<tbody id="collapseobj_similarthreads" style="">
<tr class="thead" align="center">
	<td class="thead" width="40%">Tema</td>
	<td class="thead" width="15%" nowrap="nowrap">Autor</td>
	<td class="thead" width="20%">Foro</td>
	<td class="thead" width="5%">Respuestas</td>
	<td class="thead" width="20%">Último mensaje</td>
</tr>
<tr>
	<td class="alt1" align="left"><span class="smallfont"><a href="http://www.clubdelphi.com/foros/showthread.php?t=35436" title="Hola a todos:

Estoy trabajando con Delphi5 y tengo una aplicación en la que he creado un Thread y en éste el método Execute llama a un procedimiento que se encarga de...">Thread y servidor DCOM externo al proceso ( EXE )</a></span></td>
	<td class="alt2" nowrap="nowrap"><span class="smallfont">Aldo</span></td>
	<td class="alt1" nowrap="nowrap"><span class="smallfont">OOP</span></td>
	<td class="alt2" align="center"><span class="smallfont">1</span></td>
	<td class="alt1" align="right"><span class="smallfont">15-09-2006 <span class="time">18:39:47</span></span></td>
</tr>
<tr>
	<td class="alt1" align="left"><span class="smallfont"><a href="http://www.clubdelphi.com/foros/showthread.php?t=29443" title="Hola, soy nuevo en Delphi (en la programacion en en realidad) y comence por mi cuenta a &quot;jugar&quot; con Turbo Pascal.
Quisera saber:
Para utilizar un componente externo de...">Como utilizar un componente externo?</a></span></td>
	<td class="alt2" nowrap="nowrap"><span class="smallfont">Sergei</span></td>
	<td class="alt1" nowrap="nowrap"><span class="smallfont">OOP</span></td>
	<td class="alt2" align="center"><span class="smallfont">2</span></td>
	<td class="alt1" align="right"><span class="smallfont">24-01-2006 <span class="time">20:12:24</span></span></td>
</tr>
<tr>
	<td class="alt1" align="left"><span class="smallfont"><a href="http://www.clubdelphi.com/foros/showthread.php?t=25021" title="Hola gente.
 
Una pregunta muy concreta, con una referencia a otro foro o a algún sitio con información me daría por contento, porque yo he sido incapaz de encontrar nada.
...">Inyectar proceso</a></span></td>
	<td class="alt2" nowrap="nowrap"><span class="smallfont">conde</span></td>
	<td class="alt1" nowrap="nowrap"><span class="smallfont">API de Windows</span></td>
	<td class="alt2" align="center"><span class="smallfont">4</span></td>
	<td class="alt1" align="right"><span class="smallfont">10-09-2005 <span class="time">16:52:17</span></span></td>
</tr>
<tr>
	<td class="alt1" align="left"><span class="smallfont"><a href="http://www.clubdelphi.com/foros/showthread.php?t=23927" title="Hola como sigo siendo novato me gustaria me dijerais la forma de programar Delphi directamente.
Ejemplo:
Si creo un formulario principal y otro con una base de datos de mis...">Como se puede programar directamente???</a></span></td>
	<td class="alt2" nowrap="nowrap"><span class="smallfont">Antuan</span></td>
	<td class="alt1" nowrap="nowrap"><span class="smallfont">Varios</span></td>
	<td class="alt2" align="center"><span class="smallfont">10</span></td>
	<td class="alt1" align="right"><span class="smallfont">04-08-2005 <span class="time">09:04:38</span></span></td>
</tr>
<tr>
	<td class="alt1" align="left"><span class="smallfont"><a href="http://www.clubdelphi.com/foros/showthread.php?t=20138" title="Hola compañeros, saludos a todos, alguien me puede decir como correr un archivo exe o bat, desde mi aplicación.
 
Gracias por su atención.">Como correr un archivo externo?</a></span></td>
	<td class="alt2" nowrap="nowrap"><span class="smallfont">fayala</span></td>
	<td class="alt1" nowrap="nowrap"><span class="smallfont">Interbase &amp; Firebird</span></td>
	<td class="alt2" align="center"><span class="smallfont">3</span></td>
	<td class="alt1" align="right"><span class="smallfont">07-04-2005 <span class="time">04:56:00</span></span></td>
</tr>

</tbody>
</table>

<br>

<br>
<div class="smallfont" align="center">La franja horaria es GMT +2. Ahora son las <span class="time">18:54:28</span>.</div>
<br>

<center>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="image" src="./Inyección directa de código IV_files/x-click-but04.gif" border="0" name="submit" alt="Realice pagos con PayPal: es rápido, gratis y seguro.">
<img alt="" border="0" src="./Inyección directa de código IV_files/pixel.gif" width="1" height="1">
<input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----MIIHXwYJKoZIhvcNAQcEoIIHUDCCB0wCAQExggEwMIIBLAIBADCBlDCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20CAQAwDQYJKoZIhvcNAQEBBQAEgYARL3QLQbDtO91D1lbKm0En36DmHulohd2lg1Tzh/eDems3cHe48h1hvvIJX5b6OMThZAPg/dCsiDqbgBLf/8V3h+sA3nZErxq/Hdhl6bQX+ihbk51kPoHYHoJSmiiHCr51qRpiVqg0Dm23Wobchq1wLCt72AmKDzRlkQgjDs9pJTELMAkGBSsOAwIaBQAwgdwGCSqGSIb3DQEHATAUBggqhkiG9w0DBwQITYrv8jueQMKAgbhmFN9bYoNaEBNgNQI1DD32wgUEexpsVhR74h9kAUal7Mt/r+WFxb5ejITjyANkz7Fw5vhXsyGYpNGHxIUT8KL6CS21o2ck0DN9Xdd0hTMT/CrtD85aj2QsXablbthQM1O/VxpAuYKmitRYVKwC3xIVPDj+PhMOPIZd80J4hYdM347NfNsIF5rh6bTofAWyGNUK5SRF9v4kfTKzpokbcvLoWI0CfTY3ItUQoF9+EZXI1G6AI7Hi7P4MoIIDhzCCA4MwggLsoAMCAQICAQAwDQYJKoZIhvcNAQEFBQAwgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tMB4XDTA0MDIxMzEwMTMxNVoXDTM1MDIxMzEwMTMxNVowgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDBR07d/ETMS1ycjtkpkvjXZe9k+6CieLuLsPumsJ7QC1odNz3sJiCbs2wC0nLE0uLGaEtXynIgRqIddYCHx88pb5HTXv4SZeuv0Rqq4+axW9PLAAATU8w04qqjaSXgbGLP3NmohqM6bV9kZZwZLR/klDaQGo1u9uDb9lr4Yn+rBQIDAQABo4HuMIHrMB0GA1UdDgQWBBSWn3y7xm8XvVk/UtcKG+wQ1mSUazCBuwYDVR0jBIGzMIGwgBSWn3y7xm8XvVk/UtcKG+wQ1mSUa6GBlKSBkTCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb22CAQAwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQUFAAOBgQCBXzpWmoBa5e9fo6ujionW1hUhPkOBakTr3YCDjbYfvJEiv/2P+IobhOGJr85+XHhN0v4gUkEDI8r2/rNk1m0GA8HKddvTjyGw/XqXa+LSTlDYkqI8OwR8GEYj4efEtcRpRYBxV8KxAW93YDWzFGvruKnnLbDAF6VR5w/cCMn5hzGCAZowggGWAgEBMIGUMIGOMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExFjAUBgNVBAcTDU1vdW50YWluIFZpZXcxFDASBgNVBAoTC1BheVBhbCBJbmMuMRMwEQYDVQQLFApsaXZlX2NlcnRzMREwDwYDVQQDFAhsaXZlX2FwaTEcMBoGCSqGSIb3DQEJARYNcmVAcGF5cGFsLmNvbQIBADAJBgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMDcwNzIwMDg0MTE4WjAjBgkqhkiG9w0BCQQxFgQUyyi5F8PGKWTZI983Vq8t4Ulhs48wDQYJKoZIhvcNAQEBBQAEgYBjzCm1Sh826GuC+OVk0RTwQL6Da3qS4FfaivzR7j9+roDpXBhjnxZcCBpcOokBCYyRIqc0zWMszi1X6oajHz1hOKO0t9PhEhkhsW1Xd7c6E4rCZNFRlCjP+/xLNbKnpj0njo3A28EcrNglJ+cKWX612MfOlJ1sNmoiqapKpUH9wA==-----END PKCS7-----
">
</form>

</center>



		</div>	
	</div>
</div>

<!-- / close content container -->
<!-- /content area table -->

<form action="http://www.clubdelphi.com/foros/index.php" method="get">
	
<table cellpadding="6" cellspacing="0" border="0" width="98%" class="page" align="center">
<tbody><tr>
	
	
		<td class="tfoot">
			<select name="langid" onchange="switch_id(this, &#39;lang&#39;)">
				<optgroup label="Elegir Idioma">
					<option value="1" class="">-- English (US)</option>
<option value="5" class="" selected="selected">-- Español 3.6.7</option>

				</optgroup>
			</select>
		</td>
	
	<td class="tfoot" align="right" width="100%">
		<div class="smallfont">
			<strong>
				<a href="http://www.clubdelphi.com/foros/sendmessage.php" rel="nofollow">Contactar con Nosotros</a> -
				<a href="http://www.clubdelphi.com/">Club Delphi</a> -
				
				
				<a href="http://www.clubdelphi.com/foros/archive/index.php">Archivo</a> -
				
				<a href="http://www.clubdelphi.com/foros/showthread.php?t=55924#top" onclick="self.scrollTo(0, 0); return false;">Top</a>
			</strong>
		</div>
	</td>
</tr>
</tbody></table>

<br>

<div align="center">
	<div class="smallfont" align="center">
	<!-- Do not remove this copyright notice -->
	Powered by vBulletin® Version 3.6.8<br>Copyright ©2000 - 2011, Jelsoft Enterprises Ltd.
	<!-- Do not remove this copyright notice -->
	</div>
	
	<div class="smallfont" align="center">
	<!-- Do not remove  or your scheduled tasks will cease to function -->
	
	<!-- Do not remove  or your scheduled tasks will cease to function -->
	
	Traducción al castellano por el <a href="http://www.clubdelphi.com/foros/showgroups.php?">equipo de moderadores</a> del Club Delphi
	</div>
</div>

</form>


<script type="text/javascript">
<!--
	// Main vBulletin Javascript Initialization
	vBulletin_init();
//-->
</script>
<table width="100%" border="0" cellpadding="0" cellspacing="0" background="./Inyección directa de código IV_files/pie_fondo_tabla.gif">
  <tbody><tr>
    <td width="100" valign="top"><div align="right"><img src="./Inyección directa de código IV_files/pie_izq.gif" width="37" height="48"></div></td>
    <td valign="top">
   <table width="100%" height="48" border="0" cellpadding="0" cellspacing="0">
      <tbody><tr>
        <td height="24" rowspan="1" background="./Inyección directa de código IV_files/pie_celda_arriba.gif"><div align="center"><font face="Tahoma" size="1"><b>
			<a href="http://www.clubdelphi.com/">Inicio</a> | 
			<a href="http://www.clubdelphi.com/foros/sendmessage.php">Contacto</a> | 
			<a href="http://www.clubdelphi.com/foros/">Foros</a> | 
			<a href="http://www.clubdelphi.com/foros/forumdisplay.php?f=34">Noticias</a> | 
			<a href="http://www.clubdelphi.net/">Hosting</a> | 
			<a href="http://www.clubdelphi.com/trabajo.php">Trabajo</a></b></font></div></td>
      </tr>
      <tr>
        <td height="25" rowspan="1" background="./Inyección directa de código IV_files/pie_celda_abajo.gif"><div align="center"><font face="Tahoma" size="1">Copyright
          1996-2007 Club Delphi</font></div></td>
      </tr>
    </tbody></table>
   </td>
    <td width="100" valign="top"><div align="left"><img height="48" src="./Inyección directa de código IV_files/pie_dch.gif" width="37" border="0"> </div></td>
  </tr>
</tbody></table>

<!-- temp -->
<div style="display:none">
	<!-- thread rate -->
	
		
	
	<!-- / thread rate -->
</div>


</body><style type="text/css">/*This block of style rules is inserted by AdBlock*/#RadAd_Skyscraper,#bbccom_leaderboard,#center_banner,#footer_adcode,#hbBHeaderSpon,#hiddenHeaderSpon,#navbar_adcode,#rightAds,#rightcolumn_adcode,#top-advertising,#topMPU,#tracker_advertorial,.ad-now,.dfpad,.prWrap,[id^="ad_block"],[id^="adbrite"],[id^="dclkAds"],[id^="ew"][id$="_bannerDiv"],[id^="konaLayer"],a.kLink span[id^="preLoadWrap"].preLoadWrap,a[href^="http://ad."][href*=".doubleclick.net/"],a[href^="http://adserver.adpredictive.com"],div#adxLeaderboard,div#dir_ads_site,div#FFN_Banner_Holder,div#FFN_imBox_Container,div#p360-format-box,div#rhs div#rhs_block table#mbEnd,div#rm_container,div#tads table[align="center"][width="100%"],div#tooltipbox[class^="itxt"],div[class^="dms_ad_IDS"],div[id^="adKontekst_"],div[id^="google_ads_div"],div[id^="kona_"][id$="_wrapper"],div[id^="sponsorads"],div[id^="y5_direct"],iframe.chitikaAdBlock,iframe[id^="dapIfM"],iframe[id^="etarget"][id$="banner"],iframe[name^="AdBrite"],iframe[name^="google_ads_"],img[src^="http://cdn.adnxs.com"],ispan#ab_pointer,object#flashad,object#ve_threesixty_swf[name="ve_threesixty_swf"],table[cellpadding="0"][width="100%"] > * > * > * > div[id^="tpa"],#A9AdsMiddleBoxTop,#A9AdsOutOfStockWidgetTop,#A9AdsServicesWidgetTop,#ADSLOT_1,#ADSLOT_2,#ADSLOT_3,#ADSLOT_4,#AD_CONTROL_22,#ADsmallWrapper,#Ad160x600,#Ad2,#Ad300x250,#Ad3Left,#Ad3Right,#Ad3TextAd,#AdArea,#AdBanner_F1,#AdBar,#AdBar1,#AdContainer,#AdContainerTop,#AdContentModule_F,#AdDetails_GoogleLinksBottom,#AdDetails_InsureWith,#AdFrame4,#AdLeaderboardBottom,#AdLeaderboardTop,#AdMiddle,#AdMobileLink,#AdRectangle,#AdSenseDiv,#AdServer,#AdShowcase_F1,#AdSky23,#AdSkyscraper,#AdSponsor_SF,#AdSubsectionShowcase_F1,#AdTargetControl1_iframe,#AdText,#AdTop,#AdTopLeader,#Ad_BelowContent,#Ad_Block,#Ad_Center1,#Ad_Right1,#Ad_RightBottom,#Ad_RightTop,#Ad_Top,#Adrectangle,#Ads,#AdsContent,#AdsRight,#AdsWrap,#Ads_BA_CAD,#Ads_BA_CAD2,#Ads_BA_CAD_box,#Ads_BA_SKY,#Ads_CAD,#Ads_Special,#AdvertMPU23b,#AdvertPanel,#Advertorial,#Advertorials,#BannerAdvert,#BigBoxAd,#BodyAd,#BotAd,#Bottom468x60AD,#ButtonAd,#CompanyDetailsNarrowGoogleAdsPresentationControl,#CompanyDetailsWideGoogleAdsPresentationControl,#ContentAd,#ContentAd1,#ContentAd2,#ContentAdPlaceHolder1,#ContentAdPlaceHolder2,#ContentAdXXL,#ContentPolepositionAds_Result,#DivAdEggHeadCafeTopBanner,#FooterAd,#FooterAdContainer,#GoogleAd1,#GoogleAd2,#GoogleAd3,#GoogleAdsPresentationControl,#GoogleAdsense,#Google_Adsense_Main,#HEADERAD,#HOME_TOP_RIGHT_BOXAD,#HeaderAD,#HeaderAdsBlock,#HeaderAdsBlockFront,#HeaderBannerAdSpacer,#HeaderTextAd,#HeroAd,#HomeAd1,#HouseAd,#ID_Ad_Sky,#JobsearchResultsAds,#Journal_Ad_125,#Journal_Ad_300,#KH-contentAd,#LargeRectangleAd,#LeftAd,#LeftAdF1,#LeftAdF2,#LftAd,#LoungeAdsDiv,#LowerContentAd,#MainSponsoredLinks,#Nightly_adContainer,#NormalAdModule,#OverrideAdArea,#PREFOOTER_LEFT_BOXAD,#PREFOOTER_RIGHT_BOXAD,#PageLeaderAd,#RelevantAds,#RgtAd1,#RightAd,#RightBottom300x250AD,#RightNavTopAdSpot,#RightSponsoredAd,#SectionAd300-250,#SectionSponsorAd,#SidebarAdContainer,#SkyAd,#SpecialAds,#SponsoredAd,#SponsoredLinks,#TOP_ADROW,#TOP_RIGHT_BOXAD,#Tadspacefoot,#Tadspacemrec,#Top468x60AD,#TopAdBox,#TopAdContainer,#TopAdDiv,#TopAdPos,#VM-MPU-adspace,#VM-footer-adspace,#VM-header-adspace,#VM-header-adwrap,#XEadLeaderboard,#XEadSkyscraper,#YahooAdParentContainer,#_ads,#about_adsbottom,#abovepostads,#ad-120x600-sidebar,#ad-120x60Div,#ad-160x600,#ad-160x600-sidebar,#ad-250,#ad-250x300,#ad-300,#ad-300x250,#ad-300x250-sidebar,#ad-300x250Div,#ad-300x60-1,#ad-728,#ad-728x90-leaderboard-top,#ad-article,#ad-banner,#ad-banner-1,#ad-billboard-bottom,#ad-block-125,#ad-bottom,#ad-bottom-wrapper,#ad-box-first,#ad-box-second,#ad-boxes,#ad-bs,#ad-buttons,#ad-colB-1,#ad-column,#ad-content,#ad-contentad,#ad-flex-first,#ad-footer,#ad-footprint-160x600,#ad-frame,#ad-front-footer,#ad-front-sponsoredlinks,#ad-halfpage,#ad-horizontal-header,#ad-img,#ad-inner,#ad-label,#ad-leaderboard,#ad-leaderboard-bottom,#ad-leaderboard-container,#ad-leaderboard-spot,#ad-leaderboard-top,#ad-left,#ad-links-content,#ad-list-row,#ad-lrec,#ad-medium,#ad-medium-rectangle,#ad-medrec,#ad-middlethree,#ad-middletwo,#ad-module,#ad-mpu,#ad-mpu1-spot,#ad-mpu2,#ad-mpu2-spot,#ad-north,#ad-one,#ad-placard,#ad-placeholder,#ad-rectangle,#ad-right,#ad-righttop,#ad-row,#ad-side-text,#ad-sidebar,#ad-sky,#ad-skyscraper,#ad-slug-wrapper,#ad-small-banner,#ad-space,#ad-special,#ad-splash,#ad-sponsors,#ad-spot,#ad-squares,#ad-target,#ad-target-Leaderbord,#ad-teaser,#ad-text,#ad-top-banner,#ad-top-text-low,#ad-top-wrap,#ad-tower,#ad-trailerboard-spot,#ad-two,#ad-typ1,#ad-unit,#ad-west,#ad-wrap,#ad-wrap-right,#ad-wrapper1,#ad-yahoo-simple,#ad1006,#ad11,#ad125BL,#ad125BR,#ad125TL,#ad125TR,#ad125x125,#ad160x600,#ad160x600right,#ad1Sp,#ad2,#ad2Sp,#ad300,#ad300-250,#ad300X250,#ad300_x_250,#ad300x100Middle,#ad300x150,#ad300x250,#ad300x250Module,#ad300x60,#ad300x600,#ad300x600_callout,#ad336,#ad336x280,#ad375x85,#ad4,#ad468,#ad468x60,#ad468x60_top,#ad526x250,#ad600,#ad7,#ad728,#ad728Mid,#ad728Top,#ad728Wrapper,#ad728top,#ad728x90_1,#adBadges,#adBanner120x600,#adBanner160x600,#adBanner336x280,#adBanner728,#adBannerTable,#adBannerTop,#adBar,#adBelt,#adBlock125,#adBlocks,#adBox,#adBox350,#adBox390,#adCirc300X200,#adCirc_620_100,#adColumn,#adContainer_1,#adContainer_2,#adContainer_3,#adDiv300,#adDiv728,#adFiller,#adFps,#adFtofrs,#adGallery,#adGroup1,#adHeaderTop,#adIsland,#adL,#adLB,#adLabel,#adLayer,#adLeader,#adLeaderTop,#adLeaderboard,#adMPU,#adMediumRectangle,#adMiddle0Frontpage,#adMiniPremiere,#adP,#adPlaceHolderRight,#adPlacer,#adRight,#adSenseModule,#adSenseWrapper,#adServer_marginal,#adSidebar,#adSidebarSq,#adSky,#adSkyscraper,#adSlider,#adSpace,#adSpace3,#adSpace300_ifrMain,#adSpace4,#adSpace5,#adSpace6,#adSpace7,#adSpace_footer,#adSpace_right,#adSpace_top,#adSpacer,#adSpecial,#adSplotlightEm,#adSpot-Leader,#adSpot-banner,#adSpot-island,#adSpot-mrec1,#adSpot-sponsoredlinks,#adSpot-textbox1,#adSpot-widestrip,#adSpotAdvertorial,#adSpotIsland,#adSpotSponsoredLinks,#adSquare,#adStaticA,#adStrip,#adSuperAd,#adSuperPremiere,#adSuperSkyscraper,#adSuperbanner,#adTableCell,#adTag1,#adTag2,#adText,#adTextLink,#adText_container,#adTile,#adTopContent,#adTopboxright,#adTower,#adUnit,#adZoneTop,#ad_1,#ad_130x250_inhouse,#ad_160x160,#ad_160x600,#ad_190x90,#ad_2,#ad_3,#ad_300,#ad_300_250,#ad_300_250_1,#ad_300x250,#ad_300x250_content_column,#ad_300x90,#ad_4,#ad_468_60,#ad_5,#ad_728_foot,#ad_728x90,#ad_728x90_container,#ad_940,#ad_984,#ad_A,#ad_B,#ad_Banner,#ad_C,#ad_C2,#ad_D,#ad_E,#ad_F,#ad_G,#ad_H,#ad_I,#ad_J,#ad_K,#ad_L,#ad_M,#ad_N,#ad_O,#ad_P,#ad_YieldManager-300x250,#ad_anchor,#ad_banner,#ad_banner_top,#ad_bar,#ad_bellow_post,#ad_block_1,#ad_block_2,#ad_bottom,#ad_box,#ad_box_colspan,#ad_box_top,#ad_branding,#ad_bs_area,#ad_buttons,#ad_center_monster,#ad_cont,#ad_container_marginal,#ad_container_side,#ad_container_top,#ad_content_top,#ad_content_wrap,#ad_feature,#ad_firstpost,#ad_footer,#ad_front_three,#ad_fullbanner,#ad_global_header,#ad_haha_1,#ad_haha_4,#ad_halfpage,#ad_head,#ad_header,#ad_holder,#ad_horizontal,#ad_horseshoe_left,#ad_horseshoe_right,#ad_horseshoe_spacer,#ad_horseshoe_top,#ad_hotpots,#ad_in_arti,#ad_island,#ad_label,#ad_large_rectangular,#ad_lastpost,#ad_layer2,#ad_leaderBoard,#ad_leaderboard,#ad_leaderboard728x90,#ad_leaderboard_top,#ad_left,#ad_lrec,#ad_lwr_square,#ad_main,#ad_medium_rectangle,#ad_medium_rectangular,#ad_mediumrectangle,#ad_menu_header,#ad_message,#ad_middle,#ad_most_pop_234x60_req_wrapper,#ad_mpu,#ad_mpu300x250,#ad_mpuav,#ad_mrcontent,#ad_overlay,#ad_play_300,#ad_rect,#ad_rect_body,#ad_rect_bottom,#ad_rectangle,#ad_rectangle_medium,#ad_related_links_div,#ad_related_links_div_program,#ad_replace_div_0,#ad_replace_div_1,#ad_report_leaderboard,#ad_report_rectangle,#ad_right,#ad_right_main,#ad_ros_tower,#ad_rr_1,#ad_sec,#ad_sec_div,#ad_sgd,#ad_sidebar,#ad_sidebar1,#ad_sidebar2,#ad_sidebar3,#ad_skyscraper,#ad_skyscraper160x600,#ad_skyscraper_text,#ad_slot_leaderboard,#ad_slot_livesky,#ad_slot_sky_top,#ad_ss,#ad_term_bottom_place,#ad_text:not(textarea),#ad_thread_first_post_content,#ad_top,#ad_top_holder,#ad_tp_banner_1,#ad_tp_banner_2,#ad_unit,#ad_vertical,#ad_wide,#ad_wide_box,#ad_widget,#ad_window,#ad_wrap,#adbForum,#adbanner,#adbig,#adbnr,#adboard,#adbottom,#adbox1,#adbox2,#adclear,#adcode,#adcode1,#adcode2,#adcode3,#adcode4,#adcolumnwrapper,#adcontainer,#adcontainerRight,#adcontainsm,#adcontent,#adcontent1,#adcontrolPushSite,#add_ciao2,#addbottomleft,#addiv-bottom,#addiv-top,#adfooter,#adfooter_728x90,#adframe:not(frameset),#adhead,#adhead_g,#adheader,#adhome,#adiframe1_iframe,#adiframe2_iframe,#adiframe3_iframe,#adimg,#adition_content_ad,#adlabel,#adlabelFooter,#adlayerad,#adleaderboard,#adleft,#adlinks,#adlinkws,#adlrec,#admid,#admiddle3center,#admiddle3left,#adposition,#adposition-C,#adposition-FPMM,#adposition1,#adposition2,#adposition4,#adrectangle,#adrectanglea,#adrectangleb,#adrig,#adright,#adright2,#adrighthome,#ads-468,#ads-area,#ads-block,#ads-bot,#ads-bottom,#ads-col,#ads-dell,#ads-horizontal,#ads-indextext,#ads-leaderboard1,#ads-lrec,#ads-menu,#ads-middle,#ads-prices,#ads-rhs,#ads-right,#ads-sponsored-boxes,#ads-top,#ads-vers7,#ads-wrapper,#ads120,#ads160left,#ads2,#ads300,#ads300-250,#ads300Bottom,#ads300Top,#ads336x280,#ads7,#ads728bottom,#ads728top,#ads790,#adsDisplay,#adsID,#ads_160,#ads_300,#ads_728,#ads_banner,#ads_belowforumlist,#ads_belownav,#ads_bottom_inner,#ads_bottom_outer,#ads_box,#ads_button,#ads_catDiv,#ads_footer,#ads_html1,#ads_html2,#ads_medrect,#ads_notice,#ads_right,#ads_right_sidebar,#ads_sidebar_roadblock,#ads_space,#ads_top,#ads_watch_top_square,#ads_zone27,#adsbottom,#adsbox,#adscolumn,#adsd_contentad_r1,#adsd_contentad_r2,#adsd_contentad_r3,#adsd_topbanner,#adsd_txt_sky,#adsdiv,#adsense-2,#adsense-header,#adsense-tag,#adsense-text,#adsenseLeft,#adsenseOne,#adsenseWrap,#adsense_article_left,#adsense_box,#adsense_leaderboard,#adsense_overlay,#adsense_placeholder_2,#adsenseheader,#adsensetopplay,#adsensewidget-3,#adserv,#adsimage,#adsky,#adskyscraper,#adslot,#adsonar,#adspace-300x250,#adspace300x250,#adspaceBox,#adspaceBox300,#adspace_header,#adspot,#adspot-1,#adspot-149x170,#adspot-1x4,#adspot-2,#adspot-295x60,#adspot-2a,#adspot-2b,#adspot-300x250-pos-1,#adspot-300x250-pos-2,#adspot-468x60-pos-2,#adspot-a,#adspot300x250,#adspot_220x90,#adspot_300x250,#adspot_468x60,#adspot_728x90,#adsquare,#adsright,#adst,#adstop,#adt,#adtab,#adtag_right_side,#adtaily-widget-light,#adtech_googleslot_03c,#adtech_takeover,#adtop,#adtophp,#adtxt,#adv-masthead,#adv_google_300,#adv_google_728,#adv_top_banner_wrapper,#adver1,#adver2,#adver3,#adver4,#adver5,#adver6,#adver7,#advert-1,#advert-120,#advert-boomer,#advert-display,#advert-header,#advert-leaderboard,#advert-links-bottom,#advert-skyscraper,#advert-top,#advert1,#advertBanner,#advertContainer,#advertDB,#advertRight,#advert_125x125,#advert_250x250,#advert_box,#advert_home01,#advert_leaderboard,#advert_lrec_format,#advert_mid,#advert_mpu,#advert_right_skyscraper,#advertbox,#advertbox2,#advertbox3,#advertbox4,#adverthome,#advertise-here-sidebar,#advertise-now,#advertise1,#advertiseHere,#advertisement160x600,#advertisement728x90,#advertisementLigatus,#advertisementPrio2,#advertisementsarticle,#advertiser-container,#advertiserLinks,#advertisers,#advertising-banner,#advertising-caption,#advertising-container,#advertising-control,#advertising-skyscraper,#advertising2,#advertisingModule160x600,#advertisingModule728x90,#advertisment,#advertismentElementInUniversalbox,#advertorial,#adverts-top-container,#adverts-top-left,#adverts-top-middle,#adverts-top-right,#advertsingle,#advt,#adwhitepaperwidget,#adwin_rec,#adwith,#adwords-4-container,#adxBigAd,#adxMiddle5,#adxSponLink,#adxSponLinkA,#adxtop,#adz,#adzbanner,#adzerk,#adzerk1,#adzoneBANNER,#affinityBannerAd,#agi-ad300x250,#agi-ad300x250overlay,#agi-sponsored,#alert_ads,#anchorAd,#annoying_ad,#ap_adframe,#apiBackgroundAd,#apiTopAdWrap,#apmNADiv,#araHealthSponsorAd,#article-ad-container,#article-box-ad,#articleAdReplacement,#articleLeftAdColumn,#articleSideAd,#article_ad,#article_ad_container,#article_box_ad,#asinglead,#atlasAdDivGame,#awds-nt1-ad,#banner-300x250,#banner-ad,#banner-ad-container,#banner-ads,#banner250x250,#banner468x60,#banner728x90,#bannerAd,#bannerAdTop,#bannerAd_ctr,#banner_ad,#banner_ad_footer,#banner_ad_module,#banner_admicro,#banner_ads,#banner_content_ad,#banner_topad,#bannerad2,#baseAdvertising,#bbccom_mpu,#bbccom_storyprintsponsorship,#bbo_ad1,#bg-footer-ads,#bg-footer-ads2,#bg_YieldManager-300x250,#bigAd,#bigBoxAd,#bigad300outer,#bigadbox,#bigadframe,#bigadspot,#billboard_ad,#block-ad_cube-1,#block-openads-0,#block-openads-1,#block-openads-2,#block-openads-3,#block-openads-4,#block-openads-5,#block-thewrap_ads_250x300-0,#blog-ad,#blog_ad_content,#blog_ad_opa,#blox-big-ad,#blox-big-ad-bottom,#blox-big-ad-top,#blox-halfpage-ad,#blox-tile-ad,#blox-tower-ad,#body_728_ad,#book-ad,#botad,#bott_ad2,#bott_ad2_300,#bottom-ad,#bottom-ad-container,#bottom-ads,#bottomAd,#bottomAdCCBucket,#bottomAdContainer,#bottomAdSense,#bottomAdSenseDiv,#bottomAds,#bottomRightAd,#bottomRightAdSpace,#bottom_ad,#bottom_ad_area,#bottom_ad_unit,#bottom_ads,#bottom_banner_ad,#bottom_overture,#bottom_sponsor_ads,#bottom_sponsored_links,#bottom_text_ad,#bottomad,#bottomads,#bottomadsense,#bottomadwrapper,#bottomleaderboardad,#box-content-ad,#box-googleadsense-1,#box-googleadsense-r,#box1ad,#boxAd300,#boxAdContainer,#box_ad,#box_advertisment,#box_mod_googleadsense,#boxad1,#boxad2,#boxad3,#boxad4,#boxad5,#bpAd,#bps-header-ad-container,#btr_horiz_ad,#burn_header_ad,#button-ads-horizontal,#button-ads-vertical,#buttonAdWrapper1,#buttonAdWrapper2,#buttonAds,#buttonAdsContainer,#button_ad_container,#button_ad_wrap,#buttonad,#buy-sell-ads,#c4ad-Middle1,#c_ad_sb,#c_ad_sky,#caAdLarger,#catad,#category-ad,#cellAd,#channel_ad,#channel_ads,#ciHomeRHSAdslot,#circ_ad,#cnnRR336ad,#cnnTopAd,#cnnVPAd,#col3_advertising,#colAd,#colRightAd,#collapseobj_adsection,#column4-google-ads,#comments-ad-container,#commercial_ads,#common_right_ad_wrapper,#common_right_lower_ad_wrapper,#common_right_lower_adspace,#common_right_lower_player_ad_wrapper,#common_right_lower_player_adspace,#common_right_player_ad_wrapper,#common_right_player_adspace,#common_right_right_adspace,#common_top_adspace,#companion-ad { visibility:hidden !important; display:none !important; } #companionAdDiv,#containerLocalAds,#containerLocalAdsInner,#containerMrecAd,#containerSqAd,#content-ad-header,#content-header-ad,#contentBoxad,#contentTopAds2,#content_ad_square,#content_ad_top,#content_ads_content,#content_box_300body_sponsoredoffers,#content_box_adright300_google,#content_mpu,#contentad,#contentad_imtext,#contentad_right,#contentads,#contentinlineAd,#contextad,#contextual-ads,#contextual-ads-block,#contextualad,#coverads,#ctl00_Adspace_Top_Height,#ctl00_BottomAd,#ctl00_ContentMain_BanManAd468_BanManAd,#ctl00_ContentRightColumn_RightColumn_Ad1_BanManAd,#ctl00_ContentRightColumn_RightColumn_Ad2_BanManAd,#ctl00_ContentRightColumn_RightColumn_PremiumAd1_ucBanMan_BanManAd,#ctl00_LHTowerAd,#ctl00_LeftHandAd,#ctl00_MasterHolder_IBanner_adHolder,#ctl00_TopAd,#ctl00_TowerAd,#ctl00_VBanner_adHolder,#ctl00__Content__RepeaterReplies_ctl03__AdReply,#ctl00_abot_bb,#ctl00_adFooter,#ctl00_advert_LargeMPU_div_AdPlaceHolder,#ctl00_atop_bt,#ctl00_cphMain_hlAd1,#ctl00_cphMain_hlAd2,#ctl00_cphMain_hlAd3,#ctl00_ctl00_MainPlaceHolder_itvAdSkyscraper,#ctl00_ctl00_ctl00_Main_Main_PlaceHolderGoogleTopBanner_MPTopBannerAd,#ctl00_ctl00_ctl00_Main_Main_SideBar_MPSideAd,#ctl00_dlTilesAds,#ctl00_m_skinTracker_m_adLBL,#ctl00_phCrackerMain_ucAffiliateAdvertDisplayMiddle_pnlAffiliateAdvert,#ctl00_phCrackerMain_ucAffiliateAdvertDisplayRight_pnlAffiliateAdvert,#ctrlsponsored,#cubeAd,#cube_ads,#cube_ads_inner,#cubead,#cubead-2,#dItemBox_ads,#dart_160x600,#dc-display-right-ad-1,#dcol-sponsored,#defer-adright,#detail_page_vid_topads,#div-gpt-ad-1,#div-gpt-ad-2,#div-gpt-ad-3,#div-gpt-ad-4,#divAdBox,#divAdWrapper,#divDoubleAd,#divLeftAd12,#divLeftRecAd,#divMenuAds,#divWNAdHeader,#divWrapper_Ad,#div_ad_leaderboard,#div_video_ads,#dlads,#dni-header-ad,#dnn_ad_banner,#download_ads,#ds-mpu,#editorsmpu,#embedded-ad,#evotopTen_advert,#ex-ligatus,#exads,#featured-advertisements,#featuredAdContainer2,#featuredAds,#feed_links_ad_container,#first-300-ad,#first-adlayer,#first_ad_unit,#firstad,#fl_hdrAd,#flash_ads_1,#flexiad,#footad,#footer-ad,#footer-advert,#footer-adverts,#footer-sponsored,#footerAd,#footerAdDiv,#footerAds,#footerAdvertisement,#footerAdverts,#footer_ad_01,#footer_ad_block,#footer_ad_container,#footer_ad_modules,#footer_adspace,#footer_text_ad,#footerad,#footerads,#footeradsbox,#forum_top_ad,#fpv_companionad,#fr_ad_center,#frame_admain,#frnAdSky,#frnBannerAd,#frnContentAd,#from_our_sponsors,#front_advert,#front_mpu,#ft-ad,#ft-ad-1,#ft-ad-container,#ft_mpu,#fusionad,#fw-advertisement,#g_ad,#g_adsense,#ga_300x250,#gad,#gad2,#gad3,#gad5,#galleries-tower-ad,#gallery-ad-m0,#gallery_ads,#game-info-ad,#gasense,#gglads,#global_header_ad_area,#gmi-ResourcePageAd,#gmi-ResourcePageLowerAd,#goads,#gooadtop,#google-ad,#google-ad-art,#google-ad-table-right,#google-ad-tower,#google-ads,#google-ads-bottom,#google-ads-header,#google-ads-left-side,#google-adsense-mpusize,#googleAd,#googleAds,#googleAdsSml,#googleAdsense,#googleAdsenseBanner,#googleAdsenseBannerBlog,#googleAdwordsModule,#googleAfcContainer,#googleSearchAds,#googleShoppingAdsRight,#googleShoppingAdsTop,#googleSubAds,#google_ad,#google_ad_container,#google_ad_inline,#google_ad_test,#google_ads,#google_ads_aCol,#google_ads_frame1,#google_ads_frame1_anchor,#google_ads_frame2,#google_ads_frame2_anchor,#google_ads_frame3,#google_ads_frame3_anchor,#google_ads_test,#google_ads_top,#google_adsense_home_468x60_1,#googlead2,#googleadbox,#googleads,#googleadsense,#googlesponsor,#gpt-ad-halfpage,#gpt-ad-rectangle1,#gpt-ad-rectangle2,#gpt-ad-skyscraper,#gpt-ad-story_rectangle3,#grid_ad,#gsyadrectangleload,#gsyadrightload,#gsyadtop,#gsyadtopload,#gtopadvts,#half-page-ad,#halfPageAd,#halfe-page-ad-box,#hd-ads,#hd-banner-ad,#hdtv_ad_ss,#headAd,#head_advert,#headad,#header-ad,#header-ad-rectangle-container,#header-ads,#header-adspace,#header-advert,#header-advertisement,#header-advertising,#header-adverts,#headerAd,#headerAdBackground,#headerAdContainer,#headerAdWrap,#headerAds,#headerAdsWrapper,#headerTopAd,#header_ad_728_90,#header_ad_container,#header_adcode,#header_ads,#header_advertisement_top,#header_leaderboard_ad_container,#header_publicidad,#headerad,#headeradbox,#headerads,#headeradsbox,#headeradwrap,#headline_ad,#headlinesAdBlock,#hiddenadAC,#hideads,#hl-sponsored-results,#hly_ad_side_bar_tower_left,#home-advert-module,#home-rectangle-ad,#home-sponsors-module,#homeTopRightAd,#home_ad,#home_bottom_ad,#home_contentad,#home_feature_ad,#home_mpu,#home_spensoredlinks,#homepage-ad,#homepageAdsTop,#homepageFooterAd,#homepage_right_ad,#homepage_right_ad_container,#homepage_top_ads,#hometop_234x60ad,#hor_ad,#horizontal-banner-ad,#horizontal_ad,#horizontal_ad_top,#horizontalads,#houseAd,#hp-header-ad,#hp-right-ad,#hp-store-ad,#hpV2_300x250Ad,#hpV2_googAds,#icePage_SearchLinks_AdRightDiv,#icePage_SearchLinks_DownloadToolbarAdRightDiv,#icePage_SearchResults_ads0_SponsoredLink,#icePage_SearchResults_ads1_SponsoredLink,#icePage_SearchResults_ads2_SponsoredLink,#icePage_SearchResults_ads3_SponsoredLink,#icePage_SearchResults_ads4_SponsoredLink,#imu_ad_module,#in_serp_ad,#inadspace,#indexad,#inline-story-ad,#inlinead,#inlinegoogleads,#inlist-ad-block,#inner-advert-row,#innerpage-ad,#inside-page-ad,#insider_ad_wrapper,#instoryad,#instoryadtext,#instoryadwrap,#int-ad,#interstitial_ad_wrapper,#islandAd,#j_ad,#ji_medShowAdBox,#jmp-ad-buttons,#joead,#joead2,#ka_adRightSkyscraperWide,#kdz_ad1,#kdz_ad2,#landing-adserver,#largead,#lateAd,#layerAds_layerDiv,#layerTLDADSERV,#lb-sponsor-left,#lb-sponsor-right,#leader-board-ad,#leader-sponsor,#leaderAd,#leaderAdContainer,#leader_board_ad,#leaderad,#leaderad_section,#leaderboard-ad,#leaderboard-bottom-ad,#leaderboard_ad,#left-ad-skin,#left-lower-adverts,#left-lower-adverts-container,#leftAdContainer,#leftAd_rdr,#leftAdvert,#leftSectionAd300-100,#left_ad,#left_adspace,#leftad,#leftads,#leftcolAd,#lg-banner-ad,#ligatus,#linkAds,#linkads,#live-ad,#logoAd,#longAdSpace,#lowerAdvertisementImg,#lowerads,#lowerthirdad,#lowertop-adverts,#lowertop-adverts-container,#lpAdPanel,#lrecad,#lsadvert-left_menu_1,#lsadvert-left_menu_2,#lsadvert-top,#mBannerAd,#main-ad,#main-ad160x600,#main-ad160x600-img,#main-ad728x90,#main-bottom-ad,#mainAdUnit,#mainAdvert,#main_ad,#main_rec_ad,#main_top_ad_container,#marketing-promo,#mastAd,#mastAdvert,#mastad,#mastercardAd,#masthead_ad,#masthead_topad,#medRecAd,#media_ad,#mediaplayer_adburner,#mediumAdvertisement,#medrectad,#menuAds,#mi_story_assets_ad,#mid-ad300x250,#mid-table-ad,#midRightTextAds,#mid_ad_div,#mid_ad_title,#mid_mpu,#midadd,#midadspace,#middle-ad,#middlead,#middleads,#midrect_ad,#midstrip_ad,#mini-ad,#mochila-column-right-ad-300x250,#mochila-column-right-ad-300x250-1,#module-google_ads,#module_ad,#module_box_ad,#module_sky_scraper,#monsterAd,#moogleAd,#most_popular_ad,#motionAd,#mpu,#mpu-advert,#mpu300250,#mpuAd,#mpuDiv,#mpuSlot,#mpuWrapper,#mpuWrapperAd,#mpu_banner,#mpu_holder,#mpu_text_ad,#mpuad,#mr_banner_topad,#mrecAdContainer,#msAds,#ms_ad,#msad,#multiLinkAdContainer,#multi_ad,#myads_HeaderButton,#n_sponsor_ads,#namecom_ad_hosting_main,#narrow_ad_unit,#natadad300x250,#national_microlink_ads,#nationalad,#navi_banner_ad_780,#nba160PromoAd,#nba300Ad,#nbaHouseAnd600Ad,#nbaLeft600Ad,#nbaMidAds,#nbaVid300Ad,#new_topad,#newads,#ng_rtcol_ad,#noresults_ad_container,#noresultsads,#northad,#ns_ad1,#ns_ad2,#ns_ad3,#oanda_ads,#onespot-ads,#online_ad,#p-googleadsense,#page-header-ad,#page-top-ad,#pageAds,#pageAdsDiv,#page_content_top_ad,#pagelet_adbox,#pagelet_netego_ads,#pagelet_search_ads2,#panelAd,#pb_report_ad,#pcworldAdBottom,#pcworldAdTop,#pinball_ad,#player-below-advert,#player_ad,#player_ads,#pod-ad-video-page,#populate_ad_bottom,#populate_ad_left,#portlet-advertisement-left,#portlet-advertisement-right,#post-promo-ad,#post5_adbox,#post_ad,#premium_ad,#priceGrabberAd,#prime-ad-space,#print_ads,#product-adsense,#promoAds,#ps-vertical-ads,#pub468x60,#publicidad,#pushdown_ad,#qm-ad-big-box,#qm-ad-sky,#qm-dvdad,#r1SoftAd,#rail_ad1,#rail_ad2,#realEstateAds,#rectAd,#rect_ad,#rectangle-ad,#rectangle_ad,#refine-300-ad,#region-node-advert,#region-top-ad,#rh-ad-container,#rh_tower_ad,#rhapsodyAd,#rhs_ads,#rhsadvert,#right-ad,#right-ad-skin,#right-ad-title,#right-ads-3,#right-box-ad,#right-featured-ad,#right-mpu-1-ad-container,#right-uppder-adverts,#right-uppder-adverts-container,#rightAd,#rightAd300x250,#rightAdBar,#rightAdColumn,#rightAd_rdr,#rightAdsDiv,#rightColAd,#rightColumnMpuAd,#rightColumnSkyAd,#rightTopSponsor,#right_ad_wrapper,#right_ads,#right_advertisement,#right_advertising,#right_column_ad_container,#right_column_ads,#right_column_internal_ad_container,#right_column_top_ad_unit,#rightad,#rightadContainer,#rightadvertbar-doubleclickads,#rightbar-ad,#rightcolumn_300x250ad,#rightside-ads,#rightside_ad,#righttop-adverts,#righttop-adverts-container,#rm_ad_text,#ros_ad,#rotatingads,#row2AdContainer,#rr_MSads,#rt-ad,#rt-ad-top,#rt-ad468,#rtMod_ad,#rtmod_ad,#sAdsBox,#sb-ad-sq,#sb_advert,#sb_sponsors,#search-google-ads,#search-sponsored-links,#search-sponsored-links-top,#searchAdSenseBox,#searchAdSenseBoxAd,#searchAdSkyscraperBox,#search_ads,#search_result_ad,#second-adlayer,#secondBoxAdContainer,#secondrowads,#section-ad-1-728,#section-ad-300-250,#section-ad-4-160,#section-blog-ad,#section-container-ddc_ads,#section-sponsors,#section_advertorial_feature,#servfail-ads,#sew-ad1,#shoppingads,#show-ad,#showAd,#showad,#side-ad,#side-ad-container,#sideAd,#sideAdSub,#sideBarAd,#side_ad,#side_ad_wrapper,#side_ads_by_google,#side_sky_ad,#sidead,#sideads,#sidebar-125x125-ads,#sidebar-125x125-ads-below-index,#sidebar-ad,#sidebar-ad-boxes,#sidebar-ad-space,#sidebar-ad-wrap,#sidebar-ad3,#sidebar2ads,#sidebar_ad,#sidebar_ad_widget,#sidebar_ads_180,#sidebar_sponsoredresult_body,#sidebarad,#sidebaradver_advertistxt,#sideline-ad,#single-mpu,#singlead,#site-leaderboard-ads,#site_top_ad,#sitead,#sky-ad,#skyAd,#skyAdContainer,#skyScrapperAd,#skyWrapperAds,#sky_ad,#sky_advert,#skyads,#skyadwrap,#skyline_ad,#skyscraper-ad,#skyscraperAd,#skyscraperAdContainer,#skyscraper_ad,#skyscraper_advert,#skyscraperad,#slide_ad,#sliderAdHolder,#slideshow_ad_300x250,#sm-banner-ad,#small_ad,#small_ads,#smallerAd,#some-ads,#some-more-ads,#specialadvertisingreport_container,#specials_ads,#speeds_ads,#speeds_ads_fstitem,#speedtest_mrec_ad,#sphereAd,#sponLinkDiv_1,#sponlink,#sponlinks,#sponsAds,#sponsLinks,#spons_left,#sponseredlinks,#sponsor-search,#sponsorAd1,#sponsorAd2,#sponsorAdDiv,#sponsorLinks,#sponsorTextLink,#sponsor_banderole,#sponsor_box,#sponsor_deals,#sponsor_panSponsor,#sponsor_recommendations,#sponsorbar,#sponsorbox,#sponsored-ads,#sponsored-features,#sponsored-links,#sponsored-resources,#sponsored1,#sponsoredBox1,#sponsoredBox2,#sponsoredLinks,#sponsoredList,#sponsoredResults,#sponsoredResultsWide,#sponsoredSiteMainline,#sponsoredSiteSidebar,#sponsored_ads_v4,#sponsored_content,#sponsored_game_row_listing,#sponsored_links,#sponsored_v12,#sponsoredads,#sponsoredlinks,#sponsoredlinks_cntr,#sponsoredlinkslabel,#sponsoredresults_top,#sponsoredwellcontainerbottom,#sponsoredwellcontainertop,#sponsorfull,#sponsoring_bar,#sponsorlink,#sponsors,#sponsors_top_container,#sponsorshipBadge,#spotlightAds,#spotlightad,#sqAd,#square-sponsors,#squareAd,#squareAdSpace,#squareAds,#square_ad,#start_middle_container_advertisment,#sticky-ad,#stickyBottomAd,#story-90-728-area,#story-ad-a,#story-ad-b,#story-leaderboard-ad,#story-sponsoredlinks,#storyAd,#storyAdWrap,#storyad2,#subpage-ad-right,#subpage-ad-top,#swads,#synch-ad,#systemad_background,#tabAdvertising,#takeoverad,#tblAd,#tbl_googlead,#tcwAd,#td-GblHdrAds,#template_ad_leaderboard,#tertiary_advertising,#text-ad,#text-ads,#text-link-ads,#textAd,#textAds,#text_ad,#text_ads,#text_advert,#textad,#textad3,#the-last-ad-standing,#thefooterad,#themis-ads,#tile-ad,#tmglBannerAd,#toolbarSlideUpAd,#top-ad,#top-ad-container,#top-ad-menu,#top-ads,#top-ads-tabs,#top-advertisement,#top-banner-ad,#top-search-ad-wrapper,#topAd728x90,#topAdBanner,#topAdBox,#topAdContainer,#topAdSenseDiv,#topAdcontainer,#topAds,#topAdsContainer,#topAdvert,#topBannerAdContainer,#topNavLeaderboardAdHolder,#topRightBlockAdSense,#top_ad_area,#top_ad_banner,#top_ad_game,#top_ad_unit,#top_ad_wrapper,#top_ad_zone,#top_ads,#top_advertise,#top_advertising,#top_rectangle_ad,#top_right_ad,#top_wide_ad,#topad_left,#topad_right,#topadbar,#topadblock,#topaddwide,#topadsense,#topadspace,#topadzone,#topbanner_ad,#topbar-ad,#topcustomad,#topleaderboardad,#topnav-ad-shell,#toprightAdvert,#toprightad,#topsponsored,#toptextad,#tour300Ad,#tourSponsoredLinksContainer,#towerad,#ts-ad_module,#ttp_ad_slot1,#ttp_ad_slot2,#twogamesAd,#txt_link_ads,#undergameAd,#upperAdvertisementImg,#upperMpu,#upperad,#urban_contentad_1,#urban_contentad_2,#urban_contentad_article,#v_ad,#vert_ad,#vert_ad_placeholder,#vertical_ad,#vertical_ads,#videoAd,#video_cnv_ad,#video_overlay_ad,#videoadlogo,#viewportAds,#viewvid_ad300x250,#walltopad,#weblink_ads_container,#welcomeAdsContainer,#welcome_ad_mrec,#welcome_advertisement,#wf_ContentAd,#wf_FrontSingleAd,#wf_SingleAd,#wf_bottomContentAd,#wgtAd,#whatsnews_top_ad,#whitepaper-ad,#whoisRightAdContainer,#wide_ad_unit_top,#widget_advertisement,#wrapAdRight,#wrapAdTop,#wrapperAdsTopLeft,#wrapperAdsTopRight,#y-ad-units,#y708-ad-expedia,#y708-ad-lrec,#y708-ad-partners,#y708-ad-ysm,#y708-advertorial-marketplace,#yahoo-ads,#yahoo-sponsors,#yahooSponsored,#yahoo_ads,#yahoo_ads_2010,#yahoo_text_ad,#yahooad-tbl,#yan-sponsored,#yatadsky,#ybf-ads,#yfi_fp_ad_mort,#yfi_fp_ad_nns,#yfi_pf_ad_mort,#ygrp-sponsored-links,#ymap_adbanner,#yn-gmy-ad-lrec,#yreSponsoredLinks,#ysm_ad_iframe,#zoneAdserverMrec,#zoneAdserverSuper,.ADBAR,.ADPod,.AD_ALBUM_ITEMLIST,.AD_MOVIE_ITEM,.AD_MOVIE_ITEMLIST,.AD_MOVIE_ITEMROW,.Ad-Header,.Ad-MPU,.Ad1,.Ad120x600,.Ad160x600,.Ad160x600left,.Ad160x600right,.Ad2,.Ad247x90,.Ad300x,.Ad300x250,.Ad300x250L,.Ad728x90,.AdBorder,.AdBox7,.AdContainerBox308,.AdHeader,.AdHere,.AdMedium,.AdPlaceHolder,.AdRingtone,.AdSenseLeft,.AdSlot,.AdSpace,.AdTextSmallFont,.AdUnit,.AdUnit300,.Ad_C,.Ad_D_Wrapper,.Ad_E_Wrapper,.Ad_Right,.AdsBoxBottom,.AdsBoxSection,.AdsBoxTop,.AdsLinks1,.AdsLinks2,.AdsRec,.AdvertMidPage,.AdvertiseWithUs,.AdvertisementTextTag,.ArticleAd,.ArticleInlineAd,.BannerAd,.BigBoxAd,.BlockAd,.BottomAdContainer,.BottomAffiliate,.BoxAd,.CG_adkit_leaderboard,.CG_details_ad_dropzone,.CWReviewsProdInfoAd,.ComAread,.CommentAd,.ContentAd,.ContentAds,.DAWRadvertisement,.DeptAd,.DisplayAd,.FT_Ad,.FlatAds,.GOOGLE_AD,.GoogleAd,.GoogleAdSenseBottomModule,.GoogleAdSenseRightModule,.HPG_Ad_B,.HPNewAdsBannerDiv,.HPRoundedAd,.HomeContentAd,.IABAdSpace,.IndexRightAd,.LazyLoadAd,.LeftAd,.LeftButtonAdSlot,.LeftTowerAd,.M2Advertisement,.MD_adZone,.MOS-ad-hack,.MPU,.MPUHolder,.MPUTitleWrapperClass,.MREC_ads,.MiddleAd,.MiddleAdContainer,.NewsAds,.OAS,.OpaqueAdBanner,.OpenXad,.PU_DoubleClickAdsContent,.Post5ad,.Post9ad,.RBboxAd,.RW_ad300,.RectangleAd,.RelatedAds,.Right300x250AD,.RightAd1,.RightAdvertiseArea,.RightGoogleAFC,.RightRailTop300x250Ad,.RightSponsoredAdTitle,.RightTowerAd,.STR_AdBlock,.SideAdCol,.SidebarAd,.SidebarAdvert,.SitesGoogleAdsModule,.SkyAdContainer,.SponsorCFrame,.SponsoredAdTitle,.SponsoredContent,.SponsoredLinkItemTD,.SponsoredLinks,.SponsoredLinksGrayBox,.SponsoredLinksModule,.SponsoredLinksPadding,.SponsorshipText,.SquareAd,.StandardAdLeft,.StandardAdRight,.TRU-onsite-ads-leaderboard,.TextAd,.TheEagleGoogleAdSense300x250,.TopAd,.TopAdContainer,.TopAdL,.TopAdR,.TopBannerAd,.UIWashFrame_SidebarAds,.UnderAd,.VerticalAd,.Video-Ad,.VideoAd,.WidgetAdvertiser,.a160x600,.a728x90,.ad-120x600,.ad-160,.ad-160x600 { visibility:hidden !important; display:none !important; } .ad-250,.ad-300,.ad-300-block,.ad-300-blog,.ad-300x100,.ad-300x250,.ad-300x250-right0,.ad-350,.ad-355x75,.ad-600,.ad-635x40,.ad-728,.ad-728x90,.ad-728x90-1,.ad-728x90_forum,.ad-90x600,.ad-above-header,.ad-adlink-bottom,.ad-adlink-side,.ad-area,.ad-background,.ad-banner,.ad-bigsize,.ad-block,.ad-blog2biz,.ad-body,.ad-bottom,.ad-break,.ad-btn,.ad-btn-heading,.ad-cell,.ad-container-300x250,.ad-container-728x90,.ad-context,.ad-disclaimer,.ad-div,.ad-enabled,.ad-feedback,.ad-filler,.ad-flex,.ad-footer,.ad-footer-leaderboard,.ad-google,.ad-graphic-large,.ad-gray,.ad-hdr,.ad-head,.ad-header,.ad-heading,.ad-homeleaderboard,.ad-img,.ad-in-post,.ad-index-main,.ad-island,.ad-label,.ad-leaderboard,.ad-links,.ad-lrec,.ad-medium,.ad-medium-two,.ad-mpu,.ad-msn,.ad-note,.ad-notice,.ad-other,.ad-permalink,.ad-placeholder,.ad-postText,.ad-poster,.ad-priority,.ad-rect,.ad-rectangle,.ad-rectangle-text,.ad-related,.ad-rh,.ad-ri,.ad-right,.ad-right-header,.ad-right-txt,.ad-row,.ad-section,.ad-show-label,.ad-side,.ad-sidebar-outer,.ad-sidebar300,.ad-sky,.ad-slot,.ad-slot-234-60,.ad-slot-300-250,.ad-slot-728-90,.ad-space,.ad-space-mpu-box,.ad-spot,.ad-square300,.ad-squares,.ad-statement,.ad-story-inject,.ad-tabs,.ad-text-links,.ad-tile,.ad-title,.ad-top,.ad-top-left,.ad-unit,.ad-unit-300,.ad-unit-300-wrapper,.ad-unit-anchor,.ad-vert,.ad-vtu,.ad-wrap,.ad-wrapper,.ad-zone-s-q-l,.ad.super,.ad0,.ad10,.ad120,.ad120x240backgroundGray,.ad120x600,.ad125,.ad140,.ad160,.ad160x600,.ad160x600GrayBorder,.ad18,.ad19,.ad21,.ad230,.ad250,.ad250c,.ad3,.ad300,.ad300250,.ad300_250,.ad300x100,.ad300x250,.ad300x250-hp-features,.ad300x250Top,.ad300x250_container,.ad300x250box,.ad300x50-right,.ad300x600,.ad310,.ad336x280,.ad343x290,.ad4,.ad400right,.ad450,.ad468_60,.ad468x60,.ad6,.ad620x70,.ad626X35,.ad7,.ad728,.ad728_90,.ad728x90,.ad728x90_container,.ad8,.ad90x780,.adAgate,.adArea674x60,.adBanner,.adBanner300x250,.adBanner728x90,.adBannerTyp1,.adBannerTypSortableList,.adBannerTypW300,.adBar,.adBgBottom,.adBgMId,.adBgTop,.adBlock,.adBottomboxright,.adBoxBody,.adBoxBorder,.adBoxContainer,.adBoxContent,.adBoxInBignews,.adBoxSidebar,.adBoxSingle,.adBwrap,.adCMRight,.adCell,.adColumn,.adCont,.adContTop,.adContour,.adCreative,.adCube,.adFender3,.adFrame,.adFtr,.adFullWidthMiddle,.adGoogle,.adHeader,.adHeadline,.adHome300x250,.adHorisontal,.adInNews,.adLabel,.adLeader,.adLeaderForum,.adLeaderboard,.adLeft,.adLoaded,.adLocal,.adMarker,.adMastheadLeft,.adMastheadRight,.adMegaBoard,.adMkt2Colw,.adModuleAd,.adMpu,.adNewsChannel,.adNoOutline,.adNotice,.adNoticeOut,.adObj,.adPageBorderL,.adPageBorderR,.adPanel,.adRect,.adRight,.adSelfServiceAdvertiseLink,.adServer,.adSky600,.adSkyscraperHolder,.adSlot,.adSpBelow,.adSpacer,.adSplash,.adSponsor,.adSpot,.adSpot-searchAd,.adSpot-textBox,.adSpot-twin,.adSpotIsland,.adSquare,.adSubColPod,.adSuperboard,.adSupertower,.adTD,.adTab,.adTag,.adTileWrap,.adTiler,.adTopboxright,.adTout,.adTxt,.adUnit,.adUnitHorz,.adUnitVert,.adUnitVert_noImage,.adWebBoard,.adWidget,.adWithTab,.adWrap,.adWrapper,.ad_0,.ad_1,.ad_120x90,.ad_125,.ad_130x90,.ad_160,.ad_160x600,.ad_2,.ad_200,.ad_200x200,.ad_250x250,.ad_250x250_w,.ad_3,.ad_300,.ad_300_250,.ad_300x250,.ad_300x250_box_right,.ad_336,.ad_336x280,.ad_350x100,.ad_350x250,.ad_400x200,.ad_468,.ad_468x60,.ad_600,.ad_728,.ad_728x90,.ad_Left,.ad_amazon,.ad_banner,.ad_banner_border,.ad_bar,.ad_bg,.ad_bigbox,.ad_biz,.ad_block,.ad_block_338,.ad_body,.ad_border,.ad_botbanner,.ad_bottom_leaderboard,.ad_bottom_left,.ad_box,.ad_box2,.ad_box_ad,.ad_box_div,.ad_callout,.ad_caption,.ad_column,.ad_column_box,.ad_column_hl,.ad_contain,.ad_container,.ad_content,.ad_content_wide,.ad_contents,.ad_descriptor,.ad_disclaimer,.ad_eyebrow,.ad_footer,.ad_frame,.ad_framed,.ad_front_promo,.ad_head,.ad_headline,.ad_hpm,.ad_info_block,.ad_inline,.ad_island,.ad_label,.ad_launchpad,.ad_leader,.ad_leaderboard,.ad_left,.ad_line,.ad_link,.ad_linkunit,.ad_loc,.ad_lrec,.ad_main,.ad_medrec,.ad_medrect,.ad_middle,.ad_mpu,.ad_mr,.ad_mrec,.ad_mrec_title_article,.ad_mrect,.ad_news,.ad_notice,.ad_one,.ad_p360,.ad_partner,.ad_partners,.ad_plus,.ad_post,.ad_power,.ad_promo,.ad_rectangle,.ad_right_col,.ad_row,.ad_sidebar,.ad_skyscraper,.ad_slug,.ad_slug_table,.ad_space_300_250,.ad_sponsor,.ad_sponsoredsection,.ad_spot_b,.ad_spot_c,.ad_square_r,.ad_square_top,.ad_tag_middle,.ad_text_w,.ad_title,.ad_top,.ad_top_leaderboard,.ad_top_left,.ad_topright,.ad_tower,.ad_unit,.ad_unit_rail,.ad_url,.ad_warning,.ad_wid300,.ad_wide,.ad_wrap,.ad_wrapper,.ad_wrapper_fixed,.ad_wrapper_top,.ad_zone,.adarea,.adarea-long,.adbanner,.adbannerbox,.adbannerright,.adbar,.adboard,.adborder,.adbot,.adbottom,.adbottomright,.adbox-outer,.adbox-wrapper,.adbox_300x600,.adbox_366x280,.adbox_468X60,.adbox_bottom,.adboxclass,.adbreak,.adbug,.adbuttons,.adcode,.adcolumn,.adcolumn_wrapper,.adcopy,.add_300x250,.adfieldbg,.adfoot,.adfootbox,.adhead,.adhead_h,.adhead_h_wide,.adheader,.adheader100,.adhere,.adhered,.adhi,.adhint,.adhoriz,.adi,.adiframe,.adinside,.adintro,.adjlink,.adkicker,.adkit,.adkit-advert,.adkit-lb-footer,.adlabel-horz,.adlabel-vert,.adleader,.adleaderboard,.adleft1,.adline,.adlinks,.adlnklst,.admarker,.admedrec,.admessage,.admodule,.admpu,.admpu-small,.adnation-banner,.adnotice,.adops,.adp-AdPrefix,.adpadding,.adpane,.adprice,.adproxy,.adroot,.adrotate_widget,.adrow,.adrow-post,.adrule,.ads-125,.ads-728x90-wrap,.ads-banner,.ads-below-content,.ads-categories-bsa,.ads-favicon,.ads-links-general,.ads-mpu,.ads-outer,.ads-profile,.ads-right,.ads-sidebar,.ads-sky,.ads-stripe,.ads-text,.ads-top,.ads-widget,.ads-widget-partner-gallery,.ads160,.ads1_250,.ads2,.ads3,.ads300,.ads460,.ads460_home,.ads468,.ads728,.ads728x90,.adsArea,.adsBelowHeadingNormal,.adsBox,.adsCell,.adsCont,.adsDiv,.adsFull,.adsImages,.adsMPU,.adsRight,.adsTextHouse,.adsTop,.adsTower2,.adsTowerWrap,.adsWithUs,.ads_125_square,.ads_180,.ads_300,.ads_300x250,.ads_320,.ads_337x280,.ads_728x90,.ads_big,.ads_big-half,.ads_box,.ads_brace,.ads_catDiv,.ads_container,.ads_disc_anchor,.ads_disc_leader,.ads_disc_lwr_square,.ads_disc_skyscraper,.ads_disc_square,.ads_div,.ads_footer,.ads_header,.ads_leaderboard,.ads_medrect,.ads_mpu,.ads_outer,.ads_rectangle,.ads_right,.ads_sc_bl_i,.ads_sc_tl_i,.ads_show_if,.ads_side,.ads_sidebar,.ads_singlepost,.ads_spacer,.ads_takeover,.ads_title,.ads_top,.ads_top_promo,.ads_tr,.ads_verticalSpace,.ads_vtlLink,.ads_widesky,.ads_wrapperads_top,.adsbg300,.adsblockvert,.adsborder,.adsbottom,.adsbox,.adsboxitem,.adsbyyahoo,.adsc,.adscaleAdvert,.adsclick,.adscontainer,.adscreen,.adsd_shift100,.adsection_a2,.adsection_c2,.adsense-ad,.adsense-category,.adsense-category-bottom,.adsense-googleAds,.adsense-heading,.adsense-overlay,.adsense-post,.adsense-right,.adsense-title,.adsense3,.adsense300,.adsenseAds,.adsenseBlock,.adsenseContainer,.adsenseGreenBox,.adsenseList,.adsense_bdc_v2,.adsense_mpu,.adsensebig,.adsenseblock,.adsenseblock_bottom,.adsenseblock_top,.adsenselr,.adsensem_widget,.adsensesq,.adsenvelope,.adset,.adsforums,.adsghori,.adsgvert,.adside,.adsidebox,.adsider,.adsingle,.adsleft,.adslink,.adslogan,.adsmalltext,.adsmessage,.adsnippet_widget,.adspace-MR,.adspace-widget,.adspace180,.adspace_bottom,.adspace_buysell,.adspace_rotate,.adspace_skyscraper,.adspacer,.adspot,.adspot728x90,.adstextpad,.adstitle,.adstop,.adstory,.adstrip,.adtag,.adtech,.adtext_gray,.adtext_horizontal,.adtext_onwhite,.adtext_vertical,.adtile,.adtips,.adtips1,.adtop,.adtravel,.adtxt,.adtxtlinks,.adunit,.adv-mpu,.adver,.adverTag,.adver_cont_below,.advert-728x90,.advert-article-bottom,.advert-bannerad,.advert-box,.advert-head,.advert-iab-300-250,.advert-iab-468-60,.advert-mpu,.advert-skyscraper,.advert-text,.advert-txt,.advert300,.advert300x250,.advert4,.advert5,.advert8,.advertColumn,.advertCont,.advertContainer,.advertHeadline,.advertRight,.advertText,.advertTitleSky,.advert_468x60,.advert_box,.advert_cont,.advert_djad,.advert_label,.advert_leaderboard,.advert_note,.advert_surr,.advert_top,.advertheader-red,.advertise-here,.advertise-homestrip,.advertise-horz,.advertise-leaderboard,.advertise-top,.advertise-vert,.advertiseContainer,.advertiseText,.advertise_ads,.advertise_here,.advertise_link,.advertise_link_sidebar,.advertisement-728x90,.advertisement-block,.advertisement-sidebar,.advertisement-space,.advertisement-sponsor,.advertisement-text,.advertisement-top,.advertisement468,.advertisementBox,.advertisementColumnGroup,.advertisementContainer,.advertisementHeader,.advertisementLabel,.advertisementPanel,.advertisement_btm,.advertisement_caption,.advertisement_g,.advertisement_header,.advertisement_horizontal,.advertisement_top,.advertiser-links,.advertisespace_div,.advertising-banner,.advertising-header,.advertising-local-links,.advertising2,.advertisingTable,.advertising_images,.advertisment_two,.advertize,.advertorial,.advertorial-2,.advertorial-promo-box,.advertorialtitle,.advt,.advt-banner-3,.advt-block,.advt-sec,.advt300,.advt720,.adwordListings,.adwords,.adwordsHeader,.adwrap,.adwrapper-lrec,.adwrapper948,.adzone-footer,.adzone-sidebar,.affiliate-link,.affiliate-sidebar,.affiliateAdvertText,.affinityAdHeader,.afsAdvertising,.after_ad,.agi-adsaleslinks,.alb-content-ad,.alignads,.alt_ad,.anchorAd,.another_text_ad,.answer_ad_content,.aolSponsoredLinks,.aopsadvert,.apiAdMarkerAbove,.apiAds,.archive-ads,.art_ads,.article-ads,.articleAd,.articleAds,.articleAdsL,.articleEmbeddedAdBox,.article_ad,.article_adbox,.article_mpu_box,.articleads,.aseadn,.aux-ad-widget-1,.aux-ad-widget-2,.b-astro-sponsored-links_horizontal,.b-astro-sponsored-links_vertical,.banner-ad,.banner-ads,.banner-adverts,.banner300x100,.banner300x250,.banner468,.bannerAd,.bannerAdWrapper300x250,.bannerAdWrapper730x86,.bannerRightAd,.banner_300x250,.banner_ad,.banner_ad_footer,.banner_ad_leaderboard,.bannerad,.barkerAd,.base-ad-mpu,.base_ad,.base_printer_widgets_AdBreak,.bg-ad-link,.bgnavad,.big-ads,.bigAd,.big_ad,.big_ads,.bigad,.bigad2,.bigbox_ad,.bigboxad,.billboard_ad,.blk_advert,.block-ad,.block-ad300,.block-admanager,.block-ads-bottom,.block-ads-top,.block-adsense,.block-openads,.block-openadstream,.block-openx,.block-thirdage-ads,.block-wtg_adtech,.blockAd,.blockAds,.block_ad_sb_text,.block_ad_sponsored_links,.block_ad_sponsored_links-wrapper,.blockad,.blocked-ads,.blocsponsor,.blog-ad-leader-inner,.blog-ads-container,.blogAd,.blogAdvertisement,.blogArtAd,.blogBigAd,.blog_ad,.blogads,.blox3featuredAd,.body_ad,.body_sponsoredresults_bottom,.body_sponsoredresults_middle,.body_sponsoredresults_top,.bookseller-header-advt,.bottom-ad,.bottomAd,.bottomAds,.bottom_ad,.bottom_adsense,.bottom_sponsor,.bottomad,.bottomadvert,.bottomrightrailAd,.bottomvidad,.box-ad,.box-ad-grey,.box-ads,.box-adsense,.boxAd,.boxAds,.box_ad,.box_ad_container,.box_ad_content,.box_ad_spacer,.box_ads,.box_advertising,.box_advertisment_62_border,.box_content_ad,.box_content_ads,.boxad,.boxyads,.bps-ad-wrapper,.bps-advertisement,.bps-advertisement-inline-ads,.br-ad,.breakad_container,.brokerad,.bsa_ads,.btm_ad,.btn-ad,.bullet-sponsored-links,.bullet-sponsored-links-gray,.burstContentAdIndex,.busrep_poll_and_ad_container,.buttonAd,.buttonAds,.buttonadbox,.bx_ad,.bx_ad_right,.cA-adStrap,.cColumn-TextAdsBox,.calloutAd,.care2_adspace,.catalog_ads,.category-ad,.category__big_game_container_body_games_advertising,.cb-ad-container,.cb_ads,.cb_footer_sponsor,.cb_navigation_ad,.cbstv_ad_label,.cbzadvert,.cbzadvert_block,.cdAdTitle,.cdmainlineSearchAdParent,.cdsidebarSearchAdParent,.centerAd,.center_ad,.centerad,.centered-ad,.cinemabotad,.classifiedAdThree,.clearerad,.cm_ads,.cms-Advert,.cnbc_badge_banner_ad_area,.cnbc_banner_ad_area,.cnn160AdFooter,.cnnAd,.cnnMosaic160Container,.cnnSearchSponsorBox,.cnnStoreAd,.cnnStoryElementBoxAd,.cnnWCAdBox,.cnnWireAdLtgBox,.cnn_728adbin,.cnn_adcntr300x100,.cnn_adcntr728x90,.cnn_adspc336cntr,.cnn_adtitle,.column2-ad,.columnRightAdvert,.com-ad-server,.comment-advertisement,.comment_ad_box,.common_advertisement_title,.communityAd,.conTSponsored,.conductor_ad,.confirm_ad_left,.confirm_ad_right,.confirm_leader_ad,.consoleAd,.container-adwords,.containerSqAd,.container_serendipity_plugin_google_adsense,.content-ad,.contentAdFoot,.contentAdsWrapper,.content_ad,.content_ad_728,.content_adsq,.contentad300x250,.contentad_right_col,.contentadcontainer,.contentadleft,.contentads,.contenttextad,.contest_ad,.cp_ad,.cpmstarHeadline,.cpmstarText,.create_ad,.cs-mpu,.cscTextAd,.cse_ads,.cspAd,.ct_ad,.cube-ad,.cubeAd,.cube_ads,.currency_ad,.custom_ads,.cwAdvert,.darla_ad,.dartAdImage,.dart_ad,.dart_tag,.dartadvert,.dartiframe,.dc-ad,.dcAdvertHeader,.deckAd,.deckads,.detailMpu,.detail_ad,.detail_top_advert,.divAd,.divAdright,.divad1,.divad2,.divad3,.divads,.divider_ad,.dmco_advert_iabrighttitle,.downloadAds,.download_ad,.downloadad,.dualAds,.dynamic-ads,.dynamic_ad,.e-ad,.ec-ads,.ec-ads-remove-if-empty,.em-ad,.embed-ad,.entry-body-ad,.entry_sidebar_ads,.entryad,.ez-clientAd,.f_Ads,.feature_ad,.featuredAds,.featuredadvertising,.firstpost_advert_container,.flagads { visibility:hidden !important; display:none !important; } .flash-advertisement,.flash_ad,.flash_advert,.flashad,.flexiad,.flipbook_v2_sponsor_ad,.floatad,.floated_right_ad,.floatingAds,.fm-badge-ad,.footad,.footer-ad,.footerAd,.footerAdModule,.footerAdslot,.footerTextAd,.footer_ad,.footer_ads,.footer_block_ad,.footer_bottomad,.footer_line_ad,.footer_text_ad,.footerad,.forumtopad,.frn_adbox,.frn_cont_adbox,.frontads,.ft-ad,.ftdAdBar,.ftdContentAd,.full_ad_box,.fullbannerad,.g3rtn-ad-site,.gAdRows,.gAdSky,.gAdvertising,.g_ggl_ad,.ga-ads,.ga-textads-bottom,.ga-textads-top,.gaTeaserAdsBox,.gads,.gads_cb,.gads_container,.gallery_ad,.gam_ad_slot,.gameAd,.gamesPage_ad_content,.gbl_advertisement,.gen_side_ad,.gglAds,.global_banner_ad,.googad,.googads,.google-ad,.google-ad-container,.google-ads,.google-ads-boxout,.google-ads-slim,.google-right-ad,.google-sponsored-ads,.google-sponsored-link,.google468,.google468_60,.googleAd,.googleAd-content,.googleAd-list,.googleAd300x250_wrapper,.googleAdBox,.googleAdSense,.googleAdSenseModule,.googleAd_body,.googleAds,.googleAds_article_page_above_comments,.googleAdsense,.googleContentAds,.googleProfileAd,.googleSearchAd_content,.googleSearchAd_sidebar,.google_ad,.google_ad_wide,.google_add_container,.google_ads,.google_ads_bom_title,.google_ads_content,.googlead,.googleaddiv,.googleaddiv2,.googleads,.googleads_300x250,.googleads_title,.googleafc,.googley_ads,.gpAdBox,.gpAds,.gradientAd,.grey-ad-line,.group_ad,.gsAd,.gsfAd,.gt_ad,.gt_ad_300x250,.gt_ad_728x90,.gt_adlabel,.gutter-ad-left,.gutter-ad-right,.h-ad-728x90-bottom,.h_Ads,.h_ad,.half-ad,.half_ad_box,.hcf-ad-rectangle,.hcf-cms-ad,.hd_advert,.hdr-ads,.header-advert,.headerAds,.headerAdvert,.headerTextAd,.header_ad,.header_ad_div,.header_advertisment,.headerad,.headerad-720,.hi5-ad,.highlightsAd,.hm_advertisment,.hn-ads,.home-ad-links,.homeAd,.homeAd1,.homeAd2,.homeAdBoxA,.homeAdBoxBetweenBlocks,.homeAdBoxInBignews,.homeAdSection,.homeMediumAdGroup,.home_ad_bottom,.home_advertisement,.home_mrec_ad,.homead,.homepage-ad,.homepage300ad,.homepageFlexAdOuter,.homepageMPU,.homepage_middle_right_ad,.hor_ad,.horiz_adspace,.horizontalAd,.horizontal_ads,.horizontaltextadbox,.horizsponsoredlinks,.hortad,.houseAd1,.houseAdsStyle,.housead,.hp-col4-ads,.hp2-adtag,.hp_ad_cont,.hp_ad_text,.hp_t_ad,.hp_w_ad,.hpa-ad1,.html-advertisement,.ic-ads,.ico-adv,.idMultiAd,.image-advertisement,.imageads,.imgad,.in-page-ad,.in-story-ads,.in-story-text-ad,.indEntrySquareAd,.indie-sidead,.indy_googleads,.inhousead,.inline-ad,.inline-mpu,.inline-mpu-left,.inlineSideAd,.inline_ad,.inline_ad_title,.inlinead,.inlineadsense,.inlineadtitle,.inlist-ad,.inlistAd,.inner-advt-banner-3,.innerAds,.innerad,.inpostad,.insert_advertisement,.insertad,.insideStoryAd,.inteliusAd_image,.interest-based-ad,.internalAdsContainer,.is24-adplace,.isAd,.islandAd,.islandAdvert,.islandad,.jimdoAdDisclaimer,.jp-advertisment-promotional,.js-advert,.kw_advert,.kw_advert_pair,.l_ad_sub,.l_banner.ads_show_if,.labelads,.largeRecAdNewsContainerRight,.largeRectangleAd,.largeUnitAd,.lastRowAd,.lcontentbox_ad,.leaderAdTop,.leaderAdvert,.leader_ad,.leaderboardAd,.leaderboardad,.leaderboardadtop,.left-ad,.leftAd,.leftAdColumn,.leftAds,.left_ad,.left_ad_box,.left_adlink,.left_ads,.left_adsense,.leftad,.leftadtag,.leftbar_ad_160_600,.leftbarads,.leftbottomads,.leftnavad,.lgRecAd,.lg_ad,.ligatus,.linead,.link_adslider,.link_advertise,.live-search-list-ad-container,.ljad,.local-ads,.log_ads,.logoAds,.logoad,.logoutAd,.longAd,.lowerAds,.m-ad-tvguide-box,.m4-adsbygoogle,.m_banner_ads,.macAd,.macad,.main-ad,.main-advert,.main-tabs-ad-block,.main_ad,.main_ad_bg_div,.main_adbox,.main_intro_ad,.map_media_banner_ad,.marginadsthin,.marketing-ad,.masthead_topad,.matador_sidebar_ad_600,.mdl-ad,.media-advert,.mediaAd,.mediaAdContainer,.mediaResult_sponsoredSearch,.medium-rectangle-ad,.mediumRectangleAdvert,.medrect_ad,.menuItemBannerAd,.menueadimg,.messageBoardAd,.mf-ad300-container,.micro_ad,.mid_ad,.midad,.middleAds,.middleads,.min_navi_ad,.mini-ad,.miniad,.mmcAd_Iframe,.mobile-sponsoring,.mod-ad-lrec,.mod-ad-n,.mod-adopenx,.mod-vertical-ad,.mod_admodule,.module-ad-small,.module-ads,.moduleAdvertContent,.module_ad,.module_box_ad,.modulegad,.moduletable-advert,.moduletable-googleads,.moduletablesquaread,.mpu-ad,.mpu-advert,.mpu-footer,.mpu-fp,.mpu-title,.mpu-top-left,.mpu-top-left-banner,.mpu-top-right,.mpuAd,.mpuAdSlot,.mpuAdvert,.mpuArea,.mpuBox,.mpuContainer,.mpuHolder,.mpuTextAd,.mpu_ad,.mpu_advert,.mpu_container,.mpu_gold,.mpu_holder,.mpu_platinum,.mpu_side,.mpu_text_ad,.mpuad,.mpuholderportalpage,.mrec_advert,.ms-ads-link,.msfg-shopping-mpu,.mwaads,.my-ad250x300,.nSponsoredLcContent,.nSponsoredLcTopic,.nadvt300,.narrow_ad_unit,.narrow_ads,.navAdsBanner,.navBads,.navadbox,.navi_ad300,.naviad,.nba300Ad,.nbaT3Ad160,.nbaTVPodAd,.nbaTwo130Ads,.nbc_ad_carousel_wrp,.newTopAdContainer,.newad,.newsAd,.news_article_ad_google,.newsviewAdBoxInNews,.nf-adbox,.nn-mpu,.noAdForLead,.normalAds,.nrAds,.nsAdRow,.oas-ad,.oas-bottom-ads,.offer_sponsoredlinks,.oio-banner-zone,.oio-link-sidebar,.oio-zone-position,.on_single_ad_box,.onethirdadholder,.openads,.openadstext_after,.openx,.openx-ad,.osan-ads,.other_adv2,.outermainadtd1,.ovAdPromo,.ovAdSky,.ovAdartikel,.ov_spns,.pageGoogleAd,.pageGoogleAdFlat,.pageLeaderAd,.page_content_right_ad,.pagead,.pagenavindexcontentad,.paneladvert,.partner-ads-container,.partnersTextLinks,.pencil_ad,.player_ad_box,.player_hover_ad,.player_page_ad_box,.plista_inimg_box,.pnp_ad,.pod-ad-300,.podRelatedAdLinksWidget,.podSponsoredLink,.portalCenterContentAdBottom,.portalCenterContentAdMiddle,.portalCenterContentAdTop,.portalcontentad,.postAd,.post_ad,.post_ads,.post_sponsor_unit,.postbit_adbit_register,.postbit_adcode,.postgroup-ads,.postgroup-ads-middle,.prebodyads,.premium_ad_container,.promoAd,.promoAds,.promo_ad,.ps-ligatus_placeholder,.publication-ad,.publicidad,.puff-advertorials,.qa_ad_left,.qm-ad-content,.qm-ad-content-news,.quigo-ad,.qzvAdDiv,.r_ad_1,.r_ad_box,.r_ads,.rad_container,.rect_ad_module,.rectad,.rectangle-ad,.rectangleAd,.rectanglead,.redads_cont,.regular_728_ad,.regularad,.relatedAds,.related_post_google_ad,.remads,.resourceImagetAd,.result_ad,.results_sponsor,.results_sponsor_right,.reviewMidAdvertAlign,.rght300x250,.rhads,.rhs-ad,.rhs-ads-panel,.right-ad,.right-ad-holder,.right-ad2,.right-ads,.right-ads2,.right-sidebar-box-ad,.rightAdBox,.rightColAd,.rightColumnRectAd,.rightRailAd,.right_ad,.right_ad_160,.right_ad_box,.right_ad_text,.right_ad_top,.right_ads,.right_col_ad,.right_hand_advert_column,.right_side-partyad,.rightad_1,.rightad_2,.rightadbox1,.rightads,.rightadunit,.rightcol_boxad,.rightcoladvert,.rightcoltowerad,.rnav_ad,.rngtAd,.roundedCornersAd,.roundingrayboxads,.rt_ad1_300x90,.rt_ad_300x250,.rt_ad_call,.s2k_ad,.savvyad_unit,.sb-ad-sq-bg,.sbAd,.sbAdUnitContainer,.sb_adsN,.sb_adsNv2,.sb_adsW,.sb_adsWv2,.scanAd,.scc_advert,.sci-ad-main,.sci-ad-sub,.search-ad,.search-results-ad,.search-sponsor,.search-sponsored,.searchAd,.searchAds,.searchSponsoredResultsBox,.searchSponsoredResultsList,.search_column_results_sponsored,.search_results_sponsored_top,.section-ad2,.section-sponsor,.section_mpu_wrapper,.section_mpu_wrapper_wrapper,.selfServeAds,.sepContentAd,.serp_sponsored,.servsponserLinks,.shoppingGoogleAdSense,.showcaseAd,.sidbaread,.side-ad,.side-ads,.sideAd,.sideBoxAd,.side_ad,.side_ad2,.side_ad_1,.side_ad_2,.side_ad_3,.sidead,.sideads,.sideadsbox,.sideadvert,.sidebar-ad,.sidebar-ads,.sidebar-text-ad,.sidebarAd,.sidebarAdUnit,.sidebarAdvert,.sidebar_ad,.sidebar_ad_300_250,.sidebar_ads,.sidebar_ads_336,.sidebar_adsense,.sidebar_box_ad,.sidebarad,.sidebarad_bottom,.sidebaradbox,.sidebarboxad,.sideheadnarrowad,.sideheadsponsorsad,.singleAd,.singleAdsContainer,.singlead,.site_ad_120_600,.site_ad_300x250,.sitesponsor,.skinAd,.skin_ad_638,.sky-ad,.skyAd,.skyAdd,.skyAdvert,.sky_ad,.sky_scraper_ad,.skyad,.skyjobsadtext,.skyscraper-ad,.skyscraper_ad,.skyscraper_bannerAdHome,.sleekadbubble,.slideshow-ad,.slpBigSlimAdUnit,.slpSquareAdUnit,.sm_ad,.smallSkyAd1,.smallSkyAd2,.small_ad,.small_ads,.smallad-left,.smallads,.smallsponsorad,.smart_ads_bom_title,.specialAd175x90,.speedyads,.sphereAdContainer,.spl-ads,.spl_ad,.spl_ad2,.spl_ad_plus,.splitAd,.sponlinkbox,.spons-link,.spons_links,.sponslink,.sponsor-ad,.sponsor-bottom,.sponsor-link,.sponsor-links,.sponsor-right,.sponsor-services,.sponsor-top,.sponsorArea,.sponsorBox,.sponsorPanel,.sponsorPost,.sponsorPostWrap,.sponsorStrip,.sponsorTop,.sponsor_ad_area,.sponsor_footer,.sponsor_horizontal,.sponsor_line,.sponsor_links,.sponsor_logo,.sponsor_top,.sponsor_units,.sponsoradtitle,.sponsorbox,.sponsored-ads,.sponsored-chunk,.sponsored-editorial,.sponsored-features,.sponsored-links,.sponsored-links-alt-b,.sponsored-links-holder,.sponsored-links-right,.sponsored-post,.sponsored-post_ad,.sponsored-results,.sponsored-right-border,.sponsored-text,.sponsoredBox,.sponsoredInfo,.sponsoredInner,.sponsoredLabel,.sponsoredLinks,.sponsoredLinks2,.sponsoredLinksHeader,.sponsoredProduct,.sponsoredResults,.sponsoredSideInner,.sponsored_ads,.sponsored_box,.sponsored_box_search,.sponsored_by,.sponsored_links,.sponsored_links_title_container,.sponsored_links_title_container_top,.sponsored_links_top,.sponsored_results,.sponsored_well,.sponsoredibbox,.sponsoredlink,.sponsoredlinks,.sponsoredlinkscontainer,.sponsoredresults,.sponsoredtextlink_container_ovt,.sponsorlink,.sponsorlink2,.sponsormsg,.sponsors,.sponsors-box,.sponsors_bar,.sponsors_table,.sponsorshipbox,.sponsortable,.sponsortext,.spotlightAd,.squareAd,.square_ad,.square_banner_ad,.squared_ad,.ss-ad-mpu,.standard-ad,.start__newest__big_game_container_body_games_advertising,.staticAd,.stock-ticker-ad-tag,.stocks-ad-tag,.store-ads,.story_AD,.story_ad_div,.story_right_adv,.storyad,.storysponsorimage,.subad,.subcontent-ad,.subtitle-ad-container,.sugarad,.super-ad,.supercommentad_left,.supercommentad_right,.supp-ads,.supportAdItem,.surveyad,.t10ad,.tab_ad,.tab_ad_area,.tablebordersponsor,.tadsanzeige,.tadsbanner,.tadselement,.tallad,.tblTopAds,.tbl_ad,.tbox_ad,.td-Adholder,.teaser-sponsor,.teaserAdContainer,.teaser_adtiles,.text-ad-links,.text-advertisement,.text-g-advertisement,.text-g-group-short-rec-ad,.text-g-net-grp-google-ads-article-page,.textAd,.textAdBox,.textAds,.text_ad,.text_ads,.textad,.textadContainer,.textad_headline,.textadbox,.textadheadline,.textadlink,.textadsds,.textadsfoot,.textadtext,.textlink-ads,.tf_page_ad_search,.thisIsAd,.thisIsAnAd,.ticket-ad,.tileAds,.tips_advertisement,.title-ad,.title_adbig,.tncms-region-ads,.toolad,.toolbar-ad,.top-ad,.top-ad-space,.top-ads,.top-banner-ad,.top-menu-ads,.top-sponsors,.topAdWrap,.topAdvertisement,.topBannerAd,.topLeaderboardAd,.top_Ad,.top_ad,.top_ad_728,.top_ad_728_90,.top_ad_disclaimer,.top_ad_div,.top_ad_post,.top_ad_wrapper,.top_advert,.top_advertising_lb,.top_container_ad,.top_sponsor,.topad-bar,.topadbox,.topadspot,.topadvertisementsegment,.topcontentadvertisement,.topic_inad,.topstoriesad,.toptenAdBoxA,.tourFeatureAd,.towerAd,.towerAdLeft,.towerAds,.tower_ad,.tower_ad_disclaimer,.towerad,.tribal-ad,.ts-ad_unit_bigbox,.ts-banner_ad,.ttlAdsensel,.tto-sponsored-element,.tucadtext,.tvs-mpu,.twoColumnAd,.twoadcoll,.twoadcolr,.tx_smartadserver_pi1,.txt-ads,.txtAd,.txtAds,.txt_ads,.txtadvertise,.type_adscontainer,.type_miniad,.type_promoads,.ukAds,.undertimyads,.unit-ad,.universalboxADVBOX01,.universalboxADVBOX03,.universalboxADVBOX04a,.usenext,.vertad,.vertical-adsense,.videoAd,.videoBoxAd,.video_ad,.view-promo-mpu-right,.view_rig_ad,.virgin-mpu,.wa_adsbottom,.wantads,.wide-ad,.wide-skyscraper-ad,.wideAd,.wideAdTable,.wide_ad,.wide_ad_unit_top,.wide_ads,.wide_google_ads,.widget-ad,.widget-ad300x250,.widget-entry-ads-160,.widgetYahooAds,.widget_ad,.widget_ad_rotator,.widget_island_ad,.widget_sdac_bottom_ad_widget,.widget_sdac_footer_ads_widget,.widget_sdac_skyscraper_ad_widget,.widget_sponsor,.wikia-ad,.wikia_ad_placeholder,.wingadblock,.withAds,.wl-ad,.wnMultiAd,.wp125_write_ads_widget,.wp125ad,.wp125ad_2,.wpn_ad_content,.wrap-ads,.wsSponsoredLinksRight,.wsTopSposoredLinks,.x03-adunit,.x04-adunit,.xads-blk2,.xads-ojedn,.y-ads,.y-ads-wide,.y7-advertisement,.yahoo-sponsored,.yahoo-sponsored-links,.yahooAds,.yahoo_ads,.yan-sponsored,.ygrp-ad,.yrail_ad_wrap,.yrail_ads,.ysmsponsor,.ysponsor,.yw-ad,a[href^="http://ad.doubleclick.net/"],a[href^="http://adserving.liveuniversenetwork.com/"],a[href^="http://galleries.pinballpublishernetwork.com/"],a[href^="http://galleries.securewebsiteaccess.com/"],a[href^="http://install.securewebsiteaccess.com/"],a[href^="http://latestdownloads.net/download.php?"],a[href^="http://secure.signup-page.com/"],a[href^="http://secure.signup-way.com/"],a[href^="http://www.FriendlyDuck.com/AF_"],a[href^="http://www.adbrite.com/mb/commerce/purchase_form.php?"],a[href^="http://www.friendlyduck.com/AF_"],a[href^="http://www.google.com/aclk?"],a[href^="http://www.liutilities.com/aff"],a[href^="http://www.liutilities.com/products/campaigns/adv/"],a[href^="http://www.my-dirty-hobby.com/?sub="],a[href^="http://www.ringtonematcher.com/"],div#mclip_container:first-child:last-child,div#tads.c,div#tadsb.c,table.ra[align="left"][width="30%"],table.ra[align="right"][width="30%"],[src*="sixsigmatraffic.com"],embed[flashvars*="AdID"],#Ad1,#AdHeader,#Adbanner,#AdvertiseFrame,#Advertisement,#Advertisements,#Tadspacehead,#TopAd,#ad-container,#ad-header,#ad-top,#ad-wrapper,#ad1,#ad3,#ad728x90,#adBanner,#adComponentWrapper,#adContainer,#adDiv,#adHeader,#adTop,#adWrapper,#ad_area,#ad_container,#ad_leader,#ad_space,#ad_square,#ad_table,#ad_wrapper,#adbody,#adbox,#adposition3,#adsense,#adsense_inline,#adspace,#advert,#advertise,#advertising,#adverts,#adwrapper,#bannerad,#block_advert,#contentAd,#content_ad,#divAd,#featuread,#footer_ad,#footer_ads,#googlead,#head-ad,#header_ad,#mainAd,#printads,#promo-ad,#right_ad,#sidebar-ads,#sidebar_ads,#sponsored,#topAd,#topBannerAd,#top_ad,#topad,#topads,.AdBox,.AdInfo,.AdSense,.AdTitle,.Ads,.Advert,.ad-box,.ad-button,.ad-container,.ad-content,.ad-display,.ad-holder,.ad-sidebar,.ad-text,.ad1,.ad2,.ad468,.adBox,.adContainer,.adDiv,.adElement,.adHolder,.adModule,.adSpace,.adSummary,.adText,.adTitle,.ad_Right,.ad_header,.ad_links,.ad_right,.ad_space,.ad_text,.adbox,.adcol1,.adcol2,.adcont,.addiv,.adframe,.adholder,.adinfo,.adlink,.adlist,.adpic,.adright,.ads-section,.adsBlock,.adspace,.adtable,.adtext,.advert-horizontal,.advert_list,.advertise { visibility:hidden !important; display:none !important; } .advertisement,.advertiser,.advertising,.advertising_block,.advertisment,.adverts,.adwrapper,.affiliate,.banner_728x90,.block_ad,.bottom_ad_block,.contentAd,.contentad,.detail-ads,.header-ad,.headerAd,.header_ad_center,.horizontal_ad,.module-ad,.mpu,.post-ad,.rightAd,.right_ads_column,.rightad,.sponsored,.textads,.topAd,.topAds,.top_ads,.topad,.topads,a[href^="http://ad-emea.doubleclick.net/"] { visibility:hidden !important; display:none !important; }</style></html>